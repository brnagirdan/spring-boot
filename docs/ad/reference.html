<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="Asciidoctor 0.1.4">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spring Boot Reference Guide</title>
<link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/3.2.1/css/font-awesome.min.css">
<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css">
<script src="http://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.js"></script>
<script>document.addEventListener('DOMContentLoaded', prettyPrint)</script>
</head>
<body class="article">
<div id="header">
<h1>Spring Boot Reference Guide</h1>
<span id="author" class="author">Phillip Webb, Dave Syer, Josh Long</span><br>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_spring_boot_documentation">1. Spring Boot Documentation</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_getting_help">1.1. Getting help</a></li>
<li><a href="#_first_steps">1.2. First steps</a></li>
</ul>
</li>
<li><a href="#_getting_started">2. Getting started</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_introducing_spring_boot">2.1. Introducing Spring Boot</a></li>
<li><a href="#_installing_spring_boot">2.2. Installing Spring Boot</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_installation_instructions_for_the_java_developer">2.2.1. Installation instructions for the Java developer</a></li>
<li>
<ul class="sectlevel4">
<li><a href="#_maven_installation">Maven installation</a></li>
<li><a href="#_gradle_installation">Gradle installation</a></li>
</ul>
</li>
<li><a href="#_installing_the_spring_boot_cli">2.2.2. Installing the Spring Boot CLI</a></li>
<li>
<ul class="sectlevel4">
<li><a href="#_manual_installation">Manual installation</a></li>
<li><a href="#_installation_with_gvm">Installation with GVM</a></li>
<li><a href="#_osx_homebrew_installation">OSX Homebrew installation</a></li>
<li><a href="#_quick_start_spring_cli_example">Quick start Spring CLI example</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_developing_your_first_spring_boot_application">2.3. Developing your first Spring Boot application</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_creating_the_pom">2.3.1. Creating the POM</a></li>
<li><a href="#_adding_classpath_dependencies">2.3.2. Adding classpath dependencies</a></li>
<li><a href="#_writing_the_code">2.3.3. Writing the code</a></li>
<li>
<ul class="sectlevel4">
<li><a href="#_the_controller_requestmapping_and_responsebody_annotations">The @Controller, @RequestMapping and @ResponseBody annotations</a></li>
<li><a href="#_the_enableautoconfiguration_annotation">The @EnableAutoConfiguration annotation</a></li>
<li><a href="#_the_main_method">The &#8220;main&#8221; method</a></li>
</ul>
</li>
<li><a href="#_running_the_example">2.3.4. Running the example</a></li>
<li><a href="#_creating_an_executable_jar">2.3.5. Creating an executable JAR</a></li>
</ul>
</li>
<li><a href="#_what_to_read_next">2.4. What to read next</a></li>
</ul>
</li>
<li><a href="#_using_spring_boot">3. Using Spring Boot</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_build_systems">3.1. Build systems</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_maven">3.1.1. Maven</a></li>
<li>
<ul class="sectlevel4">
<li><a href="#_inheriting_the_starter_parent">Inheriting the starter parent</a></li>
<li><a href="#_using_your_own_parent_pom">Using your own parent POM</a></li>
<li><a href="#_changing_the_java_version">Changing the Java version</a></li>
<li><a href="#_using_the_spring_boot_maven_plugin">Using the Spring Boot Maven plugin</a></li>
</ul>
</li>
<li><a href="#_gradle">3.1.2. Gradle</a></li>
<li><a href="#_ant">3.1.3. Ant</a></li>
<li><a href="#_starter_poms">3.1.4. Starter POMs</a></li>
</ul>
</li>
<li><a href="#_structuring_your_code">3.2. Structuring your code</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_using_the_default_package">3.2.1. Using the &#8220;default&#8221; package</a></li>
<li><a href="#_locating_the_main_application_class">3.2.2. Locating the main application class</a></li>
</ul>
</li>
<li><a href="#__configuration_classes">3.3. @Configuration classes</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_importing_additional_configuration_classes">3.3.1. Importing additional configuration classes</a></li>
<li><a href="#_importing_xml_configuration">3.3.2. Importing XML configuration</a></li>
</ul>
</li>
<li><a href="#_auto_configuration">3.4. Auto-configuration</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_gradually_replacing_auto_configuration">3.4.1. Gradually replacing auto-configuration</a></li>
<li><a href="#_disabling_specific_auto_configuration">3.4.2. Disabling specific auto-configuration</a></li>
</ul>
</li>
<li><a href="#_spring_beans_and_dependency_injection">3.5. Spring Beans and dependency injection</a></li>
<li><a href="#_running_your_application">3.6. Running your application</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_running_from_an_ide">3.6.1. Running from an IDE</a></li>
<li><a href="#_as_a_packaged_application">3.6.2. As a packaged application</a></li>
<li><a href="#_using_the_maven_plugin">3.6.3. Using the Maven plugin</a></li>
<li><a href="#_using_the_gradle_plugin">3.6.4. Using the Gradle plugin</a></li>
<li><a href="#_hot_swapping">3.6.5. Hot swapping</a></li>
</ul>
</li>
<li><a href="#_packaging_your_application_for_production">3.7. Packaging your application for production</a></li>
<li><a href="#_what_to_read_next_2">3.8. What to read next</a></li>
</ul>
</li>
<li><a href="#_springapplication">4. SpringApplication</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_customizing_springapplication">4.1. Customizing SpringApplication</a></li>
<li><a href="#_fluent_builder_api">4.2. Fluent builder API</a></li>
<li><a href="#_application_events_and_listeners">4.3. Application events and listeners</a></li>
<li><a href="#_web_environment">4.4. Web environment</a></li>
<li><a href="#_using_the_commandlinerunner">4.5. Using the CommandLineRunner</a></li>
<li><a href="#_application_exit">4.6. Application exit</a></li>
</ul>
</li>
<li><a href="#_externalized_configuration">5. Externalized Configuration</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_accessing_command_line_properties">5.1. Accessing command line properties</a></li>
<li><a href="#_application_property_files">5.2. Application property files</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_profile_specific_properties">5.2.1. Profile specific properties</a></li>
<li><a href="#_placeholders_in_properties">5.2.2. Placeholders in properties</a></li>
</ul>
</li>
<li><a href="#_using_yaml_instead_of_properties">5.3. Using YAML instead of Properties</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_loading_yaml">5.3.1. Loading YAML</a></li>
<li><a href="#_exposing_yaml_as_properties_in_the_spring_environment">5.3.2. Exposing YAML as properties in the Spring Environment.</a></li>
<li><a href="#_multi_profile_yaml_documents">5.3.3. Multi-profile YAML documents</a></li>
<li><a href="#_yaml_shortcomings">5.3.4. YAML shortcomings</a></li>
</ul>
</li>
<li><a href="#_typesafe_configuration_properties">5.4. Typesafe Configuration Properties</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_relaxed_binding">5.4.1. Relaxed binding</a></li>
<li><a href="#__configurationproperties_validation">5.4.2. @ConfigurationProperties Validation</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_profiles">6. Profiles</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_adding_active_profiles">6.1. Adding active profiles</a></li>
<li><a href="#_programmatically_setting_profiles">6.2. Programmatically setting profiles</a></li>
<li><a href="#_profile_specific_configuration_files">6.3. Profile specific configuration files</a></li>
</ul>
</li>
<li><a href="#_logging">7. Logging</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_log_format">7.1. Log format</a></li>
<li><a href="#_console_output">7.2. Console output</a></li>
<li><a href="#_file_output">7.3. File output</a></li>
<li><a href="#_custom_log_configuration">7.4. Custom log configuration</a></li>
</ul>
</li>
<li><a href="#_developing_web_applications">8. Developing web applications</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_the_spring_web_mvc_framework">8.1. The &#8220;Spring Web MVC framework&#8221;</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_spring_mvc_auto_configuration">8.1.1. Spring MVC auto-configuration</a></li>
<li><a href="#_httpmessageconverters">8.1.2. HttpMessageConverters</a></li>
<li><a href="#_static_content">8.1.3. Static Content</a></li>
<li><a href="#_template_engines">8.1.4. Template engines</a></li>
</ul>
</li>
<li><a href="#_embedded_servlet_container_support">8.2. Embedded servlet container support</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_servlets_and_filters">8.2.1. Servlets and Filters</a></li>
<li><a href="#_the_embeddedwebapplicationcontext">8.2.2. The EmbeddedWebApplicationContext</a></li>
<li><a href="#_customizing_embedded_servlet_containers">8.2.3. Customizing embedded servlet containers</a></li>
<li>
<ul class="sectlevel4">
<li><a href="#_programmatic_customization">Programmatic customization</a></li>
<li><a href="#_customizing_configurableembeddedservletcontainerfactory_directly">Customizing ConfigurableEmbeddedServletContainerFactory directly</a></li>
</ul>
</li>
<li><a href="#_jsp_limitations">8.2.4. JSP limitations</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_working_with_sql_databases">9. Working with SQL databases</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_configure_a_datasource">9.1. Configure a DataSource</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_embedded_database_support">9.1.1. Embedded Database Support</a></li>
<li><a href="#_connection_to_a_production_database">9.1.2. Connection to a production database</a></li>
</ul>
</li>
<li><a href="#_using_jdbctemplate">9.2. Using JdbcTemplate</a></li>
<li><a href="#_jpa_and_spring_data">9.3. JPA and &#8220;Spring Data&#8221;</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_entity_classes">9.3.1. Entity Classes</a></li>
<li><a href="#_spring_data_jpa_repositories">9.3.2. Spring Data JPA Repositories</a></li>
<li><a href="#_validation">9.3.3. Validation</a></li>
<li><a href="#_creating_and_dropping_jpa_databases">9.3.4. Creating and dropping JPA databases</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_working_with_nosql_technologies">10. Working with NoSQL technologies</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_mongodb">10.1. MongoDB</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_connecting_to_a_mongodb_database">10.1.1. Connecting to a MongoDB database</a></li>
<li><a href="#_mongotemplate">10.1.2. MongoTemplate</a></li>
<li><a href="#_spring_data_mongodb_repositories">10.1.3. Spring Data MongoDB repositories</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_testing">11. Testing</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_test_scope_dependencies">11.1. Test scope dependencies</a></li>
<li><a href="#_testing_spring_applications">11.2. Testing Spring applications</a></li>
<li><a href="#_testing_spring_boot_applications">11.3. Testing Spring Boot applications</a></li>
<li><a href="#_test_utilities">11.4. Test utilities</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_configfileapplicationcontextinitializer">11.4.1. ConfigFileApplicationContextInitializer</a></li>
<li><a href="#_environmenttestutils">11.4.2. EnvironmentTestUtils</a></li>
<li><a href="#_outputcapture">11.4.3. OutputCapture</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_production_ready_features">12. Production-ready features</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_enabling_production_ready_features">12.1. Enabling production-ready features.</a></li>
<li><a href="#_endpoints">12.2. Endpoints</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_customizing_endpoints">12.2.1. Customizing endpoints</a></li>
<li><a href="#_custom_health_information">12.2.2. Custom health information</a></li>
<li><a href="#_custom_application_info_information">12.2.3. Custom application info information</a></li>
<li>
<ul class="sectlevel4">
<li><a href="#_git_commit_information">Git commit information</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_monitoring_and_management_over_http">12.3. Monitoring and management over HTTP</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_exposing_sensitive_endpoints">12.3.1. Exposing sensitive endpoints</a></li>
<li><a href="#_customizing_the_management_server_context_path">12.3.2. Customizing the management server context path</a></li>
<li><a href="#_customizing_the_management_server_port">12.3.3. Customizing the management server port</a></li>
<li><a href="#_customizing_the_management_server_address">12.3.4. Customizing the management server address</a></li>
<li><a href="#_disabling_http_endpoints">12.3.5. Disabling HTTP endpoints</a></li>
</ul>
</li>
<li><a href="#_monitoring_and_management_over_jmx">12.4. Monitoring and management over JMX</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_customizing_mbean_names">12.4.1. Customizing MBean names</a></li>
<li><a href="#_disabling_jmx_endpoints">12.4.2. Disabling JMX endpoints</a></li>
<li><a href="#_using_jolokia_for_jmx_over_http">12.4.3. Using Jolokia for JMX over HTTP</a></li>
<li>
<ul class="sectlevel4">
<li><a href="#_customizing_jolokia">Customizing Jolokia</a></li>
<li><a href="#_disabling_jolokia">Disabling Jolokia</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_monitoring_and_management_using_a_remote_shell">12.5. Monitoring and management using a remote shell</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_connecting_to_the_remote_shell">12.5.1. Connecting to the remote shell</a></li>
<li>
<ul class="sectlevel4">
<li><a href="#_remote_shell_credentials">Remote shell credentials</a></li>
</ul>
</li>
<li><a href="#_extending_the_remote_shell">12.5.2. Extending the remote shell</a></li>
<li>
<ul class="sectlevel4">
<li><a href="#_commands">Commands</a></li>
<li><a href="#_plugins">Plugins</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_metrics">12.6. Metrics</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_recording_your_own_metrics">12.6.1. Recording your own metrics</a></li>
<li><a href="#_metric_repositories">12.6.2. Metric repositories</a></li>
<li><a href="#_coda_hale_metrics">12.6.3. Coda Hale Metrics</a></li>
<li><a href="#_message_channel_integration">12.6.4. Message channel integration</a></li>
</ul>
</li>
<li><a href="#_auditing">12.7. Auditing</a></li>
<li><a href="#_tracing">12.8. Tracing</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_custom_tracing">12.8.1. Custom tracing</a></li>
</ul>
</li>
<li><a href="#_error_handling">12.9. Error Handling</a></li>
</ul>
</li>
<li><a href="#_spring_boot_gradle_plugin">13. Spring Boot Gradle plugin</a></li>
<li><a href="#_spring_boot_maven_plugin">14. Spring Boot Maven plugin</a></li>
<li><a href="#_deploying_to_the_cloud">15. Deploying to the cloud</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_cloud_foundry">15.1. Cloud Foundry</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_binding_to_services">15.1.1. Binding to services</a></li>
</ul>
</li>
<li><a href="#_heroku">15.2. Heroku</a></li>
</ul>
</li>
<li><a href="#_extending_spring_boot">16. Extending Spring Boot</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_conditions">16.1. Conditions</a></li>
</ul>
</li>
<li><a href="#_spring_boot_cli">17. Spring Boot CLI</a></li>
<li><a href="#_common_application_properties">18. Common application properties</a></li>
<li><a href="#_auto_configuration_classes">19. Auto-configuration classes</a></li>
<li><a href="#__how_to_guides">20. &#8220;How-to&#8221; guides</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_spring_boot_application">20.1. Spring Boot application</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_troubleshoot_auto_configuration">20.1.1. Troubleshoot auto-configuration</a></li>
<li><a href="#_customize_the_environment_or_applicationcontext_before_it_starts">20.1.2. Customize the Environment or ApplicationContext before it starts</a></li>
<li><a href="#build-hierarchy">20.1.3. Build an ApplicationContext hierarchy (adding a parent or root context)</a></li>
<li><a href="#_create_a_non_web_application">20.1.4. Create a non-web application</a></li>
</ul>
</li>
<li><a href="#_properties_configuration">20.2. Properties &amp; configuration</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_externalize_the_configuration_of_springapplication">20.2.1. Externalize the configuration of SpringApplication</a></li>
<li><a href="#_change_the_location_of_external_properties_of_an_application">20.2.2. Change the location of external properties of an application</a></li>
<li><a href="#_use_short_command_line_arguments">20.2.3. Use &#8220;short&#8221; command line arguments</a></li>
<li><a href="#_use_yaml_for_external_properties">20.2.4. Use YAML for external properties</a></li>
<li><a href="#_set_the_active_spring_profiles">20.2.5. Set the active Spring profiles</a></li>
<li><a href="#_change_configuration_depending_on_the_environment">20.2.6. Change configuration depending on the environment</a></li>
<li><a href="#discover-options">20.2.7. Discover built-in options for external properties</a></li>
</ul>
</li>
<li><a href="#_embedded_servlet_containers">20.3. Embedded servlet containers</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_add_a_servlet_filter_or_servletcontextlistener_to_an_application">20.3.1. Add a Servlet, Filter or ServletContextListener to an application</a></li>
<li><a href="#_change_the_http_port">20.3.2. Change the HTTP port</a></li>
<li><a href="#_use_a_random_unassigned_http_port">20.3.3. Use a random unassigned HTTP port</a></li>
<li><a href="#_discover_the_http_port_at_runtime">20.3.4. Discover the HTTP port at runtime</a></li>
<li><a href="#_configure_tomcat">20.3.5. Configure Tomcat</a></li>
<li><a href="#_terminate_ssl_in_tomcat">20.3.6. Terminate SSL in Tomcat</a></li>
<li><a href="#_use_jetty_instead_of_tomcat">20.3.7. Use Jetty instead of Tomcat</a></li>
<li><a href="#_configure_jetty">20.3.8. Configure Jetty</a></li>
<li><a href="#_use_tomcat_8">20.3.9. Use Tomcat 8</a></li>
<li><a href="#_use_jetty_9">20.3.10. Use Jetty 9</a></li>
</ul>
</li>
<li><a href="#_spring_mvc">20.4. Spring MVC</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_write_a_json_rest_service">20.4.1. Write a JSON REST service</a></li>
<li><a href="#_customize_the_jackson_objectmapper">20.4.2. Customize the Jackson ObjectMapper</a></li>
<li><a href="#message-converters">20.4.3. Customize the @ResponseBody rendering</a></li>
<li><a href="#_switch_off_the_spring_mvc_dispatcherservlet">20.4.4. Switch off the Spring MVC DispatcherServlet</a></li>
<li><a href="#_switch_off_the_default_mvc_configuration">20.4.5. Switch off the Default MVC configuration</a></li>
</ul>
</li>
<li><a href="#_logging_2">20.5. Logging</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_configure_logback_for_logging">20.5.1. Configure Logback for logging</a></li>
<li><a href="#_configure_log4j_for_logging">20.5.2. Configure Log4j for logging</a></li>
</ul>
</li>
<li><a href="#_data_access">20.6. Data Access</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_configure_a_datasource_2">20.6.1. Configure a DataSource</a></li>
<li><a href="#_use_spring_data_repositories">20.6.2. Use Spring Data repositories</a></li>
<li><a href="#_separate_entity_definitions_from_spring_configuration">20.6.3. Separate @Entity definitions from Spring configuration</a></li>
<li><a href="#_configure_jpa_properties">20.6.4. Configure JPA properties</a></li>
<li><a href="#_use_a_traditional_persistence_xml">20.6.5. Use a traditional persistence.xml</a></li>
</ul>
</li>
<li><a href="#_database_initialization">20.7. Database initialization</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_initialize_a_database_using_jpa">20.7.1. Initialize a database using JPA</a></li>
<li><a href="#_initialize_a_database_using_hibernate">20.7.2. Initialize a database using Hibernate</a></li>
<li><a href="#_initialize_a_database_using_spring_jdbc">20.7.3. Initialize a database using Spring JDBC</a></li>
<li><a href="#_initialize_a_spring_batch_database">20.7.4. Initialize a Spring Batch database</a></li>
<li><a href="#_use_a_higher_level_datababse_migration_tool">20.7.5. Use a higher level datababse migration tool</a></li>
</ul>
</li>
<li><a href="#_batch_applications">20.8. Batch applications</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_execute_spring_batch_jobs_on_startup">20.8.1. Execute Spring Batch jobs on startup</a></li>
</ul>
</li>
<li><a href="#_actuator">20.9. Actuator</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_change_the_http_port_or_address_of_the_actuator_endpoints">20.9.1. Change the HTTP port or address of the actuator endpoints</a></li>
<li><a href="#_customize_the_whitelabel_error_page">20.9.2. Customize the &#8220;whitelabel&#8221; error page</a></li>
</ul>
</li>
<li><a href="#_security">20.10. Security</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_secure_an_application">20.10.1. Secure an application</a></li>
<li><a href="#_switch_off_the_spring_boot_security_configuration">20.10.2. Switch off the Spring Boot security configuration</a></li>
<li><a href="#_change_the_authenticationmanager_and_add_user_accounts">20.10.3. Change the AuthenticationManager and add user accounts</a></li>
<li><a href="#_enable_https">20.10.4. Enable HTTPS</a></li>
</ul>
</li>
<li><a href="#_hot_swapping_2">20.11. Hot swapping</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_reload_static_content">20.11.1. Reload static content</a></li>
<li><a href="#_reload_thymeleaf_templates_without_restarting_the_container">20.11.2. Reload Thymeleaf templates without restarting the container</a></li>
<li><a href="#_reload_java_classes_without_restarting_the_container">20.11.3. Reload Java classes without restarting the container</a></li>
</ul>
</li>
<li><a href="#_build">20.12. Build</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_build_an_executable_archive_with_ant">20.12.1. Build an executable archive with Ant</a></li>
</ul>
</li>
<li><a href="#_traditional_deployment">20.13. Traditional deployment</a></li>
<li>
<ul class="sectlevel3">
<li><a href="#_create_a_deployable_war_file">20.13.1. Create a deployable WAR file</a></li>
<li><a href="#_create_a_deployable_war_file_for_older_servlet_containers">20.13.2. Create a deployable WAR file for older servlet containers</a></li>
<li><a href="#_convert_an_existing_application_to_spring_boot">20.13.3. Convert an existing application to Spring Boot</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_spring_boot_documentation">1. Spring Boot Documentation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_getting_help">1.1. Getting help</h3>
<div class="paragraph">
<p>Having trouble with Spring Boot, We&#8217;d like to help!</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Try the How-to&#8217;s&#8201;&#8212;&#8201;they provide solutions to the most common questions</p>
</li>
<li>
<p>Learn the Spring basics&#8201;&#8212;&#8201;Spring Boot is builds on many other Spring projects, check
the <a href="http://spring.io">spring.io</a> web-site for a wealth of reference documentation. If
you are just starting out with Spring, try one of the <a href="http://spring.io/guides">guides</a></p>
</li>
<li>
<p>Ask a questions - we monitor <a href="http://stackoverflow.com">stackoverflow.com</a> for questions
tagged with <a href="http://stackoverflow.com/tags/spring-boot"><code>spring-boot</code></a></p>
</li>
<li>
<p>Report bugs with Spring Boot at <a href="https://github.com/spring-projects/spring-boot/issues">https://github.com/spring-projects/spring-boot/issues</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_first_steps">1.2. First steps</h3>
<div class="paragraph">
<p>If you are just starting out&#8230;</p>
</div>
<div class="ulist">
<ul>
<li>
<p>From scratch</p>
</li>
<li>
<p>Tutorial</p>
</li>
<li>
<p>Advanced tutorial</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_started">2. Getting started</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_introducing_spring_boot">2.1. Introducing Spring Boot</h3>
<div class="paragraph">
<p>Spring Boot makes it easy to create stand-alone, production-grade Spring based
Applications that can you can &#8220;just run&#8221;. We take an opinionated view of the Spring
platform and third-party libraries so you can get started with minimum fuss. Most Spring
Boot applications need very little Spring configuration.</p>
</div>
<div class="paragraph">
<p>You can use Spring Boot to create Java applications that can be started using <code>java -jar</code>
or more traditional WAR deployments. We also provide a command line tool that runs &#8220;spring
scripts&#8221;.</p>
</div>
<div class="paragraph">
<p>Our primary goals are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Provide a radically faster and widely accessible getting started experience for all
Spring development</p>
</li>
<li>
<p>Be opinionated out of the box, but get out of the way quickly as requirements start to
diverge from the defaults</p>
</li>
<li>
<p>Provide a range of non-functional features that are common to large classes of projects
(e.g. embedded servers, security, metrics, health checks, externalized configuration)</p>
</li>
<li>
<p>Absolutely no code generation and no requirement for XML configuration</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_installing_spring_boot">2.2. Installing Spring Boot</h3>
<div class="paragraph">
<p>Spring Boot can be used with &#8220;classic&#8221; Java development tools or installed as a command
line tool. Regardless, you will need <a href="http://www.java.com">Java SDK v1.6</a> or higher. You
should check your current Java installation before you begin:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ java -version</pre>
</div>
</div>
<div class="paragraph">
<p>If you are new to Java development, or if you just want to experiment with Spring Boot
you might want to try the Spring Boot CLI first, otherwise, read on for &#8220;classic&#8221;
installation instructions.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
Although Spring Boot is compatible with Java 1.6, if possible, you should consider
using the latest version of Java.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_installation_instructions_for_the_java_developer">2.2.1. Installation instructions for the Java developer</h4>
<div class="paragraph">
<p>You can use Spring Boot in the same way as any standard java library. Simply include the
appropriate <code>spring-boot-*.jar</code> files in your classpath. Spring Boot does not require
any special tool integration, so you can use any IDE or text editor; and there is nothing
special about a Spring Boot application, so you can run and debug as you would any other
Java program.</p>
</div>
<div class="paragraph">
<p>Although you <em>could</em> just copy Spring Boot JARs, we generally recommend that you use a
build tool that support dependency management (such as Maven or Gradle).</p>
</div>
<div class="sect4">
<h5 id="_maven_installation">Maven installation</h5>
<div class="paragraph">
<p>Spring Boot is compatible with Apache Maven 3.0 or above. If you don&#8217;t already have Maven
installed you can follow the instructions at <a href="http://maven.apache.org">http://maven.apache.org</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
On many operating systems Maven can be installed via a package manager. If you&#8217;re a
OSX Homebrew user try <code>brew install maven</code>. Ubuntu users can run <code>sudo apt-get install maven</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Spring Boot dependencies use the <code>org.springframework.boot</code> <code>groupId</code>. Typically your
Maven POM file will inherit from the <code>spring-boot-starter-parent</code> project and declare
dependencies to one or more &#8220;starter POMs&#8221;. Spring Boot also provides an optional Maven
plugin to create executable JARs.</p>
</div>
<div class="paragraph">
<p>Here is a typical <code>pom.xml</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint xml language-xml"><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;groupId&gt;com.example&lt;/groupId&gt;
    &lt;artifactId&gt;myproject&lt;/artifactId&gt;
    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;

    &lt;!-- Inherit defaults from Spring Boot --&gt;
    &lt;parent&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
        &lt;version&gt;1.0.0.BUILD-SNAPSHOT&lt;/version&gt;
    &lt;/parent&gt;

    &lt;!-- Add typical dependencies for a web application --&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;

    &lt;!-- Package as an executable JAR --&gt;
    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;

    &lt;!-- Add Spring repoistories --&gt;
    &lt;!-- (you don't need this if you are using a .RELEASE version) --&gt;
    &lt;repositories&gt;
        &lt;repository&gt;
            &lt;id&gt;spring-snapshots&lt;/id&gt;
            &lt;url&gt;http://repo.spring.io/snapshot&lt;/url&gt;
            &lt;snapshots&gt;&lt;enabled&gt;true&lt;/enabled&gt;&lt;/snapshots&gt;
        &lt;/repository&gt;
        &lt;repository&gt;
            &lt;id&gt;spring-milestones&lt;/id&gt;
            &lt;url&gt;http://repo.spring.io/milestone&lt;/url&gt;
        &lt;/repository&gt;
    &lt;/repositories&gt;
    &lt;pluginRepositories&gt;
        &lt;pluginRepository&gt;
            &lt;id&gt;spring-snapshots&lt;/id&gt;
            &lt;url&gt;http://repo.spring.io/snapshot&lt;/url&gt;
        &lt;/pluginRepository&gt;
        &lt;pluginRepository&gt;
            &lt;id&gt;spring-milestones&lt;/id&gt;
            &lt;url&gt;http://repo.spring.io/milestone&lt;/url&gt;
        &lt;/pluginRepository&gt;
    &lt;/pluginRepositories&gt;
&lt;/project&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_gradle_installation">Gradle installation</h5>
<div class="paragraph">
<p>Spring Boot is compatible with Gradle 1.6 or above. If you don&#8217;t already have Gradle
installed you can follow the instructions at <a href="http://www.gradle.org/">http://www.gradle.org/</a>.</p>
</div>
<div class="paragraph">
<p>Spring Boot dependencies can be declared using the <code>org.springframework.boot</code> <code>group</code>.
Typically your project will declare dependencies to one or more starter POMs. Spring Boot
provides a useful Gradle plugin that can be used to simplify dependency declarations
and to create executable JARs.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Gradle Wrapper</div>
<div class="paragraph">
<p>The Gradle Wrapper provides a nice way of &#8220;obtaining&#8221; Gradle when you need to build a
project. It&#8217;s a small script and library that you commit alongside your code to bootstrap
the build process. See <a href="http://www.gradle.org/docs/current/userguide/gradle_wrapper.html">http://www.gradle.org/docs/current/userguide/gradle_wrapper.html</a>
for details.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Here is a typical <code>build.gradle</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint groovy language-groovy"><code>buildscript {
    repositories {
        mavenCentral()
        maven { url "http://repo.spring.io/snapshot" }
        maven { url "http://repo.spring.io/milestone" }
    }
    dependencies {
        classpath("org.springframework.boot:spring-boot-gradle-plugin:1.0.0.BUILD-SNAPSHOT")
    }
}

apply plugin: <em>java</em>
apply plugin: <em>spring-boot</em>

jar {
    baseName = <em>myproject</em>
    version =  <em>0.0.1-SNAPSHOT</em>
}

repositories {
    mavenCentral()
    maven { url "http://repo.spring.io/snapshot" }
    maven { url "http://repo.spring.io/milestone" }
}

dependencies {
    compile("org.springframework.boot:spring-boot-starter-web")
    testCompile("junit:junit")
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_installing_the_spring_boot_cli">2.2.2. Installing the Spring Boot CLI</h4>
<div class="paragraph">
<p>The Spring Boot CLI is a command line tool that can be used if you want to quickly
prototype with Spring. It allows you to run <a href="http://groovy.codehaus.org/">Groovy</a> scripts,
which means that you have a familiar Java-like syntax, without so much boilerplate code.</p>
</div>
<div class="paragraph">
<p>You don&#8217;t need to use the CLI to work with Spring Boot but it&#8217;s definitely the quickest
way to get a Spring application off the ground.</p>
</div>
<div class="sect4">
<h5 id="_manual_installation">Manual installation</h5>
<div class="paragraph">
<p>You can download the Spring CLI distribution from the Spring software repository:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://repo.spring.io/snapshot/org/springframework/boot/spring-boot-cli/1.0.0.BUILD-SNAPSHOT/spring-boot-cli-1.0.0.BUILD-SNAPSHOT-bin.zip">spring-boot-cli-1.0.0.BUILD-SNAPSHOT-bin.zip</a></p>
</li>
<li>
<p><a href="http://repo.spring.io/snapshot/org/springframework/boot/spring-boot-cli/1.0.0.BUILD-SNAPSHOT/spring-boot-cli-1.0.0.BUILD-SNAPSHOT-bin.tar.gz">spring-boot-cli-1.0.0.BUILD-SNAPSHOT-bin.tar.gz</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Cutting edge <a href="http://repo.spring.io/snapshot/org/springframework/boot/spring-boot-cli/">snapshot distributions</a>
are also available.</p>
</div>
<div class="paragraph">
<p>Once downloaded, follow the INSTALL instructions from the unpacked archive. In summary:
there is a <code>spring</code> script (<code>spring.bat</code> for Windows) in a <code>bin/</code> directory in the <code>.zip</code>
file, or alternatively you can use <code>java -jar</code> with the <code>.jar</code> file (the script helps you
to be sure that the classpath is set correctly).</p>
</div>
</div>
<div class="sect4">
<h5 id="_installation_with_gvm">Installation with GVM</h5>
<div class="paragraph">
<p>GVM (the Groovy Environment Manager) can be used for managing multiple versions of
various Groovy and Java binary packages, including Groovy itself and the Spring Boot CLI.
Get <code>gvm</code> from <a href="http://gvmtool.net">http://gvmtool.net</a> and install Spring Boot with</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gvm install springboot
$ spring --version
Spring Boot v1.0.0.BUILD-SNAPSHOT</pre>
</div>
</div>
<div class="paragraph">
<p>If you are developing features for the CLI and want easy access to the version you just
built, follow these extra instructions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gvm install springboot dev /path/to/spring-boot/spring-boot-cli/target/spring-boot-cli-1.0.0.BUILD-SNAPSHOT-bin/spring-1.0.0.BUILD-SNAPSHOT/
$ gvm use springboot dev
$ spring --version
Spring CLI v1.0.0.BUILD-SNAPSHOT</pre>
</div>
</div>
<div class="paragraph">
<p>This will install a local instance of <code>spring</code> called the <code>dev</code> instance inside your gvm
repository. It points at your target build location, so every time you rebuild Spring
Boot, <code>spring</code> will be up-to-date.</p>
</div>
<div class="paragraph">
<p>You can see it by doing this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gvm ls springboot

================================================================================
Available Springboot Versions
================================================================================
&gt; + dev
* 1.0.0.BUILD-SNAPSHOT

================================================================================
+ - local version
* - installed
&gt; - currently in use
================================================================================</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_osx_homebrew_installation">OSX Homebrew installation</h5>
<div class="paragraph">
<p>If you are on a Mac and using <a href="http://brew.sh/">Homebrew</a>, all you need to do to install
the Spring Boot CLI is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ brew tap pivotal/tap
$ brew install springboot</pre>
</div>
</div>
<div class="paragraph">
<p>Homebrew will install <code>spring</code> to <code>/usr/local/bin</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
If you don&#8217;t see the formula, you&#8217;re installation of brew might be out-of-date.
Just execute <code>brew update</code> and try again.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_quick_start_spring_cli_example">Quick start Spring CLI example</h5>
<div class="paragraph">
<p>Here&#8217;s a really simple web application that you can use to test you installation. Create
a file called <code>app.groovy</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint groovy language-groovy"><code>@Controller
class ThisWillActuallyRun {

    @RequestMapping("/")
    @ResponseBody
    String home() {
        return "Hello World!"
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then simply run it from a shell:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ spring run app.groovy</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
It will take some time when you first run the application as dependencies are
downloaded, subsequent runs will be much quicker.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Open <a href="http://localhost:8080">http://localhost:8080</a> in your favorite web browser and you should see the following
output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Hello World!</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_developing_your_first_spring_boot_application">2.3. Developing your first Spring Boot application</h3>
<div class="paragraph">
<p>Let&#8217;s develop a simple &#8220;Hello World!&#8221; web application in Java that highlights some
of Spring Boot&#8217;s key features. We&#8217;ll use Maven to build this project since most IDEs
support it.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
The <a href="http://spring.io">spring.io</a> web site contains many &#8220;Getting Started&#8221; guides
that use Spring Boot. If you&#8217;re looking to solve a specific problem; check there first.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Before we begin, open a terminal to check that you have valid versions of Java and Maven
installed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ java -version
java version "1.7.0_51"
Java(TM) SE Runtime Environment (build 1.7.0_51-b13)
Java HotSpot(TM) 64-Bit Server VM (build 24.51-b03, mixed mode)</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>$ mvn -v
Apache Maven 3.1.1 (0728685237757ffbf44136acec0402957f723d9a; 2013-09-17 08:22:22-0700)
Maven home: /Users/user/tools/apache-maven-3.1.1
Java version: 1.7.0_51, vendor: Oracle Corporation</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
This sample needs to be created in it&#8217;s own folder. Subsequent instructions assume
that you have created a suitable folder and that it is your &#8220;current directory&#8221;.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_creating_the_pom">2.3.1. Creating the POM</h4>
<div class="paragraph">
<p>We need to start by creating a Maven <code>pom.xml</code> file. The <code>pom.xml</code> is the recipe that
will be used to build your project. Open you favorite text editor and add the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint xml language-xml"><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;groupId&gt;com.example&lt;/groupId&gt;
    &lt;artifactId&gt;myproject&lt;/artifactId&gt;
    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;

    &lt;parent&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
        &lt;version&gt;1.0.0.BUILD-SNAPSHOT&lt;/version&gt;
    &lt;/parent&gt;

    &lt;!-- Additional lines to be added here... --&gt;

    &lt;!-- (you don't need this if you are using a .RELEASE version) --&gt;
    &lt;repositories&gt;
        &lt;repository&gt;
            &lt;id&gt;spring-snapshots&lt;/id&gt;
            &lt;url&gt;http://repo.spring.io/snapshot&lt;/url&gt;
            &lt;snapshots&gt;&lt;enabled&gt;true&lt;/enabled&gt;&lt;/snapshots&gt;
        &lt;/repository&gt;
        &lt;repository&gt;
            &lt;id&gt;spring-milestones&lt;/id&gt;
            &lt;url&gt;http://repo.spring.io/milestone&lt;/url&gt;
        &lt;/repository&gt;
    &lt;/repositories&gt;
    &lt;pluginRepositories&gt;
        &lt;pluginRepository&gt;
            &lt;id&gt;spring-snapshots&lt;/id&gt;
            &lt;url&gt;http://repo.spring.io/snapshot&lt;/url&gt;
        &lt;/pluginRepository&gt;
        &lt;pluginRepository&gt;
            &lt;id&gt;spring-milestones&lt;/id&gt;
            &lt;url&gt;http://repo.spring.io/milestone&lt;/url&gt;
        &lt;/pluginRepository&gt;
    &lt;/pluginRepositories&gt;
&lt;/project&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This should give you a working build, you can test it out by running <code>mvn package</code> (you
can ignore the <em>`JAR will be empty - no content was marked for inclusion!'</em> warning for
now).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
At this point you could import the project into an IDE (most modern Java IDE&#8217;s
include built-in support for Maven). For simplicity, we will continue to use a simple
text editor for this example.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_adding_classpath_dependencies">2.3.2. Adding classpath dependencies</h4>
<div class="paragraph">
<p>Spring Boot provides a number of &#8220;Starter POMs&#8221; that make easy to add JARs to your
classpath. Our sample application has already used <code>spring-boot-starter-parent</code> in the
<code>parent</code> section of the POM. The <code>spring-boot-starter-parent</code> is a special starter
that provides useful Maven defaults. It also provides a <code>dependency-management</code> section
so that you can omit <code>version</code> tags for blessed <code>dependencies</code>.</p>
</div>
<div class="paragraph">
<p>Other &#8220;Starter POMs&#8221; simply provide dependencies that you are likely to need to a
specific type of application. Since we are developing web application we will add a
<code>spring-boot-starter-web</code> dependency&#8201;&#8212;&#8201;but before that, lets look at what we currently
have.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ mvn dependency:tree

[INFO] com.example:myproject:jar:0.0.1-SNAPSHOT
[INFO] +- junit:junit:jar:4.11:test
[INFO] |  \- org.hamcrest:hamcrest-core:jar:1.3:test
[INFO] +- org.mockito:mockito-core:jar:1.9.5:test
[INFO] |  \- org.objenesis:objenesis:jar:1.0:test
[INFO] \- org.hamcrest:hamcrest-library:jar:1.3:test</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>mvn dependency:tree</code> command prints tree representation of your project dependencies.
You can see that <code>spring-boot-starter-parent</code> has already provides some useful test
dependencies. Lets edit our <code>pom.xml</code> and add the <code>spring-boot-starter-web</code> dependency
just below the <code>parent</code> section:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint xml language-xml"><code>&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you run <code>mvn dependency:tree</code> again, you will see that there are now a number of
additional dependencies, including the Tomcat web server and Spring Boot itself.</p>
</div>
</div>
<div class="sect3">
<h4 id="_writing_the_code">2.3.3. Writing the code</h4>
<div class="paragraph">
<p>To finish our application we need to create a single Java file. Maven will compile sources
from <code>src/main/java</code> so you need to create that folder structure, then add a file named
<code>src/main/java/Example.java</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>import org.springframework.boot.*;
import org.springframework.boot.autoconfigure.*;
import org.springframework.stereotype.*;
import org.springframework.web.bind.annotation.*;

@Controller
@EnableAutoConfiguration
public class Example {

    @RequestMapping("/")
    @ResponseBody
    String home() {
        return "Hello World!";
    }

    public static void main(String[] args) throws Exception {
        SpringApplication.run(Example.class, args);
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Although there isn&#8217;t much code here, quite a lot is going on. Lets step though the
important parts of the code.</p>
</div>
<div class="sect4">
<h5 id="_the_controller_requestmapping_and_responsebody_annotations">The @Controller, @RequestMapping and @ResponseBody annotations</h5>
<div class="paragraph">
<p>The first annotation on our <code>Example</code> class is <code>@Controller</code>. This is known as a
<em>stereotype</em> annotation. It provides hints for people reading the code, and for Spring,
that the class plays a specific role. In this case, our class is web <code>@Controller</code> so
Spring will consider it when handling incoming web requests.</p>
</div>
<div class="paragraph">
<p>The <code>@RequestMapping</code> annotation provides &#8220;routing&#8221; information. It is telling Spring
that any HTTP request with the path "<code>/</code>" should be mapped to the method. The additional
<code>@ResponseBody</code> annotation tells Spring to render the resulting string directly back to
the caller.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
The <code>@Controller</code>, <code>@RequestMapping</code> and <code>@ResponseBody</code> annotation are Spring MVC
annotations (they are not specific to Spring Boot). See the MVC section in the Spring
Reference Documentation for more details.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_the_enableautoconfiguration_annotation">The @EnableAutoConfiguration annotation</h5>
<div class="paragraph">
<p>The second class-level annotation is <code>@EnableAutoConfiguration</code>. This annotation tells
Spring Boot to &#8220;guess&#8221; how you will want to configure Spring based on the JAR
dependencies that you have added. Since <code>spring-boot-starter-web</code> added Tomcat and
Spring MVC, the auto-configuration will assume that you are developing a web application
and setup Spring accordingly.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Starter POMs and Auto-Configuration</div>
<div class="paragraph">
<p>Auto-configuration is designed to work well with &#8220;Starter POMs&#8221;, but the two concepts
are not directly tied. You are free to pick-and-choose JAR dependencies outside of the
starter POMs and Spring Boot will still do its best to auto-configure your application.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_the_main_method">The &#8220;main&#8221; method</h5>
<div class="paragraph">
<p>The final part of our application is the <code>main</code> method. This is just a standard method
that follows the Java convention for an application entry point. Our main method delegates
to Spring Boot&#8217;s <code>SpringApplication</code> class by calling <code>run</code>. <code>SpringApplication</code> will
bootstrap our application, starting Spring which will in turn start the auto-configured
Tomcat web server. We need to pass <code>Example.class</code> as an argument to the <code>run</code> method to
tell <code>SpringApplication</code> which is the primary Spring component. The <code>args</code> array is also
passed though to expose any command-line arguments.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_running_the_example">2.3.4. Running the example</h4>
<div class="paragraph">
<p>At this point out application should work. Since we have used the
<code>spring-boot-starter-parent</code> POM we have a useful <code>run</code> goal that we can use to start
the application. Type <code>mvn spring-boot:run</code> from the root project directory to start the
application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ mvn spring-boot:run

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::  (v1.0.0.BUILD-SNAPSHOT)
....... . . .
....... . . . (log output here)
....... . . .
........ Started Example in 2.222 seconds (JVM running for 6.514)</pre>
</div>
</div>
<div class="paragraph">
<p>If you open a web browser to <a href="http://localhost:8080">http://localhost:8080</a> you should see the following output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Hello World!</pre>
</div>
</div>
<div class="paragraph">
<p>To gracefully exist the application hit <code>ctrl-c</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_creating_an_executable_jar">2.3.5. Creating an executable JAR</h4>
<div class="paragraph">
<p>Lets finish our example by create a completely self-contained executable JAR file that
we could run in production. Executable JARs (sometimes called &#8220;Fat JARs&#8221;) are archives
containing your compiled classes along with all of the JAR dependencies that your code
needs to run.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Executable JARs and Java</div>
<div class="paragraph">
<p>Java does not provide any standard way to load nested jar files (i.e. jar files that are
themselves contained within a jar). This can be problematic if you are looking to
distribute a self contained application.</p>
</div>
<div class="paragraph">
<p>To solve this problem, many developers use &#8220;shaded&#8221; jars. A shaded jar simply packages
all classes, from all jars, into a single &#8220;uber jar&#8221;. The problem with shaded jars is that
it becomes hard to see which libraries you are actually using in your application. It can
also be problematic if the the same filename is used (but with different content) in
multiple jars.</p>
</div>
<div class="paragraph">
<p>Spring Boot takes a different approach and allows you to actually nest jars directly.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>To create an executable JAR we need to add the <code>spring-boot-maven-plugin</code> to our
<code>pom.xml</code>. Insert the following lines just below the <code>dependencies</code> section:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint xml language-xml"><code>&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Save your <code>pom.xml</code> and run <code>mvn package</code> from the command line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ mvn package

[INFO] Scanning for projects...
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] Building myproject 0.0.1-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO] .... ..
[INFO] --- maven-jar-plugin:2.4:jar (default-jar) @ myproject ---
[INFO] Building jar: /Users/developer/example/spring-boot-example/target/myproject-0.0.1-SNAPSHOT.jar
[INFO]
[INFO] --- spring-boot-maven-plugin:1.0.0.BUILD-SNAPSHOT:repackage (default) @ myproject ---
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------</pre>
</div>
</div>
<div class="paragraph">
<p>If you look in the <code>target</code> directory you should see <code>myproject-0.0.1-SNAPSHOT.jar</code>. The
file should be around 10 Mb in size. If you want to peek inside, you can use <code>jar tvf</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ jar tvf target/myproject-0.0.1-SNAPSHOT.jar</pre>
</div>
</div>
<div class="paragraph">
<p>You should also see a much smaller file named <code>myproject-0.0.1-SNAPSHOT.jar.original</code>
in the <code>target</code> directory. This is the original JAR file that Maven created before it was
repackaged by Spring Boot.</p>
</div>
<div class="paragraph">
<p>To run that application, use the <code>java -jar</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ java -jar target/myproject-0.0.1-SNAPSHOT.jar

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::  (v1.0.0.BUILD-SNAPSHOT)
....... . . .
....... . . . (log output here)
....... . . .
........ Started Example in 3.236 seconds (JVM running for 3.764)</pre>
</div>
</div>
<div class="paragraph">
<p>As before, to gracefully exist the application hit <code>ctrl-c</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_what_to_read_next">2.4. What to read next</h3>

</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_spring_boot">3. Using Spring Boot</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section provides a brief overview of best-practices when using Spring Boot. There
is nothing particularly special about Spring Boot, it is just another library that you
can consume. There are, however, a few recommendations that when followed will make your
development process just a little easier.</p>
</div>
<div class="sect2">
<h3 id="_build_systems">3.1. Build systems</h3>
<div class="paragraph">
<p>It is strongly recommended that you choose a build system that supports <em>dependency
management</em>, and one that can consume artifacts published to the &#8220;Maven Central&#8221;
repository. We would recommend that you choose Maven or Gradle. It is possible to get
Spring Boot to work with other build systems (Ant for example), but they would not be
particularly well supported.</p>
</div>
<div class="sect3">
<h4 id="_maven">3.1.1. Maven</h4>
<div class="paragraph">
<p>Maven users can inherit from the <code>spring-boot-starter-parent</code> project to obtain sensible
defaults. The parent project provides the following features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Java 1.6 as the default compiler level</p>
</li>
<li>
<p>UTF-8 source encoding</p>
</li>
<li>
<p>A Dependency Management section, allowing you to omit <code>&lt;version&gt;</code> tags for common
dependencies.</p>
</li>
<li>
<p>Generally useful test dependencies (JUnit, Hamcrest, Mockito)</p>
</li>
<li>
<p>Sensible resource filtering</p>
</li>
<li>
<p>Sensible plugin configuration (exec plugin, surefire, git commit ID, shade)</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_inheriting_the_starter_parent">Inheriting the starter parent</h5>
<div class="paragraph">
<p>To configure your project to inherit from the <code>spring-boot-starter-parent</code> simply set
the <code>parent</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint xml language-xml"><code>&lt;!-- Inherit defaults from Spring Boot --&gt;
&lt;parent&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
    &lt;version&gt;1.0.0.BUILD-SNAPSHOT&lt;/version&gt;
&lt;/parent&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
You should only need to specify the Spring Boot version number on this dependency.
if you import additional starters, you can safely omit the version number.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_using_your_own_parent_pom">Using your own parent POM</h5>
<div class="paragraph">
<p>If you don&#8217;t want to use the Spring Boot starter parent, you can use your own and still
keep the benefit of the dependency management (but not the plugin management) using a
<code>scope=import</code> dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint xml language-xml"><code>&lt;dependencyManagement&gt;
     &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;!-- Import dependency management from Spring Boot --&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
            &lt;version&gt;1.0.0.BUILD-SNAPSHOT&lt;/version&gt;
            &lt;scope&gt;import&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/dependencyManagement&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_changing_the_java_version">Changing the Java version</h5>
<div class="paragraph">
<p>The <code>spring-boot-starter-parent</code> chooses fairly conservative Java compatibility. If you
want to follow our recommendation and use a later Java version you can add a
<code>java.version</code> property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint xml language-xml"><code>&lt;properties&gt;
    &lt;java.version&gt;1.8&lt;/java.version&gt;
&lt;/properties&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_using_the_spring_boot_maven_plugin">Using the Spring Boot Maven plugin</h5>
<div class="paragraph">
<p>Spring Boot includes a Maven plugin that can package the project as an executable JAR, or
run it from source code. Add the plugin to your <code>&lt;plugins&gt;</code> section if you want to use it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint xml language-xml"><code>&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
You only need to add the plugin, there is no need for to configure it, unless you
want to change the settings in the parent.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_gradle">3.1.2. Gradle</h4>
<div class="paragraph">
<p>Gradle users can directly import &#8220;starter POMs&#8221; in their <code>dependencies</code> section. Unlike
Maven, there is no &#8220;super parent&#8221; to import.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint groovy language-groovy"><code>apply plugin: 'java'

repositories { mavenCentral() }
dependencies {
    compile("org.springframework.boot:spring-boot-starter-web")
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>spring-boot-gradle-plugin</code> is also available and provides tasks to create executable
JARs and run projects from source. It also adds a <code>ResolutionStrategy</code> that enables you
to omit the version number for common dependencies:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint groovy language-groovy"><code>buildscript {
    repositories { mavenCentral() }
    dependencies {
        classpath("org.springframework.boot:spring-boot-gradle-plugin:$1.0.0.BUILD-SNAPSHOT")
    }
}

apply plugin: 'java'
apply plugin: 'spring-boot'

repositories { mavenCentral() }
dependencies {
    compile("org.springframework.boot:spring-boot-starter-web")
    testCompile("org.springframework.boot:spring-boot-starter-test")
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ant">3.1.3. Ant</h4>
<div class="paragraph">
<p>It is possible to build a Spring Boot project using Apache Ant, however, no special
support or plugins are provided. Ant scripts can use the Ivy dependency system to import
starter POMs.</p>
</div>
<div class="paragraph">
<p>See XXX for more complete instructions.</p>
</div>
</div>
<div class="sect3">
<h4 id="_starter_poms">3.1.4. Starter POMs</h4>
<div class="paragraph">
<p>Starter POMs are a set of convenient dependency descriptors that you can include in your
application. You get a one-stop-shop for all the Spring and related technology that you
need, without having to hunt through sample code and copy paste loads of dependency
descriptors. For example, if you want to get started using Spring and JPA for database
access, just include the <code>spring-boot-starter-data-jpa</code> dependency in your project, and
you are good to go.</p>
</div>
<div class="paragraph">
<p>The starters contain a lot of the dependencies that you need to get a project up and
running quickly and with a consistent, supported set of managed transitive dependencies.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">What&#8217;s in a name</div>
<div class="paragraph">
<p>All starters follow a similar naming pattern; <code>spring-boot-starter-*</code>, where <code>*</code> is
a particular type of application. This naming structure is intended to help when you need
to find a starter. The Maven integration in many IDEs allow you to search dependencies by
name. For example, with the appropriate Eclipse or STS plugin installed, you can simply
hit <code>ctrl-space</code> in the POM editor and type <em>'spring-boot-starter</em>' for a complete list.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>The following application starters are provided by Spring Boot under the
<code>org.springframework.boot</code> group:</p>
</div>
<table class="tableblock frame-all grid-all" style="width:100%; ">
<caption class="title">Table 1. Spring Boot application starters</caption>
<colgroup>
<col style="width:50%;">
<col style="width:50%;"> 
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The core Spring Boot starter, including auto-configuration support, logging and YAML.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-amqp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Support for the &#8220;Advanced Message Queuing Protocol&#8221; via <code>spring-rabbit</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-aop</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Full AOP programming support including <code>spring-aop</code> and AspectJ.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-batch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Support for &#8220;Spring Batch&#8221; including HSQLDB database.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-data-jpa</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Full support for the &#8220;Java Persistence API&#8221; including <code>spring-data-jpa</code>, <code>spring-orm</code>
and Hibernate.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-data-mongodb</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Support for the MongoDB NoSQL Database, including <code>spring-data-mongodb</code>,</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-data-rest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Support for exposing Spring Data repositories over REST via <code>spring-data-rest-webmvc</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-integration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Support for common <code>spring-integration</code> modules.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-jdbc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JDBC Database support</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-mobile</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Support for <code>spring-mobile</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-redis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Support for the REDIS key-value data store, including <code>spring-redis</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-security</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Support for <code>spring-security</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-test</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Support for common test dependencies, including JUnit, Hamcrest and Mockito along with
 the <code>spring-test</code> module.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-thymeleaf</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Support for the Thymeleaf templating engine, including integration with Spring.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-web</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Support for full-stack web development, including Tomcat and <code>spring-webmvc</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-websocket</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Support for websocket development with Tomcat.</p></td>
</tr>
</tbody>
</table>

<div class="paragraph">
<p>In addition to the application starter, the following starters can be used to
add &#8220;production ready&#8221; features.</p>
</div>
<table class="tableblock frame-all grid-all" style="width:100%; ">
<caption class="title">Table 2. Spring Boot &#8220;production ready&#8221; starters</caption>
<colgroup>
<col style="width:50%;">
<col style="width:50%;"> 
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-actuator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds production ready features such as metrics and monitoring.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-shell-remote</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds remote <code>ssh</code> shell support.</p></td>
</tr>
</tbody>
</table>

<div class="paragraph">
<p>Finally, Spring Boot includes some starters that can be used if you want to exclude or
swap specific technical facets.</p>
</div>
<table class="tableblock frame-all grid-all" style="width:100%; ">
<caption class="title">Table 3. Spring Boot technical starters</caption>
<colgroup>
<col style="width:50%;">
<col style="width:50%;"> 
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-jetty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Imports the Jetty HTTP engine (to be used as an alternative to Tomcat)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-log4j</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Support the Log4J looggin framework</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-logging</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Import Spring Boot&#8217;s default logging framework (Logback).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-tomcat</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Import Spring Boot&#8217;s default HTTP engine (Tomcat).</p></td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="sect2">
<h3 id="_structuring_your_code">3.2. Structuring your code</h3>
<div class="paragraph">
<p>Spring Boot does not require any specific code layout to work, however, there are some
best practices that help.</p>
</div>
<div class="sect3">
<h4 id="_using_the_default_package">3.2.1. Using the &#8220;default&#8221; package</h4>
<div class="paragraph">
<p>When a class doesn&#8217;t include a <code>package</code> declaration it is considered to be in the
&#8220;default package&#8221;. The use of the &#8220;default package&#8221; is generally discouraged, and
should be avoided. It can cause particular problems for Spring Boot applications that
use <code>@ComponentScan</code> or <code>@EntityScan</code> annotations, since every class from every jar,
will be read.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
We recommend that you use the follow Java&#8217;s recommended package naming conventions
and use a reversed domain name (for example, <code>com.example.project</code>).
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_locating_the_main_application_class">3.2.2. Locating the main application class</h4>
<div class="paragraph">
<p>We generally recommend that you locate your main application class in a root package
above other classes. The <code>@EnableAutoConfiguration</code> annotation is often placed on your
main class, and it implicitly defines a base &#8220;search package&#8221; for certain items. For
example, if you are writing a JPA application, the package of the
<code>@EnableAutoConfiguration</code> annotated class will be used to search for <code>@Entity</code> items.</p>
</div>
<div class="paragraph">
<p>Using a root package also allows the <code>@ComponentScan</code> annotation to be used without
needing to specify a <code>basePackage</code> attribute.</p>
</div>
<div class="paragraph">
<p>Here is a typical layout:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>com
 +- example
     +- myproject
         +- Application.java
         |
         +- domain
         |   +- Customer.java
         |   +- CustomerRepository.java
         |
         +- service
         |   +- CustomerService.java
         |
         +- web
             +- CustomerController.java</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Application.java</code> file would declare the <code>main</code> method, along with the basic
<code>@Configuration</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>package com.example.myproject;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.EnableAutoConfiguration;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;

@Configuration
@EnableAutoConfiguration
@ComponentScan
public class Application {

    public static void main(String[] args) {
        SpringApplication.run(Application.class, args);
    }

}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="__configuration_classes">3.3. @Configuration classes</h3>
<div class="paragraph">
<p>Spring Boot favors Java-based configuration. Although it is possible to call
<code>SpringApplication.run()</code> with an XML source, we generally recommend that your primary
source is a <code>@Configuration</code> class. Usually the class that defines the <code>main</code> method
is also a good candidate as the primary <code>@Configuration</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
Many Spring configuration examples have been published that use XML configuration.
Always try to use the equivalent Java-base configuration if possible. Searching for
<code>enable*</code> annotations can be a good starting point.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_importing_additional_configuration_classes">3.3.1. Importing additional configuration classes</h4>
<div class="paragraph">
<p>You don&#8217;t need to put all your <code>@Configuration</code> into a single class. The <code>@Import</code>
annotation an be used to import additional configuration classes. Alternatively, you
can use <code>@ComponentScan</code> to automatically pickup all Spring components, including
<code>@Configuration</code> classes.</p>
</div>
</div>
<div class="sect3">
<h4 id="_importing_xml_configuration">3.3.2. Importing XML configuration</h4>
<div class="paragraph">
<p>If you absolutely must use XML based configuration we recommend that you still start
with a <code>@Configuration</code> class. You can then use an additional <code>@ImportResource</code>
annotation to load XML configuration files.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_auto_configuration">3.4. Auto-configuration</h3>
<div class="paragraph">
<p>Spring Boot auto-configuration attempts to automatically configure your Spring
application based on the JAR dependencies that you have added. For example, If
<code>HSQLDB</code> is on your classpath, and you have not manually configured any database
connection beans, then we will auto-configure an in-memory database.</p>
</div>
<div class="paragraph">
<p>You need to opt-in to auto-configuration by adding the <code>@EnableAutoConfiguration</code>
annotation to one of your <code>@Configuration</code> classes.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
You should only ever add one <code>@EnableAutoConfiguration</code> annotation. We generally
recommend that you add it to your primary <code>@Configuration</code> class.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_gradually_replacing_auto_configuration">3.4.1. Gradually replacing auto-configuration</h4>
<div class="paragraph">
<p>Auto-configuration is noninvasive,  at any point you can start to define your own
configuration to replace specific parts of the auto-configuration. For example, if
you add your own <code>DataSource</code> bean, the default embedded database support will back away.</p>
</div>
<div class="paragraph">
<p>If you need to find out what auto-configuration is currently being applied, and why,
starting your application with the <code>--debug</code> switch. This will log an auto-configuration
report to the console.</p>
</div>
</div>
<div class="sect3">
<h4 id="_disabling_specific_auto_configuration">3.4.2. Disabling specific auto-configuration</h4>
<div class="paragraph">
<p>If you find that specific auto-configure classes are being applied that you don&#8217;t want
you can use the exclude attribute of <code>@EnableAutoConfiguration</code> to disable them.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>import org.springframework.boot.autoconfigure.*;
import org.springframework.boot.autoconfigure.jdbc.*;
import org.springframework.context.annotation.*;

@Configuration
@EnableAutoConfiguration(exclude={EmbeddedDatabaseConfiguration.class})
public class MyConfiguration {
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_spring_beans_and_dependency_injection">3.5. Spring Beans and dependency injection</h3>
<div class="paragraph">
<p>You are free to use any the standard Spring Framework techniques to defines your beans
and their injected dependencies. For simplicity, we often find that using <code>@ComponentScan</code>
to find your beans, in combination with <code>@Autowired</code> constructor injection works well.</p>
</div>
<div class="paragraph">
<p>If you structure your code as suggested above (locating your application class in a root
package), you can add <code>@ComponentScan</code> without any arguments. All of your application
components (<code>@Component</code>, <code>@Service</code>, <code>@Repoistory</code>, <code>@Controller</code> etc.) will be
automatically registered as Spring Beans.</p>
</div>
<div class="paragraph">
<p>Here is an example <code>@Service</code> Bean that uses constructor injection to obtain its'
required <code>RiskAssessor</code> bean.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>package com.example.service;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

@Service
public class DatabaseAccountService implements AccountService {

    private final RiskAssessor riskAssessor;

    @Autowired
    public DatabaseAccountService(RiskAssessor riskAssessor) {
        this.riskAssessor = riskAssessor;
    }

    // ...

}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
Notice how using constructor injection allows the <code>riskAssessor</code> field to be marked
as <code>final</code>, indicating that it cannot be subsequently changed.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_running_your_application">3.6. Running your application</h3>
<div class="paragraph">
<p>One of the biggest advantages of packaging your application as JAR and using an embedded
HTTP server is that you can run your application as you would any other. Debugging Spring
Boot applications is also easy; you don&#8217;t need any special IDE plugins or extensions.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
This section only covers JAR pased packaging, If you choose to package your
application as a WAR file you should refer to your server and IDE documentation.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_running_from_an_ide">3.6.1. Running from an IDE</h4>
<div class="paragraph">
<p>You can run a Spring Boot application from your IDE as a simple Java application, however,
first you will need to import your project. Import steps will vary depending on your IDE
and build system. Most IDEs can import Maven projects directly, for example Eclipse users
can select <code>Import...</code> &#8594; <code>Existing Maven Projects</code> from the <code>File</code> menu.</p>
</div>
<div class="paragraph">
<p>If you can&#8217;t directly import your project into your IDE, you may be able to generate IDE
meta-data using a build plugin. Maven includes plugins for
<a href="http://maven.apache.org/plugins/maven-eclipse-plugin/">Eclipse</a> and
<a href="http://maven.apache.org/plugins/maven-idea-plugin/">IDEA</a>; Gradle offers plugins
for <a href="http://www.gradle.org/docs/current/userguide/ide_support.html">various IDEs</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
If you accidentally run a web application twice you will see a &#8220;Port already in
use&#8221; error. STS users can use the <code>Relauch</code> button rather than <code>Run</code> to ensure that
any existing instance is closed.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_as_a_packaged_application">3.6.2. As a packaged application</h4>
<div class="paragraph">
<p>If you use the Spring Boot Maven or Gradle plugins to create an executable JAR you can
run your application using <code>java -jar</code>. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ java -jar target/myproject-0.0.1-SNAPSHOT.jar</pre>
</div>
</div>
<div class="paragraph">
<p>It is also possible to run a package application with remote debugging support enabled.
This allows you to attach a debugger to your packaged application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ java -Xdebug -Xrunjdwp:server=y,transport=dt_socket,address=8000,suspend=n \
       -jar target/myproject-0.0.1-SNAPSHOT.jar</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_using_the_maven_plugin">3.6.3. Using the Maven plugin</h4>
<div class="paragraph">
<p>The Spring Boot Maven plugin includes a <code>run</code> goal which can be used to quickly compile
and run your application. Applications run in an exploded form, and you can edit
resources for instant &#8220;hot&#8221; reload.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ mvn spring-boot:run</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_using_the_gradle_plugin">3.6.4. Using the Gradle plugin</h4>
<div class="paragraph">
<p>The Spring Boot Gradle plugin also includes a <code>run</code> goal which can be used to run
your application in an exploded form. The <code>bootRun</code> task is added whenever you import
the <code>spring-boot-plugin</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ gradle bootRun</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_hot_swapping">3.6.5. Hot swapping</h4>
<div class="paragraph">
<p>Since Spring Boot applications are just plain Java application, JVM hot-swapping should
work out of the box. JVM hot swapping is somewhat limited with bytecode that it can
replace, for a more complete solution the
<a href="https://github.com/spring-projects/spring-loaded">Spring Loaded</a> project, or
<a href="http://zeroturnaround.com/software/jrebel/">JRebel</a> can be used.</p>
</div>
<div class="paragraph">
<p>See the Hot swapping &#8220;How-to&#8221; section for details.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_packaging_your_application_for_production">3.7. Packaging your application for production</h3>
<div class="paragraph">
<p>Executable JARs can be used for production deployment. As they are self contained, they
are also ideally suited for cloud-based deployment.</p>
</div>
<div class="paragraph">
<p>For additional &#8220;production ready&#8221; features, such as health, auditing and metric REST
or JMX end-points; consider adding <code>spring-boot-actuator</code>. See XXX</p>
</div>
</div>
<div class="sect2">
<h3 id="_what_to_read_next_2">3.8. What to read next</h3>

</div>
</div>
</div>
<div class="sect1">
<h2 id="_springapplication">4. SpringApplication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>SpringApplication</code> class provides a convenient way to bootstrap a Spring application
that will be started from a <code>main()</code> method. In many situations you can just delegate to
the static <code>SpringApplication.run</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>public static void main(String[] args) {
    SpringApplication.run(MySpringConfiguration.class, args);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you application starts you should see something similar to the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::   v1.0.0.BUILD-SNAPSHOT

2013-07-31 00:08:16.117  INFO 56603 --- [           main] o.s.b.s.app.SampleApplication            : Starting SampleApplication v0.1.0 on mycomputer with PID 56603 (/apps/myapp.jar started by pwebb)
2013-07-31 00:08:16.166  INFO 56603 --- [           main] ationConfigEmbeddedWebApplicationContext : Refreshing org.springframework.boot.context.embedded.AnnotationConfigEmbeddedWebApplicationContext@6e5a8246: startup date [Wed Jul 31 00:08:16 PDT 2013]; root of context hierarchy
2014-03-04 13:09:54.912  INFO 41370 --- [           main] .t.TomcatEmbeddedServletContainerFactory : Server initialized with port: 8080
2014-03-04 13:09:56.501  INFO 41370 --- [           main] o.s.b.s.app.SampleApplication            : Started SampleApplication in 2.992 seconds (JVM running for 3.658)</pre>
</div>
</div>
<div class="paragraph">
<p>By default <code>INFO</code> logging messages will shown, including some relevant startup details
such as the user that launched the application.</p>
</div>
<div class="sect2">
<h3 id="_customizing_springapplication">4.1. Customizing SpringApplication</h3>
<div class="paragraph">
<p>If the <code>SpringApplication</code> defaults aren&#8217;t to your taste you can instead create a local
instance and customize it. For example, to turn off the banner you would write:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>public static void main(String[] args) {
    SpringApplication app = new SpringApplication(MySpringConfiguration.class);
    app.setShowBanner(false);
    app.run(args);
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
The constructor arguments passed to <code>SpringApplication</code> are configuration sources
for spring beans. In most cases these will be references to <code>@Configuration</code> classes, but
they could also be references to XML configuration or to packages that should be scanned.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It is also possible to configure the <code>SpringApplication</code> using an <code>application.properties</code>
file. See XXX.</p>
</div>
<div class="paragraph">
<p>For a complete list of the configuration options, see the <code>SpringApplication</code> Javadoc.</p>
</div>
</div>
<div class="sect2">
<h3 id="_fluent_builder_api">4.2. Fluent builder API</h3>
<div class="paragraph">
<p>If you need to build an <code>ApplicationContext</code> hierarchy (multiple contexts with a
parent/child relationship), or if you just prefer using a &#8220;fluent&#8221; builder API, you
can use the <code>SpringApplicationBuilder</code>.</p>
</div>
<div class="paragraph">
<p>The <code>SpringApplicationBuilder</code> allows you to chain together multiple method calls, and
includes <code>parent</code> and <code>child</code> methods that allow you to create a hierarchy.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>new SpringApplicationBuilder()
    .showBanner(false)
    .sources(Parent.class)
    .child(Application.class)
    .run(args);</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
There are some restrictions when creating an <code>ApplicationContext</code> hierarchy, e.g.
the parent application context is <strong>not</strong> a <code>WebApplicationContext</code>.  Both parent and child
are executed with the same <code>Environment</code> constructed in the usual way to include command
line arguments.  Any <code>ServletContextAware</code> components all have to go in the child
context, otherwise there is no way for Spring Boot to create the <code>ServletContext</code> in time.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_application_events_and_listeners">4.3. Application events and listeners</h3>
<div class="paragraph">
<p>In addition to the usual Spring Framework events, such as <code>ContextRefreshedEvent</code>, a
<code>SpringApplication</code> sends some additional application events. Some events are actually
triggered before the <code>ApplicationContext</code> is created.</p>
</div>
<div class="paragraph">
<p>You can register event listeners in a number of ways, the most common being
<code>SpringApplication.addListeners(...)</code> method (See XXX).</p>
</div>
<div class="paragraph">
<p>Application events are sent in the following order, as your application runs:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>An <code>ApplicationStartedEvent</code> is sent at the start of a run, but before any
processing except the registration of listeners and initializers.</p>
</li>
<li>
<p>An <code>ApplicationEnvironmentPreparedEvent</code> is sent when the <code>Environment</code> to be used in
the context is known, but before the context is created.</p>
</li>
<li>
<p>An <code>ApplicationPreparedEvent</code> is sent just before the refresh is started, but after bean
definitions have been loaded.</p>
</li>
<li>
<p>An <code>ApplicationFailedEvent</code> is sent if there is an exception on startup.</p>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
You often won&#8217;t need to use application events, but it can be handy to know that they
exist. Internally, Spring Boot uses events to handle a variety of tasks.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_web_environment">4.4. Web environment</h3>
<div class="paragraph">
<p>A <code>SpringApplication</code> will attempt to create the right type of <code>ApplicationContext</code> on
your behalf. By default, an <code>AnnotationConfigApplicationContext</code> or
<code>AnnotationConfigEmbeddedWebApplicationContext</code> will be used, depending on whether you
are developing a web application or not.</p>
</div>
<div class="paragraph">
<p>The algorithm used to determine a &#8220;web environment&#8221; is fairly simplistic (based on the
presence of a few classes). You can use <code>setWebEnvironment(boolean webEnvironment)</code> if
you need to override the default.</p>
</div>
<div class="paragraph">
<p>It is also possible to take complete control of the <code>ApplicationContext</code> type that will
be used by using <code>setApplicationContextClass(...)</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
It is often desirable call <code>setWebEnvironment(false)</code> when using <code>SpringApplication</code>
within a JUnit test.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_using_the_commandlinerunner">4.5. Using the CommandLineRunner</h3>
<div class="paragraph">
<p>If you want access to the raw command line argument, or you need to run some specific code
once the <code>SpringApplication</code> has started you can implement the <code>CommandLineRunner</code>
interface. The <code>run(String... args)</code> method will be called on all spring beans
implementing this interface.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>import org.springframework.boot.*
import org.springframework.stereotype.*

@Component
public class MyBean implements CommandLineRunner {

    public void run(String... args) {
        // Do something...
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can additionally implement the <code>org.springframework.core.Ordered</code> interface or use the
<code>org.springframework.core.annotation.Order</code> annotation if several <code>CommandLineRunner</code>
beans are defined that must be called in a specific order.</p>
</div>
</div>
<div class="sect2">
<h3 id="_application_exit">4.6. Application exit</h3>
<div class="paragraph">
<p>Each <code>SpringApplication</code> will register a shutdown hook with the JVM to ensure that the
<code>ApplicationContext</code> is closed gracefully on exit. All the standard Spring lifecycle
callbacks (such as the <code>DisposableBean</code> interface, or the <code>@PreDestroy</code> annotation) can
be used.</p>
</div>
<div class="paragraph">
<p>In addition, beans may implement the <code>org.springframework.boot.ExitCodeGenerator</code>
interface if they wish to return a specific exit code when the application ends.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_externalized_configuration">5. Externalized Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Boot likes you to externalize your configuration so you can work with the same
application code in different environments. You can use properties files, YAML files,
environment variables and command-line arguments to externalize configuration. Property
values can be injected directly into your beans using the <code>@Value</code> annotation, accessed
via Spring&#8217;s <code>Environment</code> abstraction or bound to structured objects.</p>
</div>
<div class="paragraph">
<p>Spring Boot uses a very particular <code>PropertySource</code> order that is designed to allow
sensible overriding of values, properties are considered in the the following order:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Command line argument</p>
</li>
<li>
<p>Java System properties (<code>System.getProperties()</code>).</p>
</li>
<li>
<p>OS environment variables.</p>
</li>
<li>
<p><code>@PropertySource</code> annotations on your <code>@Configuration</code> classes.</p>
</li>
<li>
<p>Application properties outside of your packaged JAR (<code>application.properties</code>
including YAML and profile variants)</p>
</li>
<li>
<p>Application properties packaged inside your JAR (<code>application.properties</code>
including YAML and profile variants)</p>
</li>
<li>
<p>Default properties (specified using <code>SpringApplication.setDefaultProperties</code>)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To provide a concrete example, suppose you develop a <code>@Component</code> that uses a
<code>name</code> property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>import org.springframework.stereotype.*
import org.springframework.beans.factory.annotation.*

@Component
public class MyBean {

    @Value("${name}")
    private String name;

    // ...

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can bundle an <code>application.properties</code> inside your jar that provides a sensible
default <code>name</code>. When running in production, an <code>application.properties</code> can be provided
outside of your JAR that overrides <code>name</code>; and for one off testing you can launch with
a specific command line switch (e.g. <code>java -jar app.jar --name="Spring"</code>).</p>
</div>
<div class="sect2">
<h3 id="_accessing_command_line_properties">5.1. Accessing command line properties</h3>
<div class="paragraph">
<p>By default SpringApplication will convert any command line option arguments (starting
with &#8220;--&#8221;, e.g. <code>--server.port=9000</code>) to a <code>PropertySource</code> and add it to the Spring
<code>Environment</code>. As mentioned above, command line properties always take precedence over
other property sources.</p>
</div>
<div class="paragraph">
<p>If you don&#8217;t want command line properties to be added to the <code>Environment</code> you can disable
them using <code>SpringApplication.setAddCommandLineProperties(false)</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_application_property_files">5.2. Application property files</h3>
<div class="paragraph">
<p><code>SpringApplication</code> will load properties from <code>application.properties</code> files in the
following locations and add them to the Spring <code>Environment</code>:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The current directory</p>
</li>
<li>
<p>A <code>/config</code> subdir of the current directory.</p>
</li>
<li>
<p>The classpath root</p>
</li>
<li>
<p>A classpath <code>/config</code> package</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The list is ordered by precedence (locations higher in the list override lower items).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
You can also use YAML (<em>.yml</em>) files as an alternative to <em>.properties</em> (see below)
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you don&#8217;t like <code>application.properties</code> as the configuration file name you can switch
to another by specifying <code>spring.config.name</code> environment property. You can also refer
to an explicit location using the <code>spring.config.location</code> environment property.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ java -jar myproject.jar --spring.config.name=myproject</pre>
</div>
</div>
<div class="sect3">
<h4 id="_profile_specific_properties">5.2.1. Profile specific properties</h4>
<div class="paragraph">
<p>In addition to <code>application.properties</code> files, profile specific properties can also be
defined using the naming convention <code>application-{profile}.properties</code>.</p>
</div>
<div class="paragraph">
<p>Profile specific properties are loaded from the same locations as standard
<code>application.properties</code>, with profiles specific files overriding the default ones.</p>
</div>
</div>
<div class="sect3">
<h4 id="_placeholders_in_properties">5.2.2. Placeholders in properties</h4>
<div class="paragraph">
<p>The values in <code>application.properties</code> are filtered through the existing <code>Environment</code>
when they are used so you can refer back to previously defined values (e.g. from System
properties).</p>
</div>
<div class="listingblock">
<div class="content">
<pre>app.name: MyApp
app.description: ${app.name} is a Spring Boot application</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
You can also use this technique to create <code>short</code> variants of existing Spring Boot
properties. See XXX
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_yaml_instead_of_properties">5.3. Using YAML instead of Properties</h3>
<div class="paragraph">
<p><a href="http://yaml.org">YAML</a> is a superset of JSON, and as such is a very convenient format
for specifying hierarchical configuration data. The <code>SpringApplication</code> class will
automatically support YAML as an alternative to properties whenever you have the
<a href="http://code.google.com/p/snakeyaml/">SnakeYAML</a> library on your classpath.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
If you use &#8220;starter POMs&#8221; SnakeYAML will be automatically provided via
<code>spring-boot-starter</code>.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_loading_yaml">5.3.1. Loading YAML</h4>
<div class="paragraph">
<p>Spring Boot provides two convenient classes that can be used to load YAML documents. The
<code>YamlPropertiesFactoryBean</code> will load YAML as <code>Properties</code> and the <code>YamlMapFactoryBean</code>
will load YAML as a <code>Map</code>.</p>
</div>
<div class="paragraph">
<p>For example, the following YAML document:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint yaml language-yaml"><code>dev:
    url: http://dev.bar.com
    name: Developer Setup
prod:
    url: http://foo.bar.com
    name: My Cool App</code></pre>
</div>
</div>
<div class="paragraph">
<p>Would be transformed into these properties:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>environments.dev.url=http://dev.bar.com
environments.dev.name=Developer Setup
environments.prod.url=http://foo.bar.com
environments.prod.name=My Cool App</pre>
</div>
</div>
<div class="paragraph">
<p>YAML lists are represented as comma-separated values (useful for simple String values)
and also as property keys with <code>[index]</code> dereferencers, for example this YAML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint yaml language-yaml"><code>servers:
    - dev.bar.com
    - foo.bar.com</code></pre>
</div>
</div>
<div class="paragraph">
<p>Would be transformed into these properties:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>servers=dev.bar.com,foo.bar.com
servers[0]=dev.bar.com
servers[1]=foo.bar.com</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_exposing_yaml_as_properties_in_the_spring_environment">5.3.2. Exposing YAML as properties in the Spring Environment.</h4>
<div class="paragraph">
<p>The <code>YamlPropertySourceLoader</code> class can be used to expose YAML as a <code>PropertySource</code>
in the Spring <code>Environment</code>. This allows you to the familiar <code>@Value</code> with placeholders
syntax to access YAML properties.</p>
</div>
</div>
<div class="sect3">
<h4 id="_multi_profile_yaml_documents">5.3.3. Multi-profile YAML documents</h4>
<div class="paragraph">
<p>You can specify multiple profile-specific YAML document in a single file by
by using a <code>spring.profiles</code> key to indicate when the document applies. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint yaml language-yaml"><code>server:
    address: 192.168.1.100
---
spring:
    profiles: production
server:
    address: 192.168.1.120</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_yaml_shortcomings">5.3.4. YAML shortcomings</h4>
<div class="paragraph">
<p>YAML files can&#8217;t be loaded via the <code>@PropertySource</code> annotation. So in the
case that you need to load values that way, you need to use a properties file.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_typesafe_configuration_properties">5.4. Typesafe Configuration Properties</h3>
<div class="paragraph">
<p>Using the <code>@Value("${property}")</code> annotation to inject configuration properties can
sometimes be cumbersome, especially if you are working with multiple properties or
your data is hierarchical in nature. Spring Boot provides an alternative method
of working with properties that allows strongly typed beans to govern and validate
the configuration of your application. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>@Component
@ConfigurationProperties(name="connection")
public class ConnectionSettings {

    private String username;

    private InetAddress remoteAddress;

    // ... getters and setters

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the <code>@EnableConfigurationProperties</code> annotation is applied to your <code>@Configuration</code>,
any beans annotated with <code>@ConfigurationProperties</code> will automatically be configured
from the <code>Environment</code> properties. This style of configuration works particularly well
with the <code>SpringApplication</code> external YAML configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint yaml language-yaml"><code># application.yml

connection:
    username: admin
    remoteAddress: 192.168.1.1

# additional configuration as required</code></pre>
</div>
</div>
<div class="paragraph">
<p>To work with <code>@ConfigurationProperties</code> beans you can just inject them in the same way
as any other bean.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>@Service
public class MyService {

    @Autowired
    private ConnectionSettings connection;

     //...

    @PostConstruct
    public void openConnection() {
        Server server = new Server();
        this.connection.configure(server);
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is also possible to shortcut the registration of <code>@ConfigurationProperties</code> bean
definitions by simply listing the properties classes directly in the
<code>@EnableConfigurationProperties</code> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>@Configuration
@EnableConfigurationProperties(ConnectionSettings.class)
public class MyConfiguration {
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_relaxed_binding">5.4.1. Relaxed binding</h4>
<div class="paragraph">
<p>Spring Boot uses some relaxed rules for binding <code>Environment</code> properties to
<code>@ConfigurationProperties</code> beans, so there doesn&#8217;t need to be an exact match between
the <code>Environment</code> property name and the bean property name.  Common examples where this
is useful include underscore separated (e.g. <code>context_path</code> binds to <code>contextPath</code>), and
capitalized (e.g. <code>PORT</code> binds to <code>port</code>) environment properties.</p>
</div>
<div class="paragraph">
<p>Spring will attempt to coerce the external application properties to the right type when
it binds to the <code>@ConfigurationProperties</code> beans. If you need custom type conversion you
can provide a <code>ConversionService</code> bean (with bean id <code>conversionService</code>) or custom
property editors (via a <code>CustomEditorConfigurer</code> bean).</p>
</div>
</div>
<div class="sect3">
<h4 id="__configurationproperties_validation">5.4.2. @ConfigurationProperties Validation</h4>
<div class="paragraph">
<p>Spring Boot will attempt to validate external configuration, by default using JSR-303
(if it is on the classpath). You can simply add JSR-303 <code>javax.valididation</code> constraint
annotations to your <code>@ConfigurationProperties</code> class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>@Component
@ConfigurationProperties(name="connection")
public class ConnectionSettings {

    @NotNull
    private InetAddress remoteAddress;

    // ... getters and setters

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also add a custom Spring <code>Validator</code> by creating a bean definition called
<code>configurationPropertiesValidator</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
The <code>spring-boot-actuator</code> includes an end-point that exposes all
<code>@ConfigurationProperties</code> beans. Simply point your web browser to <code>/configprops</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_profiles">6. Profiles</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Profiles are a way to segregate parts of the application configuration and make it
only available in certain environments.  Any <code>@Component</code> or <code>@Configuration</code> can be
marked with <code>@Profile</code> to limit when it is loaded:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>@Configuration
@Profile("production")
public class ProductionConfiguraiton {

    // ...

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Spring Boot takes this a stage further, in that you can use a <code>spring.profiles.active</code>
<code>Environment</code> property to specify which profiles are active. You can specify the property
in any of the usual ways, for example you could include it in your
<code>application.properties</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>spring.profiles.active=dev,hsqldb</pre>
</div>
</div>
<div class="paragraph">
<p>or specify on the command line using the switch <code>--spring.profiles.active=dev,hsqldb</code>.</p>
</div>
<div class="sect2">
<h3 id="_adding_active_profiles">6.1. Adding active profiles</h3>
<div class="paragraph">
<p>The <code>spring.profiles.active</code> property follows the same ordering rules as other
properties, the highest <code>PropertySource</code> will win. This means that you can specify
active profiles in <code>application.properties</code> then <strong>replace</strong> them using the command line
switch.</p>
</div>
<div class="paragraph">
<p>Sometimes it is useful to have profile specific properties that <strong>add</strong> to the active
profiles rather than replace them. The <code>+</code> prefix can be used to add active profiles.</p>
</div>
<div class="paragraph">
<p>For example, when an application with following properties is run using the switch
<code>--spring.profiles.active=prod</code> the <code>proddb</code> and <code>prodmq</code> profiles will also be activated:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint yaml language-yaml"><code>---
my.property: fromyamlfile
---
spring.profiles: prod
spring.profiles.active: +proddb,+prodmq</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_programmatically_setting_profiles">6.2. Programmatically setting profiles</h3>
<div class="paragraph">
<p>You can programmatically set active profiles by calling
<code>SpringApplication.setAdditionalProfiles(...)</code> before your application runs. It is also
possible to activate profiles using Spring&#8217;s <code>ConfigurableEnvironment</code> interface.</p>
</div>
</div>
<div class="sect2">
<h3 id="_profile_specific_configuration_files">6.3. Profile specific configuration files</h3>
<div class="paragraph">
<p>Profile specific variants of both <code>application.properties</code> (or <code>application.yml</code>) and
files referenced via <code>@ConfigurationProperties</code> are considered as files are loaded.
See XXX and XXX for details.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_logging">7. Logging</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Boot uses <a href="http://commons.apache.org/logging">Commons Logging</a> for all internal
logging, but leaves the underlying log implementation open. Default configurations are
provided for
<a href="http://docs.oracle.com/javase/7/docs/api/java/util/logging/package-summary.html">Java Util Logging</a>,
<a href="http://logging.apache.org/log4j/">Log4J</a> and
<a href="http://logback.qos.ch/">Logback</a>.
In each case there is console output and file output (rotating, 10 Mb file size).</p>
</div>
<div class="paragraph">
<p>By default, If you use the &#8220;Starter POMs&#8221;, Logback will be used for logging. Appropriate
Logback routing is also included to ensure that dependent libraries that use
Java Util Logging, Commons Logging, Log4J or SLF4J will all work correctly.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
There are a lot of logging frameworks available for Java. Don&#8217;t worry if the above
list seems confusing, generally you won&#8217;t need to change your logging dependencues and
the Spring Boot defaults will work just fine.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_log_format">7.1. Log format</h3>
<div class="paragraph">
<p>The default log output from Spring Boot looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>2014-03-05 10:57:51.112  INFO 45469 --- [           main] org.apache.catalina.core.StandardEngine  : Starting Servlet Engine: Apache Tomcat/7.0.52
2014-03-05 10:57:51.253  INFO 45469 --- [ost-startStop-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2014-03-05 10:57:51.253  INFO 45469 --- [ost-startStop-1] o.s.web.context.ContextLoader            : Root WebApplicationContext: initialization completed in 1358 ms
2014-03-05 10:57:51.698  INFO 45469 --- [ost-startStop-1] o.s.b.c.e.ServletRegistrationBean        : Mapping servlet: 'dispatcherServlet' to [/]
2014-03-05 10:57:51.702  INFO 45469 --- [ost-startStop-1] o.s.b.c.embedded.FilterRegistrationBean  : Mapping filter: 'hiddenHttpMethodFilter' to: [/*]</pre>
</div>
</div>
<div class="paragraph">
<p>The following items are output:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Date and Time&#8201;&#8212;&#8201;Millesecond precision and easily sortable</p>
</li>
<li>
<p>Log Level&#8201;&#8212;&#8201;<code>ERROR</code>, <code>WARN</code>, <code>INFO</code>, <code>DEBUG</code> or <code>TRACE</code></p>
</li>
<li>
<p>Process ID</p>
</li>
<li>
<p>A <code>---</code> separator to distinguish the start of actual log messages</p>
</li>
<li>
<p>Logger name&#8201;&#8212;&#8201;This is usually the source class name (often abbreviated)</p>
</li>
<li>
<p>The log message</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_console_output">7.2. Console output</h3>
<div class="paragraph">
<p>The default log configuration will echo messages to the console as they written. By
default <code>ERROR</code>, <code>WARN</code> and <code>INFO</code> level messages are logged. To also log <code>DEBUG</code> level
messages to the console you can start your application with a <code>--debug</code> flag.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ java -jar myapp.jar --debug</pre>
</div>
</div>
<div class="paragraph">
<p>If your terminal supports ANSI, color output will be used to aid readability.</p>
</div>
</div>
<div class="sect2">
<h3 id="_file_output">7.3. File output</h3>
<div class="paragraph">
<p>By default, log files are written to <code>spring.log</code> in your <code>temp</code> directory and rotate at
10 Mb. You can easily customize the output folder by setting the <code>logging.path</code> property
(for example in your <code>application.properties</code>). It is also possible to change the filename
using a <code>logging.file</code> property.</p>
</div>
<div class="paragraph">
<p>As with console output, <code>ERROR</code>, <code>WARN</code> and <code>INFO</code> level messages are logged by default.</p>
</div>
</div>
<div class="sect2">
<h3 id="_custom_log_configuration">7.4. Custom log configuration</h3>
<div class="paragraph">
<p>The various logging systems can be activated by including the appropriate libraries on
the classpath, and further customized by supported by providing a suitable configuration
file in the root of the classpath, or in a location specified by the Spring <code>Environment</code>
property <code>logging.config</code>.</p>
</div>
<div class="paragraph">
<p>Depending on your logging system, the following files will be loaded:</p>
</div>
<table class="tableblock frame-all grid-all" style="width:100%; ">
<colgroup>
<col style="width:50%;">
<col style="width:50%;"> 
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Logging System</th>
<th class="tableblock halign-left valign-top">Customization</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logback</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logback.xml</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Log4j</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>log4j.properties</code> or <code>log4j.xml</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JDK (Java Util Logging)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logging.properties</code></p></td>
</tr>
</tbody>
</table>

<div class="paragraph">
<p>To help with the customization some other properties are transferred from the Spring
<code>Environment</code> to System properties:</p>
</div>
<table class="tableblock frame-all grid-all" style="width:100%; ">
<colgroup>
<col style="width:33%;">
<col style="width:33%;">
<col style="width:33%;"> 
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Spring Environment</th>
<th class="tableblock halign-left valign-top">System Property</th>
<th class="tableblock halign-left valign-top">Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logging.file</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LOG_FILE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used in default log configuration if defined</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logging.path</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LOG_PATH</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used in default log configuration if defined</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PID</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PID</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The current process ID is discovered if possible and not already provided</p></td>
</tr>
</tbody>
</table>

<div class="paragraph">
<p>All the logging systems supported can consult System properties when parsing their
configuration files.  See the default configurations in <code>spring-boot.jar</code> for examples.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="icon-warning" title="Warning"></i>
</td>
<td class="content">
There are know classloading issues with Java Util Logging that cause problems
when running from an &#8220;executable JAR&#8221;. We recommend that you avoid it if at all
possible.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_developing_web_applications">8. Developing web applications</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Boot is well suited for web application development. You can easily create a
self-contained HTTP server using embedded Tomcat or Jetty. Most web applications will
use the <code>spring-boot-starter-web</code> module to get up and running quickly.</p>
</div>
<div class="paragraph">
<p>If you haven&#8217;t yet developed a Spring Boot web application you can follow the
"Hello World!" example in XXX</p>
</div>
<div class="sect2">
<h3 id="_the_spring_web_mvc_framework">8.1. The &#8220;Spring Web MVC framework&#8221;</h3>
<div class="paragraph">
<p>The Spring Web MVC framework (often referred to as simply &#8220;Spring MVC&#8221;) is a rich
&#8220;model view controller&#8221; web framework. Spring MVC lets you create special <code>@Controller</code>
or <code>@RestController</code> beans to handle incoming HTTP requests. Methods in your controller
are mapped to HTTP using <code>@RequestMapping</code> annotations.</p>
</div>
<div class="paragraph">
<p>Here is a typical example <code>@RestController</code> to serve JSON data:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>@RestController
@RequestMapping(value="/users")
public class MyRestController {

    @RequestMapping(value="/{user}", method=RequestMethod.GET)
    public User getUser(@PathVariable Long user) {
        // ...
    }

    @RequestMapping(value="/{user}/customers", method=RequestMethod.GET)
    List&lt;Customer&gt; getUserCustomers(@PathVariable Long user) {
        // ...
    }

    @RequestMapping(value="/{user}", method=RequestMethod.DELETE)
    public User deleteUser(@PathVariable Long user) {
        // ...
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Spring MVC is part of the core Spring Framework and detailed information is available in
the reference documentation. There are also several guides available at
<a href="http://spring.io/guides">http://spring.io/guides</a> that cover Spring MVC.</p>
</div>
<div class="sect3">
<h4 id="_spring_mvc_auto_configuration">8.1.1. Spring MVC auto-configuration</h4>
<div class="paragraph">
<p>Spring Boot provides auto-configuration for Spring MVC that works well with most
applications. If you want to take complete control of Spring MVC you can add your
own <code>@Configuration</code> annotated with <code>@EnableWebMvc</code>.</p>
</div>
<div class="paragraph">
<p>The auto-configuration adds the following features on top of Spring&#8217;s defaults:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Inclusion of <code>ContentNegotiatingViewResolver</code> and <code>BeanNameViewResolver</code> beans.</p>
</li>
<li>
<p>Support for serving static resources, including support for WebJars (see below).</p>
</li>
<li>
<p>Automatic registration of <code>Converter</code>, <code>GenericConverter</code>, <code>Formatter</code> beans.</p>
</li>
<li>
<p>Support for <code>HttpMessageConverters</code> (see below).</p>
</li>
<li>
<p>Static <code>index.html</code> support.</p>
</li>
<li>
<p>Custom <code>Favicon</code> support.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_httpmessageconverters">8.1.2. HttpMessageConverters</h4>
<div class="paragraph">
<p>Spring MVC uses the <code>HttpMessageConverter</code> interface to convert HTTP requests and
responses. Sensible defaults are included out of the box, for example Objects can be
automatically converted to JSON (using the Jackson library) or XML (using JAXB).</p>
</div>
<div class="paragraph">
<p>If you need to add or customize converters you can use Spring Boot&#8217;s
<code>HttpMessageConverters</code> class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>import org.springframework.boot.autoconfigure.web.HttpMessageConverters;
import org.springframework.context.annotation.*;
import org.springframework.http.converter.*;

@Configuration
public class MyConfiguration {

    @Bean
    public HttpMessageConverters customConverters() {
        HttpMessageConverter&lt;?&gt; additional = ...
        HttpMessageConverter&lt;?&gt; another = ...
        return new HttpMessageConverters(additional, another);
    }

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_static_content">8.1.3. Static Content</h4>
<div class="paragraph">
<p>By default Spring Boot will serve static content from a folder called <code>/static</code> (or
<code>/public</code> or or <code>/resources</code> or <code>/META-INF/resources</code>) in the classpath or from the root
of the <code>ServeltContext</code>.  It uses the <code>ResourceHttpRequestHandler</code> from Spring MVC so you
can modify that behavior by adding your own <code>WebMvcConfigurerAdapter</code> and overriding the
<code>addResourceHandlers</code> method.</p>
</div>
<div class="paragraph">
<p>In a stand-alone web application the default servlet from the container is also
enabled, and acts as a fallback, serving content from the root of the <code>ServletContext</code> if
Spring decides not to handle it. Most of the time this will not happen unless you modify
the deafult MVC configuration because Spring will always be able to handle requests
through the <code>DispatcherServlet</code>.</p>
</div>
<div class="paragraph">
<p>In addition to the &#8220;standard&#8221; static resource locations above, a special case is made for
<a href="http://www.webjars.org/">Webjars content</a>. Any resources with a path in <code>/webjars/**</code> will
be served from jar files if they are packaged in the Webjars format.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
Do not use the <code>src/main/webapp</code> folder if your application will be packaged as a
JAR. Although this folder is a common standard, it will <strong>only</strong> work with WAR packaging
and it will be silently ignored by most build tools if you generate a JAR.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_template_engines">8.1.4. Template engines</h4>
<div class="paragraph">
<p>As well as REST web service, you can also use Spring MVC to service dynamic HTML content.
Spring MVC supports a variety of templating technologies including: velocity, freemarker,
and JSPs. Many other templating engines also ship their own Spring MVC integrations.</p>
</div>
<div class="paragraph">
<p>Spring Boot includes auto-configuration support for the Thymeleaf templating engine.
Thymeleaf is an XML/XHTML/HTML5 template engine that can work both in web and non-web
environments. If allows you to create natural templates, that can be correctly displayed
by browsers and therefore work also as static prototypes. Thymeleaf templates will be
picked up automatically from <code>src/main/resources/templates</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
JSPs should be avoided if possible, there are several known limitations when using
them with embdedded servlet containers.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_embedded_servlet_container_support">8.2. Embedded servlet container support</h3>
<div class="paragraph">
<p>Spring Boot includes support for embedded Tomcat and Jetty servers. Most developers will
simply use the appropriate &#8220;Starter POM&#8221; to obtain a fully configured instance. By
default both Tomcat and Jetty will listen for HTTP requests on port <code>8080</code>.</p>
</div>
<div class="sect3">
<h4 id="_servlets_and_filters">8.2.1. Servlets and Filters</h4>
<div class="paragraph">
<p>When using an embedded servlet container you can register Servlets and Filters directly as
Spring beans. This can be particularly convenient if you want to refer to a value from
your <code>application.properties</code> during configuration.</p>
</div>
<div class="paragraph">
<p>By default, if the context contains only a single Servlet it will be mapped to <code>/</code>. In
the case of multiple Servlets beans the bean name will be used as a path prefix. Filters
will map to <code>/*</code>.</p>
</div>
<div class="paragraph">
<p>If convention based mapping is not flexible enough you can use the
<code>ServletRegistrationBean</code> and <code>FilterRegistrationBean</code> classes for complete control. You
can also register items directly if your bean implements the <code>ServletContextInitializer</code>
interface.</p>
</div>
</div>
<div class="sect3">
<h4 id="_the_embeddedwebapplicationcontext">8.2.2. The EmbeddedWebApplicationContext</h4>
<div class="paragraph">
<p>Under the hood Spring Boot uses a new type of <code>ApplicationContext</code> for embedded
servlet container support.  The <code>EmbeddedWebApplicationContext</code> is a special
type of <code>WebApplicationContext</code> that bootstraps itself by searching for a single
<code>EmbeddedServletContainerFactory</code> bean. Usually a <code>TomcatEmbeddedServletContainerFactory</code>
or <code>JettyEmbeddedServletContainerFactory</code> will have been auto-configured.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
You usually won&#8217;t need to be aware of these implementation classes. Most
applications will be auto-configured and the appropriate <code>ApplicationContext</code> and
<code>EmbeddedServletContainerFactory</code> will be created on your behalf.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_customizing_embedded_servlet_containers">8.2.3. Customizing embedded servlet containers</h4>
<div class="paragraph">
<p>Common servlet container settings can be configured using Spring <code>Environment</code>
properties. Usually you would define the properties in your <code>application.properties</code>
file.</p>
</div>
<div class="paragraph">
<p>Common server settings include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>server.port</code>&#8201;&#8212;&#8201;The listen port for incoming HTTP requests.</p>
</li>
<li>
<p><code>server.address</code>&#8201;&#8212;&#8201;The interface address to bind to/</p>
</li>
<li>
<p><code>server.sessionTimeout</code>&#8201;&#8212;&#8201;A session timeout</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See the <code>ServerProperties</code> class for a complete list.</p>
</div>
<div class="sect4">
<h5 id="_programmatic_customization">Programmatic customization</h5>
<div class="paragraph">
<p>If you need to configure your embdedded servlet container programmatically you can register
a Spring bean that implements the <code>EmbeddedServletContainerCustomizer</code> interface.
<code>EmbeddedServletContainerCustomizer</code> provides access to the
<code>ConfigurableEmbeddedServletContainerFactory</code> which includes numerous customization
setter methods.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>import org.springframework.boot.context.embedded.*;
import org.springframework.stereotype.Component;

@Component
public class CustomizationBean implements EmbeddedServletContainerCustomizer {

    @Override
    public void customize(ConfigurableEmbeddedServletContainer container) {
        container.setPort(9000);
    }

}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_customizing_configurableembeddedservletcontainerfactory_directly">Customizing ConfigurableEmbeddedServletContainerFactory directly</h5>
<div class="paragraph">
<p>If the above customization techniques are too limited, you can register the
<code>TomcatEmbeddedServletContainerFactory</code> or <code>JettyEmbeddedServletContainerFactory</code> bean
yourself.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>@Bean
public EmbeddedServletContainerFactory servletContainer() {
    TomcatEmbeddedServletContainerFactory factory = new TomcatEmbeddedServletContainerFactory();
    factory.setPort(9000);
    factory.setSessionTimeout(10, TimeUnit.MINUTES);
    factory.addErrorPages(new ErrorPage(HttpStatus.404, "/notfound.html");
    return factory;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Setters are provided for many configuration options. Several protected method
&#8220;hooks&#8221; are also provided should you need to do something more exotic. See the
source code documentation for details.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_jsp_limitations">8.2.4. JSP limitations</h4>
<div class="paragraph">
<p>When running a Spring Boot application that uses an embedded servlet container (and is
packaged as an executable archive), there are some limitations in the JSP support.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>With Tomcat it should work if you use WAR packaging, i.e. an executable WAR will work,
and will also be deployable to a standard container (not limited to, but including
Tomcat). An executable JAR will not work because of a hard coded file pattern in Tomcat.</p>
</li>
<li>
<p>Jetty does not currently work as an embedded container with JSPs.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a JSP sample so you can see how to set things up.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_working_with_sql_databases">9. Working with SQL databases</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Spring Framework provides extensive support for working with SQL databases. From
direct JDBC access using <code>JdbcTemplate</code> though to complete &#8220;object relational mapping&#8221;
technologies such as Hibernate. Spring Data provides an additional level of functionality,
creating <code>Repoistory</code> implementations directly from interfaces and using conventions to
generate queries from your method names.</p>
</div>
<div class="sect2">
<h3 id="_configure_a_datasource">9.1. Configure a DataSource</h3>
<div class="paragraph">
<p>Java&#8217;s <code>javax.sql.DataSource</code> interface provides a standard method of working with
database connections. Traditionally a DataSource uses a <code>URL</code> along with some
credentials to establish a database connection.</p>
</div>
<div class="sect3">
<h4 id="_embedded_database_support">9.1.1. Embedded Database Support</h4>
<div class="paragraph">
<p>It&#8217;s often convenient develop applications using an in-memory embedded database.
Obviously, in-memory databases do not provide persistent storage; you will need to
populate your database when your application starts and be prepared to throw away
data when your application ends.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
The &#8220;How-to&#8221; section includes a used section on how to initialize a database
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Spring Boot can auto-configure embedded <code>H2</code>, <code>HSQL</code> and <code>Derby</code> databases. You don&#8217;t
need to provide any connection URLs, simply include a build dependency to the
embedded database that you want to use.</p>
</div>
<div class="paragraph">
<p>For example, typical POM dependencies would be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint xml language-xml"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.hsqldb&lt;/groupId&gt;
    &lt;artifactId&gt;hsqldb&lt;/artifactId&gt;
    &lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
You need a dependency on <code>spring-jdbc</code> for embedded database to be auto-configured.
In this example it&#8217;s pulled in transitively via <code>spring-boot-starter-data-jpa</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_connection_to_a_production_database">9.1.2. Connection to a production database</h4>
<div class="paragraph">
<p>Production database connections can also be auto-configured using a pooling
<code>DataSource</code>.  Here&#8217;s the algorithm for choosing a specific implementation.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>We prefer the Tomcat pooling <code>DataSource</code> for its performance and concurrency, so if
that is available we always choose it.</p>
</li>
<li>
<p>If commons-dbcp is available we will use that, but we don&#8217;t recommend it in production.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you use the <code>spring-boot-starter-jdbc</code> or <code>spring-boot-starter-data-jpa</code>
&#8220;starter POMs&#8221; you will automcatically get a dependency to <code>tomcat-jdbc</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
Additional connection pools can always be configured manually, if you define your
own <code>DataSource</code> bean that auto-configuration will not occur.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>DataSource configuration controlled by external configuration properties in
<code>spring.datasource.*</code> for example, you might declare the following section
in <code>application.properties</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>spring.datasource.url: jdbc:mysql://localhost/test
spring.datasource.username: dbuser
spring.datasource.password: dbpass
spring.datasource.driverClassName: com.mysql.jdbc.Driver</pre>
</div>
</div>
<div class="paragraph">
<p>See <code>AbstractDataSourceConfiguration</code> for more of the supported options.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
For a pooling <code>DataSource</code> to be created we need to be able to verify that a valid
<code>Driver</code> class is available, so we check for that before doing anything. I.e. if you set
<code>spring.datasource.driverClassName=com.mysql.jdbc.Driver</code> then that class has to be
loadable.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_jdbctemplate">9.2. Using JdbcTemplate</h3>
<div class="paragraph">
<p>Spring&#8217;s <code>JdbcTemplate</code> and <code>NamedParameterJdbcTemplate</code> classes are auto-configured and
you can <code>@Autowire</code> them directly into your own beans:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.stereotype.Component;

@Component
public class MyBean {

    private final JdbcTemplate jdbcTemplate;

    @Autowired
    public MyBean(JdbcTemplate jdbcTemplate) {
        this.jdbcTemplate = jdbcTemplate;
    }

    // ...

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_jpa_and_spring_data">9.3. JPA and &#8220;Spring Data&#8221;</h3>
<div class="paragraph">
<p>The Java Persistence API is a standard technology that allows you to &#8220;map&#8221; objects to
relational databases. The <code>spring-boot-starter-data-jpa</code> POM provides a quick way to get
started. It provides the following key dependencies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Hibernate&#8201;&#8212;&#8201;One of the most popular JPA implementations.</p>
</li>
<li>
<p>Spring Data JPA&#8201;&#8212;&#8201;Makes it easy to easily implement JPA based repositories.</p>
</li>
<li>
<p>Spring ORMs&#8201;&#8212;&#8201;Core ORM support from the Spring Framework.</p>
</li>
<li>
<p>Hibernate Validator&#8201;&#8212;&#8201;Annotation based validation for your entities.</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
We won&#8217;t go into too many details of JPA or Spring Data here. You can follow the
&#8220;Accessing Data with JPA&#8221; guide from <a href="http://spring.io">http://spring.io</a> and read the Spring Data JPA and
Hibernate reference documentation.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_entity_classes">9.3.1. Entity Classes</h4>
<div class="paragraph">
<p>Traditionally JPA &#8220;Entity&#8221; classes are specified in a <code>persistence.xml</code> file. With
Spring Boot this file is not necessary as it performs &#8220;Entity Scanning&#8221;. By default
all packages below your main configuration class (the one annotated with
<code>@EnableAutoConfiguration</code>) will be searched.</p>
</div>
<div class="paragraph">
<p>Any classes annotated with <code>@Entity</code>, <code>@Embeddable</code> or <code>@MappedSuperclass</code> will be
considered. A typical entity class would look something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>package com.example.myapp.domain;

import java.io.Serializable;
import javax.persistence.*;

@Entity
public class City implements Serializable {

	@Id
	@GeneratedValue
	private Long id;

	@Column(nullable = false)
	private String name;

	@Column(nullable = false)
	private String state;

	// ... additional members, often include @OneToMany mappings

	protected City() {
		// no-args constructor required by JPA spec
		// this one is protected since it shouldn't be used directly
	}

	public City(String name, String state) {
		this.name = name;
		this.country = country;
	}

	public String getName() {
		return this.name;
	}

	public String getState() {
		return this.state;
	}

	// ... etc

}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
You can customize entity scanning locations using the <code>@EntityScan</code> annotation.
See XXX.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_spring_data_jpa_repositories">9.3.2. Spring Data JPA Repositories</h4>
<div class="paragraph">
<p>Spring Data JPA repositories are interfaces that you can define to access data. JPA
queries are created automatically from your method names. For example, a <code>CityRepoistory</code>
interface might declare a <code>findAllByState(String state)</code> method to find all cities
in a given state.</p>
</div>
<div class="paragraph">
<p>For more complex queries you can annotate your method using the
<code>org.springframework.data.jpa.repository.Query</code> annotation.</p>
</div>
<div class="paragraph">
<p>Spring Data repositories usually extend from the
<code>org.springframework.data.repository.Repository</code> or
<code>org.springframework.data.repository.CrudRepository</code> interfaces. If you are using
auto-configuration, repositories will be searched from the package containing your
main configuration class (the one annotated with <code>@EnableAutoConfiguration</code>) down.</p>
</div>
<div class="paragraph">
<p>Here is a typical Spring Data repository:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>package com.example.myapp.domain;

import org.springframework.data.domain.*;
import org.springframework.data.repository.*;

public interface CityRepository extends Repository&lt;City, Long&gt; {

    Page&lt;City&gt; findAll(Pageable pageable);

    City findByNameAndCountryAllIgnoringCase(String name, String country);

}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
We have barely scratched the surface of Spring Data JPA. For complete details check
the reference documentation.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_validation">9.3.3. Validation</h4>
<div class="paragraph">
<p>The <code>spring-boot-starter-data-jpa</code> &#8220;Starter POM&#8221; includes a dependency on
Hibernate Validator. This means that you can use JSR-303 annotations such
as <code>@NotNull</code>, <code>@Min</code>, <code>@Size</code> etc. directly on your <code>@Entity</code> class fields.</p>
</div>
<div class="paragraph">
<p>For more information refer to the Hibernate Validator reference documentation.</p>
</div>
</div>
<div class="sect3">
<h4 id="_creating_and_dropping_jpa_databases">9.3.4. Creating and dropping JPA databases</h4>
<div class="paragraph">
<p>By default JPA database will be automatically created <strong>only</strong> if you use an embedded
database (H2, HSQL or Derby). You can explicitly configure JPA settings using
<code>spring.jpa.*</code> properties. For example, to create and drop tables you can add the
following to your <code>application.properties</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>spring.jpa.hibernate.ddl-auto: create-drop</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_working_with_nosql_technologies">10. Working with NoSQL technologies</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Data provides additional projects that help you access a variety of NoSQL
technologies including MongoDB, Neo4J, Redis, Gemfire, Couchbase and Cassandra.
Spring Boot provides auto-configuration for MongoDB; you can make use of the other
project, but you will need to configure them yourself. Refer to the appropriate
reference documentation at <a href="http://projects.spring.io/spring-data">http://projects.spring.io/spring-data</a>.</p>
</div>
<div class="sect2">
<h3 id="_mongodb">10.1. MongoDB</h3>
<div class="paragraph">
<p>MongoDB is an open-source NoSQL document database that uses a JSON-like schema instead
of traditional table-based relational data. Spring Boot offers several conveniences
for working with MongoDB, including the The <code>spring-boot-starter-data-mongodb</code>
&#8220;Starter POM&#8221;.</p>
</div>
<div class="sect3">
<h4 id="_connecting_to_a_mongodb_database">10.1.1. Connecting to a MongoDB database</h4>
<div class="paragraph">
<p>You can inject an auto-configured <code>com.mongodb.Mongo</code> instance as you would any other
Spring Bean. By default the instance will attempt to connect to a MongoDB server using
the URL <code>mongodb://localhost/test</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

import com.mongodb.Mongo;

@Component
public class MyBean {

	private final Mongo mongo;

	@Autowired
	public MyBean(Mongo mongo) {
		this.mongo = mongo;
	}

	// ...

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can set <code>spring.data.mongodb.url</code> property to change the <code>url</code>, or alternatively
specify a <code>host</code>/<code>port</code>. For example, you might declare the following in your
<code>application.properties</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>spring.data.mongodb.host = mongoserver
spring.data.mongodb.port = 27017</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
If <code>spring.data.mongodb.port</code> is not specified the default of <code>27017</code> is used. You
could simply delete this line from the sample above.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can also declare your own <code>Mongo</code> <code>@Bean</code> if you want to take complete control of
establishing the MongoDB connection.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mongotemplate">10.1.2. MongoTemplate</h4>
<div class="paragraph">
<p>Spring Data Mongo provides a <code>MongoTemplate</code> class that is very similar in its design to
Spring&#8217;s <code>JdbcTemplate</code>. As with <code>JdbcTemplate</code> Spring Boot auto-configures a bean
for you to simply inject:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.data.mongodb.core.MongoTemplate;
import org.springframework.stereotype.Component;

@Component
public class MyBean {

    private final MongoTemplate mongoTemplate;

    @Autowired
    public MyBean(MongoTemplate mongoTemplate) {
        this.mongoTemplate = mongoTemplate;
    }

    // ...

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the <code>MongoOperations</code> Javadoc for complete details.</p>
</div>
</div>
<div class="sect3">
<h4 id="_spring_data_mongodb_repositories">10.1.3. Spring Data MongoDB repositories</h4>
<div class="paragraph">
<p>Spring Data includes repository support for MongoDB. As with the JPA repositories
discussed earlier, the basic principal is that queries are constructed for you
automatically based on method names.</p>
</div>
<div class="paragraph">
<p>In fact, both Spring Data JPA and Spring Data MongoDB share the same common
infrastructure; so you could take the JPA example from earlier and, assuming that
<code>City</code> is now a Mongo data class rather than a JPA <code>@Entity</code>, it will work in the
same way.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>package com.example.myapp.domain;

import org.springframework.data.domain.*;
import org.springframework.data.repository.*;

public interface CityRepository extends Repository&lt;City, Long&gt; {

    Page&lt;City&gt; findAll(Pageable pageable);

    City findByNameAndCountryAllIgnoringCase(String name, String country);

}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
For complete details of Spring Data MongoDB, including its rich object mapping
technologies, refer to the documentation.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_testing">11. Testing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Boot provides a number of useful tools for testing your application. The
<code>spring-boot-starter-parent</code> POM provides JUnit, Hamcrest and Mockito &#8220;test&#8221; <code>scope</code>
dependencies. There are also useful test utilities in the core <code>spring-boot</code> modules
under the <code>org.springframework.boot.test</code> package. There is also a
<code>spring-boot-starter-test</code> &#8220;Starter POM&#8221;.</p>
</div>
<div class="sect2">
<h3 id="_test_scope_dependencies">11.1. Test scope dependencies</h3>
<div class="paragraph">
<p>If you extend your Maven project from the <code>spring-boot-starter-parent</code> POM, or use the
<code>spring-boot-starter-test</code> &#8220;Starter POM&#8221; (in the &#8220;test&#8221; <code>scope</code>), you will find
the following provided libraries:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Junit&#8201;&#8212;&#8201;The de-facto standard for unit testing Java applications.</p>
</li>
<li>
<p>Hamcrest&#8201;&#8212;&#8201;A library of matcher objects (also known as constraints or predicates)
allowing <code>assertThat</code> style JUnit assertions.</p>
</li>
<li>
<p>Mockito&#8201;&#8212;&#8201;A Java mocking framework.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These are common libraries that we generally find useful when writing Tests. You are free
to add or replace them if they don&#8217;t suit your needs.</p>
</div>
</div>
<div class="sect2">
<h3 id="_testing_spring_applications">11.2. Testing Spring applications</h3>
<div class="paragraph">
<p>One of the major advantages of dependency injection is that it should make your code
easier to unit test. You can simply instantiate objects using the <code>new</code> operator without
even involving Spring. You can also use <em>mock objects</em> instead of real dependencies.</p>
</div>
<div class="paragraph">
<p>Often you need to move beyond &#8220;unit testing&#8221; and start &#8220;integration testing&#8221; (with
a Spring <code>ApplicationContext</code> actually involved in the process). It&#8217;s useful to be able
to perform integration testing without requiring deployment of your application or
needing to connect to other enterprise infrastructure.</p>
</div>
<div class="paragraph">
<p>The Spring Framework includes a dedicated test module for just such integration testing.
You can declare a dependency directly to <code>org.springframework:spring-test</code> or use the
<code>spring-boot-starter-test</code> &#8220;Starter POM&#8221; to pull it in transitively.</p>
</div>
<div class="paragraph">
<p>If you have not use the <code>spring-test</code> module before you should start by reading the
relevant section of the Spring Framework reference documentation.</p>
</div>
</div>
<div class="sect2">
<h3 id="_testing_spring_boot_applications">11.3. Testing Spring Boot applications</h3>
<div class="paragraph">
<p>A Spring Boot application is just a Spring <code>ApplicationContext</code> so nothing very special
has to be done to test it beyond what you would normally do with a vanilla Spring context.
One thing to watch out for though is that the external properties, logging and other
features of Spring Boot are only installed in the context by default if you use
<code>SpringApplication</code> to create it.</p>
</div>
<div class="paragraph">
<p>Spring Boot provides a <code>@SpringApplicationConfiguration</code> annotation as an alternative
to the standard <code>spring-test</code> <code>@ContextConfiguration</code> annotation. If you use
<code>@SpringApplicationConfiguration</code> to configure the <code>ApplicationContext</code> used in your
tests, it will be created via <code>SpringApplication</code> and you will get the additional Spring
Boot features.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>@RunWith(SpringJUnit4ClassRunner.class)
@SpringApplicationConfiguration(classes = SampleDataJpaApplication.class)
public class CityRepositoryIntegrationTests {

    @Autowired
    CityRepository repository;

    // ...

}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
The context loader guesses whether you want to test a web application or not (e.g. with
<code>MockMVC</code>) by looking for the <code>@WebAppConfiguration</code> annotation.  (<code>MockMVC</code> and
<code>@WebAppConfiguration</code> are part of <code>spring-test</code>).
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_test_utilities">11.4. Test utilities</h3>
<div class="paragraph">
<p>A few test utility classes are packaged as part of <code>spring-boot</code> that are generally
useful when testing your application.</p>
</div>
<div class="sect3">
<h4 id="_configfileapplicationcontextinitializer">11.4.1. ConfigFileApplicationContextInitializer</h4>
<div class="paragraph">
<p><code>ConfigFileApplicationContextInitializer</code> is an <code>ApplicationContextInitializer</code> that
can apply to your tests to load Spring Boot <code>application.properties</code> files. You can use
when you don&#8217;t need the full features provided by <code>@SpringApplicationConfiguration</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>@ContextConfiguration(classes = Config.class,
    initializers = ConfigFileApplicationContextInitializer.class)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_environmenttestutils">11.4.2. EnvironmentTestUtils</h4>
<div class="paragraph">
<p><code>EnvironmentTestUtils</code> allows you to quickly add properties to a
<code>ConfigurableEnvironment</code> or <code>ConfigurableApplicationContext</code>. Simply call it with
<code>key=value</code> strings:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>EnvironmentTestUtils.addEnvironment(env, "org=Spring", "name=Boot");</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_outputcapture">11.4.3. OutputCapture</h4>
<div class="paragraph">
<p><code>OutputCapture</code> is a JUnit <code>Rule</code> that you can use to capture <code>System.out</code> and
<code>System.err</code> output. Simply declare the capture as a <code>@Rule</code> then use <code>toString()</code>
for assertions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>import org.junit.Rule;
import org.junit.Test;
import org.springframework.boot.test.OutputCapture;

import static org.hamcrest.Matchers.*;
import static org.junit.Assert.*;

public class MyTest {

	@Rule
	public OutputCapture capture = new OutputCapture();

	@Test
	public void testName() throws Exception {
		System.out.println("Hello World!");
		assertThat(capture.toString(), containsString("World"));
	}

}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_production_ready_features">12. Production-ready features</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Boot includes a number of additional features to help you monitor and manage your
application when it&#8217;s pushed to production. You can choose to manage and monitor your
application using HTTP endpoints, with JMX or even by remote shell (SSH or Telnet).
Auditing, health and metrics gathering can be automatically applied to your application.</p>
</div>
<div class="sect2">
<h3 id="_enabling_production_ready_features">12.1. Enabling production-ready features.</h3>
<div class="paragraph">
<p>The <code>spring-boot-actuator</code> project provides all of Spring Boot&#8217;s production-ready
features. The simplist way to enable the features is to add a dependency to the
<code>spring-boot-starter-actuator</code> &#8220;Starter POM&#8221;.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Definition of Actuator</div>
<div class="paragraph">
<p>An actuator is a manufacturing term, referring to a mechanical device for moving or
controlling something. Actuators can generate a large amount of motion from a small
change.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>To add the actuator to a Maven based project, add the following &#8220;starter&#8221;
dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint xml language-xml"><code>&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>For Gradle, use the declaration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint groovy language-groovy"><code>dependencies {
    compile("org.springframework.boot:spring-boot-starter-actuator")
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_endpoints">12.2. Endpoints</h3>
<div class="paragraph">
<p>Actuator endpoints allow you to monitor and interact with your application. Spring Boot
includes a number of built-in endpoints and you can also add your own. For example the
<code>health</code> endpoint provides basic application health information.</p>
</div>
<div class="paragraph">
<p>The way that enpoints are exposed will depend on the type of technology that choose.
Most applications choose HTTP monitoring, where the ID of the endpoint is mapped
to a URL. For example, by default, the <code>health</code> endpoint will be mapped to <code>/health</code>.</p>
</div>
<div class="paragraph">
<p>The following endpoints are available:</p>
</div>
<table class="tableblock frame-all grid-all" style="width:100%; ">
<colgroup>
<col style="width:11%;">
<col style="width:11%;">
<col style="width:77%;"> 
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">ID</th>
<th class="tableblock halign-left valign-top">Sensitive</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>autoconfig</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Displays an auto-configuration report showing all auto-configuration candidates and the
 reason why they &#8220;were&#8221; or &#8220;were not&#8221; applied.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>beans</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Displays a complete list of all the Spring Beans in your application.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>configprops</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Displays a collated list of all <code>@ConfigurationProperties</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dump</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Performs a thread dump</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>env</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exposes properties from Spring&#8217;s <code>ConfigurableEnvironment</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>health</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shows application health information (defaulting to a simple &#8220;OK&#8221; message).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>info</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Displays arbitrary application info.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>metrics</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shows &#8220;metrics&#8221; information for the current application.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mappings</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Displays a collated list of all <code>@RequestMapping</code> paths.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>shutdown</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows the application to be gracefully shutdown (not enabled by default)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>trace</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Displays trace information (by default the last few HTTP requests)</p></td>
</tr>
</tbody>
</table>

<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
Depending on how an endpoint is exposed, the <code>sensitive</code> parameter may be used as
a security hint. For example, sensitive endpoints will require a username/password when
they are accessed over HTTP (or simply disabled if web security is not enabled).
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_customizing_endpoints">12.2.1. Customizing endpoints</h4>
<div class="paragraph">
<p>Endpoints can be customized using Spring properties. You can change the if an endpoint is
<code>enabled</code>, if it is considered <code>sensitive</code> and even its <code>id</code>.</p>
</div>
<div class="paragraph">
<p>For example, here is an <code>application.properties</code> that changes the sensitivity and id
of the <code>beans</code> endpoint and also enables <code>shutdown</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>endpoints.beans.id=springbeans
endpoints.beans.sensitive=false
endpoints.shutdown.enabled=true</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
The prefix "<code>endpoints</code> + <code>.</code> + <code>name</code>" is used to uniquely identify the endpoint
that is being configured.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_custom_health_information">12.2.2. Custom health information</h4>
<div class="paragraph">
<p>The default information exposed by the <code>health</code> endpoint is a simple &#8220;OK&#8221; message. It
is often useful to perform some additional health checks, for example you might check
that a database connection works, or that a remote REST endpoint is functioning.</p>
</div>
<div class="paragraph">
<p>To provide custom health information you can register a Spring bean that implements the
<code>HealthIndicator</code> interface.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>import org.springframework.boot.actuate.health.HealthIndicator;
import org.springframework.stereotype.Component;

@Component
public class MyHealth implements HealthIndicator&lt;String&gt; {

    @Override
    public String health() {
        // perform some specific health check
        return ...
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Spring Boot also provides a <code>SimpleHealthIndicator</code> implementation that attempts a simple
database test.</p>
</div>
</div>
<div class="sect3">
<h4 id="_custom_application_info_information">12.2.3. Custom application info information</h4>
<div class="paragraph">
<p>You can customize the data exposed by the <code>info</code> endpoint by settings <code>info.*</code> Spring
properties. All <code>Environment</code> properties under the info key will be automatically
exposed. For example, you could add the following to your <code>application.properties</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>info.app.name: MyService
info.app.description: My awesome service
info.app.version: 1.0.0</pre>
</div>
</div>
<div class="paragraph">
<p>If you are using Maven, you can automatically populate info properties from the project
using resource filtering. In your <code>pom.xml</code> you have (inside the <code>&lt;build/&gt;</code> element):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint xml language-xml"><code>&lt;resources&gt;
    &lt;resource&gt;
        &lt;directory&gt;src/main/resources&lt;/directory&gt;
        &lt;filtering&gt;true&lt;/filtering&gt;
    &lt;/resource&gt;
&lt;/resources&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can then refer to your Maven &#8220;project properties&#8221; via placeholders, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>project.artifactId: myproject
project.name: Demo
project.version: X.X.X.X
project.description: Demo project for info endpoint
info.build.artifact: ${project.artifactId}
info.build.name: ${project.name}
info.build.description: ${project.description}
info.build.version: ${project.version}</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
In the above example we used <code>project.*</code> to set some values to be used as
fallbacks if the Maven resource filtering has for some reason not been switched on.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_git_commit_information">Git commit information</h5>
<div class="paragraph">
<p>Another useful feature of the <code>info</code> endpoint is its ability to publish information
about the state of your <code>git</code> source code repository when the project was built. If a
<code>git.properties</code> file is contained in your JAR the <code>git.branch</code> and <code>git.commit</code>
properties will be loaded.</p>
</div>
<div class="paragraph">
<p>For Maven users the <code>spring-boot-starter-parent</code> POM includes a pre-configured plugin to
generate a <code>git.properties</code> file. Simply add the following declaration to your POM:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint xml language-xml"><code>&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;pl.project13.maven&lt;/groupId&gt;
            &lt;artifactId&gt;git-commit-id-plugin&lt;/artifactId&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>A similar <a href="https://github.com/ajoberstar/gradle-git"><code>gradle-git</code></a> plugin is also available
for Gradle users, although a little more work is required to generate the properties file.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_monitoring_and_management_over_http">12.3. Monitoring and management over HTTP</h3>
<div class="paragraph">
<p>If you are developing a Spring MVC application, Spring Boot Actuator will auto-configure
all non-sensitive endpoints to be exposed over HTTP. The default convention it to use the
<code>id</code> of the endpoint as the URL path. For example, <code>health</code> is exposed as <code>/health</code>.</p>
</div>
<div class="sect3">
<h4 id="_exposing_sensitive_endpoints">12.3.1. Exposing sensitive endpoints</h4>
<div class="paragraph">
<p>If you use &#8220;Spring Security&#8221; sensitive endpoints will also be exposed over HTTP. By
default &#8220;basic&#8221; authentication will be used with the username <code>user</code> and a generated
password.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
Generated passwords a logged as the application starts. Search for &#8220;Using default
password for application endpoints&#8221;.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can use Spring properties to change the username and passsword and to change the
security role required to access the endpoints. For example, you might set the following
in your <code>application.properties</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>security.user.name=admin
security.user.password=secret
management.security.role=SUPERUSER</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_customizing_the_management_server_context_path">12.3.2. Customizing the management server context path</h4>
<div class="paragraph">
<p>Sometimes it is useful to group all management endpoints under a single path. For example,
your application might already use <code>/info</code> for another purpose. You can use the
<code>management.contextPath</code> property to set a prefix for your manangement endpoint:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>management.contextpath=/manage</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>application.properties</code> example above will change the endpoint from <code>/{id}</code> to
<code>/manage/{id}</code> (e.g. <code>/manage/info</code>).</p>
</div>
</div>
<div class="sect3">
<h4 id="_customizing_the_management_server_port">12.3.3. Customizing the management server port</h4>
<div class="paragraph">
<p>Exposing management endpoints using the default HTTP port is a sensible choice for cloud
based deployments. If, however, your application runs inside your own data center you
may prefer to expose endpoints using a different HTTP port.</p>
</div>
<div class="paragraph">
<p>The <code>management.port</code> property can be used to change the HTTP port. Since your management
port is often protected by a firewall, and not exposed to the public, you might also
want to disable management security:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>management.port=8081
management.security.enabled=false</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_customizing_the_management_server_address">12.3.4. Customizing the management server address</h4>
<div class="paragraph">
<p>You can customize the address that the management endpoints are available on by
setting the <code>management.security.address</code> property. This can be useful if you want to
listen only on an internal or ops-facing network, or to only listen for connections from
<code>localhost</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
You can only listen on a different address if the port is different to the
main server port.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Here is an example <code>application.properties</code> that will not allow remote management
connections:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>management.port=8081
management.address=127.0.0.1</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_disabling_http_endpoints">12.3.5. Disabling HTTP endpoints</h4>
<div class="paragraph">
<p>If you don&#8217;t want to expose endpoints over HTTP you can set the management port to <code>-1</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>management.port=-1</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_monitoring_and_management_over_jmx">12.4. Monitoring and management over JMX</h3>
<div class="paragraph">
<p>Java Management Extensions (JMX) provide a standard mechanism to monitor and manage
applications. By default Spring Boot will expose management endpoints as JMX MBeans
under the <code>org.springframework.boot</code> domain.</p>
</div>
<div class="sect3">
<h4 id="_customizing_mbean_names">12.4.1. Customizing MBean names</h4>
<div class="paragraph">
<p>By default, the name of the MBean is generated from the <code>id</code> of the endpoint. For example
the <code>health</code> endpoint is exposed as <code>org.springframework.boot/Endpoint/HealthEndpoint</code>.</p>
</div>
<div class="paragraph">
<p>If your application contains more than one Spring <code>ApplicationContext</code> you may find that
names clash. To solve this problem you can set the <code>endpoints.jmx.uniqueNames</code> property
so that MBean names are always unique.</p>
</div>
<div class="paragraph">
<p>You can also customize the JMX domain under which endpoints are exposed. Here is an
example <code>application.properties</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>endpoints.jmx.domain=myapp
endpoints.jmx.uniqueNames=true</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_disabling_jmx_endpoints">12.4.2. Disabling JMX endpoints</h4>
<div class="paragraph">
<p>If you don&#8217;t want to expose endpoints over JMX you can set the <code>spring.jmx.enabled</code>
property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>spring.jmx.enabled=false</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_using_jolokia_for_jmx_over_http">12.4.3. Using Jolokia for JMX over HTTP</h4>
<div class="paragraph">
<p>Jolokia is a JMX-HTTP bridge giving an alternative method of accessing JMX beans. To
use Jolokia, simply include a dependency to <code>org.jolokia:jolokia-core</code>. For example,
using Maven you you add the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint xml language-xml"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.jolokia&lt;/groupId&gt;
    &lt;artifactId&gt;jolokia-core&lt;/artifactId&gt;
 &lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Jolokia can then be accessed using <code>/jolokia</code> on your management HTTP server.</p>
</div>
<div class="sect4">
<h5 id="_customizing_jolokia">Customizing Jolokia</h5>
<div class="paragraph">
<p>Jolokia has a number of settings that you would traditionally configure using servlet
parameters parameters. With Spring Boot you can use your <code>application.properties</code>, simply
prefix the paramter with <code>jolokia.config.</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>jolokia.config.debug=true</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_disabling_jolokia">Disabling Jolokia</h5>
<div class="paragraph">
<p>If you are using Jolokia but you don&#8217;t want Spring Boot to configure it, simply set the
<code>endpoints.jolokia.enabled</code> property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>jolokia.config.enabled=false</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_monitoring_and_management_using_a_remote_shell">12.5. Monitoring and management using a remote shell</h3>
<div class="paragraph">
<p>Spring Boot supports an integrated Java shell called &#8220;CRaSH&#8221;. You can use CRaSH to
<code>ssh</code> or <code>telnet</code> into your running application. To enable remote shell support add a
dependency to <code>spring-boot-starter-shell-remote</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint xml language-xml"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-shell-remote&lt;/artifactId&gt;
 &lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
If you want to also enable telnet access your will additionally need a dependency
on <code>org.crsh:crsh.shell.telnet</code>.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_connecting_to_the_remote_shell">12.5.1. Connecting to the remote shell</h4>
<div class="paragraph">
<p>By default the remote shell will listen for connections on port <code>2000</code>. The default user
is <code>user</code> and the default password will be randomly generated and displayed in the log
output, you should see a message like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Using default password for shell access: ec03e16c-4cf4-49ee-b745-7c8255c1dd7e</pre>
</div>
</div>
<div class="paragraph">
<p>Linux and OSX users can use <code>ssh</code> to connect to the remote shell, Windows users can
download and install PuTTY.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ssh -p 2000 user@localhost

user@localhost's password:
  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::  (v1.0.0.BUILD-SNAPSHOT) on myhost</pre>
</div>
</div>
<div class="paragraph">
<p>Type <code>help</code> for a list of commands. Spring boot provides <code>metrics</code>, <code>beans</code> and
<code>autoconfig</code> commands. You can also use the <code>jmx</code> command to query endpoint data:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>jmx find -p org.springframework.boot:type=Endpoint,name=healthEndpoint | jmx get Data</pre>
</div>
</div>
<div class="sect4">
<h5 id="_remote_shell_credentials">Remote shell credentials</h5>
<div class="paragraph">
<p>You can use the <code>shell.auth.simple.username</code> and <code>shell.auth.simple.password</code> properties
to configure custom connection credentials. It is also possible to use a
&#8220;Spring Security&#8221; <code>AuthenticationManager</code> to handle login duties. See the
<code>CrshAutoConfiguration</code> and <code>ShellProperties</code> Javadoc for full details.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_extending_the_remote_shell">12.5.2. Extending the remote shell</h4>
<div class="paragraph">
<p>The remote shell can be extended in a number of interesting ways.</p>
</div>
<div class="sect4">
<h5 id="_commands">Commands</h5>
<div class="paragraph">
<p>You can write additional shell commands using Groovy or Java (see the CRaSH documentation
for details). By default Spring Boot will search for commands in the following locations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>classpath*:/commands/**</code></p>
</li>
<li>
<p><code>classpath*:/crash/commands/**</code></p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
You can change the search path by settings a <code>shell.commandpathpatterns</code> property.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Here is a simple hello world command that could be loaded from
<code>src/main/resources/commands/Hello.groovy</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint groovy language-groovy"><code>package commands

import org.springframework.boot.actuate.endpoint.BeansEndpoint

class hello {

    @Usage("Say Hello")
    @Command
    def main(InvocationContext context) {
        return "Hello"
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Spring Boot adds some additional attributes to <code>InvocationContext</code> that you can access
from your command:</p>
</div>
<table class="tableblock frame-all grid-all" style="width:100%; ">
<colgroup>
<col style="width:25%;">
<col style="width:75%;"> 
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>spring.boot.version</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The version of Spring Boot</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>spring.version</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The version of the core Spring Framework</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>spring.beanFactory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Access to the Spring <code>BeanFactory</code></p></td>
</tr>
</tbody>
</table>

</div>
<div class="sect4">
<h5 id="_plugins">Plugins</h5>
<div class="paragraph">
<p>In addition to new commands, it is also possible to extend other CRaSH shell features.
All Spring Beans that extends <code>org.crsh.plugin.CRaSHPlugin</code> will be automatically
registered with the shell.</p>
</div>
<div class="paragraph">
<p>For more information please refer to the CRaSH reference documentation.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_metrics">12.6. Metrics</h3>
<div class="paragraph">
<p>Spring Boot Actuator includes a metric service with &#8220;gauge&#8221; and &#8220;counter&#8221; support.
A &#8220;gauge&#8221; records a single value; and a &#8220;counter&#8221; records a delta (an increment or
decrement). Metrics for all HTTP requests are automatically recorded, so if you hit the
<code>metrics</code> endpoint should should see a response similar to this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint json language-json"><code>{
    "counter.status.200.root": 20,
    "counter.status.200.metrics": 3,
    "counter.status.401.root": 4,
    "gauge.response.root": 2,
    "gauge.response.metrics": 3,
    "mem": 466944,
    "mem.free": 410117,
    "processors": 8
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here we can see basic <code>memory</code> and <code>processor</code> information along with some HTTP metrics.
In this instance the <code>root</code> (&#8220;/&#8221;) and <code>/metrics</code> URLs have returned <code>HTTP 200</code> responses
<code>20</code> and <code>3</code> times respectively. It also appears that the <code>root</code> URL returned <code>HTTP 401</code>
(unauthorized) <code>4</code> times.</p>
</div>
<div class="paragraph">
<p>The <code>gauge</code> shows the last response time for a request. So the last request to <code>root</code> took
<code>2ms</code> to respond and the last to <code>/metrics</code> took <code>3ms</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
In this example we are actually accessing the endpoint over HTTP using the
<code>/metrics</code> URL, this explains why <code>metrics</code> appears in the response.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_recording_your_own_metrics">12.6.1. Recording your own metrics</h4>
<div class="paragraph">
<p>To record your own metrics inject a
<code>org.springframework.boot.actuate.metrics.CounterService</code> and/or
<code>org.springframework.boot.actuate.metrics.GaugeService</code> into
your bean. The <code>CounterService</code> exposes <code>increment</code>, <code>decrement</code> and <code>reset</code> methods; the
<code>GaugeService</code> provides a <code>submit</code> method.</p>
</div>
<div class="paragraph">
<p>Here is a simple example that counts the number of times that a method is invoked:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.actuate.metrics.CounterService;
import org.springframework.stereotype.Service;

@Service
public class MyService {

    private final CounterService counterService;

    @Autowired
    public MyService(CounterService counterService) {
        this.counterService = counterService;
    }

    public void exampleMethod() {
        this.counterService.increment("services.system.myservice.invoked");
    }

}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
You can use any string as a metric name but you following guidelines of your chosen
store/graphing technology. Some good guidelines for Graphite are available on
<a href="http://matt.aimonetti.net/posts/2013/06/26/practical-guide-to-graphite-monitoring/">Matt Aimonetti&#8217;s Blog</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_metric_repositories">12.6.2. Metric repositories</h4>
<div class="paragraph">
<p>Metric service implementations are usually bound to a <code>MetricRepoistory</code>. A
<code>MetricRepoistory</code> is responsible for storing and retrieving metric information. Spring
Boot provides an <code>InMemoryMessageRespository</code> and a <code>RedisMetricRepository</code> out of the
box (the in-memory repository is the default) but you can also write your own. The
<code>MetricRepository</code> interface is actually composed of higher level <code>MetricReader</code> and
<code>MetricWriter</code> interfaced. For full details refer to the Javadoc.</p>
</div>
</div>
<div class="sect3">
<h4 id="_coda_hale_metrics">12.6.3. Coda Hale Metrics</h4>
<div class="paragraph">
<p>User of the Coda Hale &#8220;Metrics&#8221; library will automatically find the Spring Boot metrics
are published to <code>com.codahale.metrics.MetricRegistry</code>. A default
<code>com.codahale.metrics.MetricRegistry</code> Spring bean will be created when you declare a
dependency to the <code>com.codahale.metrics:metrics-core</code> library; you can also register you
own <code>@Bean</code> instance if you need customizations.</p>
</div>
<div class="paragraph">
<p>Users can create Codahale metrics by prefixing their metric names with the appropriate
type (e.g. <code>histogram.*</code>, <code>meter.*</code>).</p>
</div>
</div>
<div class="sect3">
<h4 id="_message_channel_integration">12.6.4. Message channel integration</h4>
<div class="paragraph">
<p>If the &#8220;Spring Messaging&#8221; JAR is on your classpath a <code>MessageChannel</code> called
<code>metricsChannel</code> is automatically created (unless one already exists). All metric update
events are additionally published as &#8220;messages&#8221; on that channel. Additional analysis or
actions can be taken by clients subscribing to that channel.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_auditing">12.7. Auditing</h3>
<div class="paragraph">
<p>Spring Boot Actuator has a flexible audit framework that will publish events once Spring
Security is in play (authentication success and failure and access denied exceptions by
default). This can be very useful for reporting, and also to implement a lock-out policy
based on authentication failures.</p>
</div>
<div class="paragraph">
<p>You can also choose to use the audit services for your own business events. To do that
you can either inject the existing <code>AuditEventRepository</code> into your own components and
use that directly, or you can simply publish <code>AuditApplicationEvent</code> via the Spring
<code>ApplicationContext</code> (using <code>ApplicationEventPublisherAware</code>).</p>
</div>
</div>
<div class="sect2">
<h3 id="_tracing">12.8. Tracing</h3>
<div class="paragraph">
<p>Tracing is automatically enable for all HTTP requests. You can view the <code>trace</code> endpoint
and obtain basic information about the last few requests:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint json language-json"><code>[{
    "timestamp": 1394343677415,
    "info": {
        "method": "GET",
        "path": "/trace",
        "headers": {
            "request": {
                "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",
                "Connection": "keep-alive",
                "Accept-Encoding": "gzip, deflate",
                "User-Agent": "Mozilla/5.0 Gecko/Firefox",
                "Accept-Language": "en-US,en;q=0.5",
                "Cookie": "_ga=GA1.1.827067509.1390890128; ..."
                "Authorization": "Basic ...",
                "Host": "localhost:8080"
            },
            "response": {
                "Strict-Transport-Security": "max-age=31536000 ; includeSubDomains",
                "X-Application-Context": "application:8080",
                "Content-Type": "application/json;charset=UTF-8",
                "status": "200"
            }
        }
    }
},{
    "timestamp": 1394343684465,
    ...
}]</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_custom_tracing">12.8.1. Custom tracing</h4>
<div class="paragraph">
<p>If you need to trace additional events you can inject a
<code>org.springframework.boot.actuate.trace.TraceRepository</code> into your Spring Beans.
The <code>add</code> method accepts a single <code>Map</code> structure that will be converted to JSON and
logged.</p>
</div>
<div class="paragraph">
<p>By default an <code>InMemoryTraceRepository</code> will be used that stores the last 100 events. You
can define your own instance of the <code>InMemoryTraceRepository</code> bean if you need to expand
the capacity. You can also create your own alternative <code>TraceRepository</code> implementation
if needed.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_error_handling">12.9. Error Handling</h3>
<div class="paragraph">
<p>Spring Boot Actuator provides an <code>/error</code> mapping by default that handles all errors in a
sensible way.  If you want more specific error pages for some conditions, the embedded
servlet containers support a uniform Java DSL for customizing the error handling.</p>
</div>
<div class="paragraph">
<p>To do this you have to have picked a container implementation (by including either Tomcat
or Jetty on the classpath), but then the API is the same.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_spring_boot_gradle_plugin">13. Spring Boot Gradle plugin</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_spring_boot_maven_plugin">14. Spring Boot Maven plugin</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_deploying_to_the_cloud">15. Deploying to the cloud</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Boot&#8217;s executable JARs are ready-made for most popular cloud PaaS
(platform-as-a-service) providers. These providers tend to require that you
<em>`bring your own container'</em>; they manage application processes (not Java applications
specifically), so they need some intermediary layer that adapts <em>your</em> application to the
<em>cloud&#8217;s</em> notion of a running process.</p>
</div>
<div class="paragraph">
<p>Two popular cloud providers, Heroku and Cloud Foundry, employ a &#8220;buildpack&#8221; approach.
The buildpack wraps your deployed code in whatever is needed to <em>start</em> your
application: it might be a JDK and a call to <code>java</code>, it might be an embedded webserver,
or it might be a full fledged application server. A buildpack is pluggable, but ideally
you should be able to get by with as few customizations to it as possible.
This reduces the footprint of functionality that is not under your control. It minimizes
divergence between deployment and production environments.</p>
</div>
<div class="paragraph">
<p>Ideally, your application, like a Spring Boot executable JAR, has everything that it needs
to run packaged within it.</p>
</div>
<div class="paragraph">
<p>In this section we&#8217;ll look at what it takes to get the simple Boot application that we
developed in the Getting Started section up and running on Cloud Foundry and Heroku.</p>
</div>
<div class="sect2">
<h3 id="_cloud_foundry">15.1. Cloud Foundry</h3>
<div class="paragraph">
<p>Cloud Foundry provides default buildpacks that come into play if no other buildpack is
specified. The Cloud Foundry buildpack has excellent support for Spring applications,
including Spring Boot.  You can deploy stand-alone executable JAR applications as well as
traditional <code>WAR</code> packaged applications.</p>
</div>
<div class="paragraph">
<p>Once you&#8217;ve built your application (using, for example, <code>mvn clean install</code>) and
<a href="http://docs.cloudfoundry.org/devguide/installcf/">installed the <code>cf</code> command line tool</a>,
simply answer the <code>cf push</code> command&#8217;s prompts as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cf push --path target/demo-0.0.1-SNAPSHOT.jar

Name&gt; <strong><em>$YOURAPP</em></strong>
Instances&gt; <strong>1</strong>
Memory Limit&gt; <strong>256M</strong>

Creating <em>$YOURAPP</em>... <strong>OK</strong>

1: <em>$YOURAPP</em>
2: none
Subdomain&gt; <strong><em>$YOURAPP</em></strong>

1: cfapps.io
2: none
Domain&gt; <strong>cfapps.io</strong>

Creating route <em>$YOURAPP</em>.cfapps.io... OK
Binding <em>$YOURAPP</em>.cfapps.io to <em>$YOURAPP</em>... OK

Create services for application?&gt; <strong>n</strong>
Bind other services to application?&gt; <strong>n</strong>
Save configuration?&gt; <strong>y</strong></pre>
</div>
</div>
<div class="paragraph">
<p>At this point <code>cf</code> will start uploading your application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Saving to manifest.yml... <strong>OK</strong>
Uploading $YOURAPP... <strong>OK</strong>
Preparing to start <em>$YOURAPP</em>... <strong>OK</strong>
-----&gt; Downloaded app package (8.7M)
-----&gt; Java Buildpack source: system
-----&gt; Downloading Open JDK 1.7.0_51 from .../openjdk-1.7.0_51.tar.gz (<strong>1.4s</strong>)
       Expanding Open JDK to .java-buildpack/open_jdk (<strong>1.3s</strong>)
-----&gt; Downloading Spring Auto Reconfiguration 0.8.7 from .../auto-reconfiguration-0.8.7.jar (<strong>0.0s</strong>)
-----&gt; Uploading droplet (<strong>43M</strong>)
Checking status of app <em><em>$YOURAPP</em></em>...
 0 of 1 instances running (1 starting)
 0 of 1 instances running (1 starting)
 1 of 1 instances running (1 running)
Push successful! App <em><em>$YOURAPP</em></em> available at http://<em>$YOURAPP</em>.cfapps.io</pre>
</div>
</div>
<div class="paragraph">
<p>Here I&#8217;m substituting <code>$YOURAPP</code> for whatever value you give <code>cf</code> when it asks for the
<code>name</code> of your application.</p>
</div>
<div class="paragraph">
<p>Once Cloud Foundry acknowledges that your application has been deployed, you should be
able to hit the application at the URI provided:
<code>http://$YOURAPP.cfapps.io/</code>.</p>
</div>
<div class="sect3">
<h4 id="_binding_to_services">15.1.1. Binding to services</h4>
<div class="paragraph">
<p>By default, meta-data about the running application as well as service connection
information is exposed to the application as environment variables (for example:
<code>$VCAP_SERVICES</code>). This architecture decision is due to Cloud Foundry&#8217;s polyglot
(any language and platform that can be supported as a buildpack) nature; process-scoped
environment variables are language agnostic.</p>
</div>
<div class="paragraph">
<p>Environment variables don&#8217;t always make for the easiest API so Spring Boot automatically
extracts then and flattens the data into properties that can be accessed through
Spring&#8217;s <code>Environment</code> abstraction:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>@Component
class MyBean implements EnvironmentAware {

    private String instanceId;

    @Override
    public void setEnvironment(Environment environment) {
        this.instanceId = environment.getProperty("vcap.application.instance_id");
    }

    // ...

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>All Cloud Foundry properties are prefixed with <code>vcap</code>. You can use vcap properties to
access application information (such as the public URL of the application) and service
information (such as database credentials). See <code>VcapApplicationListener</code> Javdoc for
complete details.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
The <a href="http://spring.io/projects/spring-cloud">Spring Cloud</a> project is a better fit
for tasks such as configuring a DataSource; and you can also use Spring Cloud with
Heroku too!
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_heroku">15.2. Heroku</h3>
<div class="paragraph">
<p>Heroku is another popular PaaS platform. To customize Heroku builds, you provide a
<code>Procfile</code>, which provides the incantation required to deploy an application. Heroku
assigns a <code>port</code> for the Java application to use and then ensures that routing to the
external URI works.</p>
</div>
<div class="paragraph">
<p>You must configure your application listen to the correct port. This is a breeze with
Spring Boot. Here&#8217;s the <code>Procfile</code> for our starter REST application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>web: java -Dserver.port=$PORT -jar target/demo-0.0.1-SNAPSHOT.jar</pre>
</div>
</div>
<div class="paragraph">
<p>Spring Boot makes <code>-D</code> arguments available as properties accessible from a Spring
<code>Environment</code> instance. The <code>server.port</code> configuration property is fed to the embedded
Tomcat or Jetty instance which then uses it when it starts up. The <code>$PORT</code> environment
variable is assigned to us by the Heroku PaaS.</p>
</div>
<div class="paragraph">
<p>Heroku by default will use Java 1.6. This is fine as long as your Maven or Gradle build
is set to use the same version (Maven users can use the <code>java.version</code> property). If you
want to use JDK 1.7, create a new file adjacent to your <code>pom.xml</code> and <code>Procfile</code>,
called <code>system.properties</code>. In this file add the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>java.runtime.version=1.7</code></pre>
</div>
</div>
<div class="paragraph">
<p>This should be everything you need. The most common workflow for Heroku deployments is to
<code>git push</code> the code to production.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ git push heroku master

Initializing repository, <strong>done</strong>.
Counting objects: 95, <strong>done</strong>.
Delta compression using up to 8 threads.
Compressing objects: 100% (78/78), <strong>done</strong>.
Writing objects: 100% (95/95), 8.66 MiB | 606.00 KiB/s, <strong>done</strong>.
Total 95 (delta 31), reused 0 (delta 0)

-----&gt; Java app detected
-----&gt; Installing OpenJDK 1.7... <strong>done</strong>
-----&gt; Installing Maven 3.0.3... <strong>done</strong>
-----&gt; Installing settings.xml... <strong>done</strong>
-----&gt; executing /app/tmp/cache/.maven/bin/mvn -B
       -Duser.home=/tmp/build_0c35a5d2-a067-4abc-a232-14b1fb7a8229
       -Dmaven.repo.local=/app/tmp/cache/.m2/repository
       -s /app/tmp/cache/.m2/settings.xml -DskipTests=true clean install

       [INFO] Scanning for projects...
       Downloading: http://repo.spring.io/...
       Downloaded: http://repo.spring.io/... (818 B at 1.8 KB/sec)
        ....
       Downloaded: http://s3pository.heroku.com/jvm/... (152 KB at 595.3 KB/sec)
       [INFO] Installing /tmp/build_0c35a5d2-a067-4abc-a232-14b1fb7a8229/target/...
       [INFO] Installing /tmp/build_0c35a5d2-a067-4abc-a232-14b1fb7a8229/pom.xml ...
       [INFO] ------------------------------------------------------------------------
       [INFO] <strong>BUILD SUCCESS</strong>
       [INFO] ------------------------------------------------------------------------
       [INFO] Total time: 59.358s
       [INFO] Finished at: Fri Mar 07 07:28:25 UTC 2014
       [INFO] Final Memory: 20M/493M
       [INFO] ------------------------------------------------------------------------

-----&gt; Discovering process types
       Procfile declares types -&gt; <strong>web</strong>

-----&gt; Compressing... <strong>done</strong>, 70.4MB
-----&gt; Launching... <strong>done</strong>, v6
       http://agile-sierra-1405.herokuapp.com/ <strong>deployed to Heroku</strong>

To git@heroku.com:agile-sierra-1405.git
 * [new branch]      master -&gt; master</pre>
</div>
</div>
<div class="paragraph">
<p>That should be it! Your application should be up and running on Heroku.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_extending_spring_boot">16. Extending Spring Boot</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_conditions">16.1. Conditions</h3>

</div>
</div>
</div>
<div class="sect1">
<h2 id="_spring_boot_cli">17. Spring Boot CLI</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_common_application_properties">18. Common application properties</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre># EndpointMBeanExportProperties
endpoints.jmx.domain
endpoints.jmx.uniqueNames=false
endpoints.jmx.enabled=true
endpoints.jmx.staticNames=

# JolokiaProperties
jolokia.config.*=

# ManagementServerProperties
management.port
management.address
management.contextPath

# ShellProperties
shell.auth=simple # jaas, key, simple, spring
shell.defaultAuth
shell.commandRefreshInterval=-1
shell.commandPathPattern=classpath*:/commands/**", "classpath*:/crash/commands/**"
shell.configPathPatterns=classpath*:/crash/*
shell.disabledPlugins=
shell.ssh.enabled
shell.ssh.keyPath
shell.ssh.port
shell.telnet.enabled
shell.telnet.port
shell.auth.jaas.domain
shell.auth.key.path
shell.auth.simple.user.name
shell.auth.simple.user.password
shell.auth.spring.roles

#Endpoints
endpoints.autoconfig.id
endpoints.autoconfig.sensitive
endpoints.autoconfig.enabled

endpoints.beans.id
endpoints.beans.sensitive
endpoints.beans.enabled

endpoints.configprops.id
endpoints.configprops.sensitive
endpoints.configprops.enabled
endpoints.configprops.keysToSanitize

endpoints.dump.id
endpoints.dump.sensitive
endpoints.dump.enabled

endpoints.env.id
endpoints.env.sensitive
endpoints.env.enabled

endpoints.health.id
endpoints.health.sensitive
endpoints.health.enabled

endpoints.info.id
endpoints.info.sensitive
endpoints.info.enabled

endpoints.metrics.id
endpoints.metrics.sensitive
endpoints.metrics.enabled

endpoints.shutdown.id
endpoints.shutdown.sensitive
endpoints.shutdown.enabled

endpoints.trace.id
endpoints.trace.sensitive
endpoints.trace.enabled

# MVC Ends
endpoints.jolokia.path
endpoints.jolokia.sensitive
endpoints.jolokia.enabled
endpoints.error.path

# JMX
spring.jmx.enabled
endpoints.jmx.enabled

# RabbitProperties
spring.rabbitmq
host
port
username
password
virtualhost
dynamic
spring.rabbitmq.dynamic

# DataSourceAutoConfiguration &amp; AbstractDataSourceConfiguration
spring.datasource.name
spring.datasource.intialize=true
spring.datasource.schema=
spring.datasource.continueOnError
spring.datasource.driverClassName;
spring.datasource.url;
spring.datasource.username;
spring.datasource.password;
spring.datasource.maxActive = 100;
spring.datasource.maxIdle = 8;
spring.datasource.minIdle = 8;
spring.datasource.initialSize = 10;
spring.datasource.validationQuery;
spring.datasource.testOnBorrow = false;
spring.datasource.testOnReturn = false;

#ActiveMQProperties
spring.activemq.brokerURL=tcp://localhost:61616
inMemory=true
pooled=false

# JmsTemplateProperties
spring.jms.pubSubDomain

# MongoProperties
spring.data.mongodb.host=
spring.data.mongodb.port=27017
spring.data.mongodb.uri=mongodb://localhost/test

# RedisProperties
spring.redis.host=localhost
spring.redis.password=
spring.redis.port=6379
spring.redis.pool.maxIdle = 8;
spring.redis.pool.minIdle = 0;
spring.redis.pool.maxActive = 8;
spring.redis.pool.maxWait = -1;

SecurityProperties
security.requireSsl=false
security.enableCsrf=false
security.basic.enabled = true
security.basic.realm =Spring
security.basic.path =/**
security.headers.xss=false
security.headers.cache=false
security.headers.frame=false
security.headers.contentType=false
security.headers.hsts = all # none/domain/all
security.sessions=stateless #always/never/if_required/stateless
security.ignored=
security.user.name=user
security.user.role=USER
security.user.password=

# HttpMapperProperties
http.mappers.jsonPrettyPrint=false

#ServerProperties
server.port
server.address
server.sessionTimeout
server.contextPath
server.servletPath
server.tomcat.accessLogPattern;
server.tomcat.accessLogEnabled = false;
server.tomcat.protocolHeader = "x-forwarded-proto";
server.tomcat.remoteIpHeader = "x-forwarded-for";
server.tomcat.basedir;
server.tomcat.backgroundProcessorDelay = 30; // seconds
server.tomcat.maxThreads = 0; // Number of threads in protocol handler

# ConfigFileApplicationListner
spring.config.name=application
spring.config.location=

#SpringApplication
spring.main.sources
spring.main.webEnvironment
spring.main.showBannder

#ContextIdApplicationContextInitializer
spring.application.name
vcap.application.name
spring.config.name

# FileEncodingApplicationListener
spring.mandatoryFileEncoding=false

spring.profiles

spring.git.properties

spring.aop.auto
spring.aop.proxyTargetClass

# BatchDatabaseInitializer
spring.batch.job.names=job1,job2
spring.batch.job.enabled=true
spring.batch.initializer.enabled
spring.batch.schema


spring.jpa.hibernate.naming-strategy
ddl-auto

spring.jpa.properties.{...}=
spring.jpa.openInView=true
spring.jpa.show-sql=true
spring.jpa.database-platform
spring.jpa.database
spring.jpa.generate-ddl


# ThymeleafAutoConfiguration
spring.thymeleaf.prefix=classpath:/templates/
spring.thymeleaf.suffix=.html
modeHTML5
encoding=UTF-8
cache=true


spring.view.prefix=
spring.view.suffix=
spring.resources.cachePeriod

spring.messages.basenamemessages
spring.messages.encoding=UTF-8</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_auto_configuration_classes">19. Auto-configuration classes</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="__how_to_guides">20. &#8220;How-to&#8221; guides</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section provides answers to some common &#8220;how do I do that&#8230;&#8221; types of questions.</p>
</div>
<div class="sect2">
<h3 id="_spring_boot_application">20.1. Spring Boot application</h3>
<div class="sect3">
<h4 id="_troubleshoot_auto_configuration">20.1.1. Troubleshoot auto-configuration</h4>
<div class="paragraph">
<p>The Spring Boot auto-configuration tries it&#8217;s best to &#8220;do the right thing&#8221;, but
sometimes things fail and it can be hard to tell why.</p>
</div>
<div class="paragraph">
<p>There is a really useful <code>AutoConfigurationReport</code> available in any Spring Boot
<code>ApplicationContext</code>. You will see it if you enable <code>DEBUG</code> logging output. If you use
the Actuator there is also an endpoint <code>/autoconfig</code> that renders the report in JSON.
Use that to debug the application and see what features have been added (and which not) by
Spring Boot at runtime.</p>
</div>
<div class="paragraph">
<p>Many more questions can be answered by looking at the source code and Javadocs. Some
rules of thumb:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Look for classes called <code>*AutoConfiguration</code> and read their sources, in particular the
<code>@Conditional*</code> annotations to find out what features they enable and when. Add
<code>--debug</code> to the command line or a System property <code>-Ddebug</code> to get a printout on the
console of all the autoconfiguration decisions that were made in your app. In a running
Actuator app look at the <code>/autoconfig</code> endpoint (or the JMX equivalent) for the same
information.</p>
</li>
<li>
<p>Look for classes that are <code>@ConfigurationProperties</code> (e.g.
<a href="https://github.com/spring-projects/spring-boot/blob/master/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/web/ServerProperties.java?source=c"><code>ServerProperties</code></a>
and read from there the available external configuration options. The
<code>@ConfigurationProperties</code> has a <code>name</code> attribute which acts as a prefix to external
properties, thus <code>ServerProperties</code> has <code>name="server"</code> and its configuration properties
are <code>server.port</code>, <code>server.address</code> etc. In a running Actuator app look at the
<code>/configprops</code> endpoint or JMX equivalent.</p>
</li>
<li>
<p>Look for use of <code>RelaxedEnvironment</code> to pull configuration values explicitly out of the
<code>Environment</code>. It often is used with a prefix.</p>
</li>
<li>
<p>Look for <code>@Value</code> annotations that bind directly to the <code>Environment</code>. This is less
flexible than the <code>RelaxedEnvironment</code> approach, but does allow some relaxed binding,
specifically for OS environment variables (so <code>CAPITALS_AND_UNDERSCORES</code> are synonyms
for <code>period.separated</code>).</p>
</li>
<li>
<p>Look for <code>@ConditionalOnExpression</code> annotations that switch features on and off in
response to SpEL expressions, normally evaluated with place-holders resolved from the
<code>Environment</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_customize_the_environment_or_applicationcontext_before_it_starts">20.1.2. Customize the Environment or ApplicationContext before it starts</h4>
<div class="paragraph">
<p>A <code>SpringApplication</code> has <code>ApplicationListeners</code> and <code>ApplicationContextInitializers</code> that
are used to apply customizations to the context or environment. Spring Boot loads a number
of such customizations for use internally from <code>META-INF/spring.factories</code>. There is more
than one way to register additional ones:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Programmatically per application by calling the <code>addListeners</code> and <code>addInitializers</code>
methods on <code>SpringApplication</code> before you run it.</p>
</li>
<li>
<p>Declaratively per application by setting <code>context.initializer.classes</code> or
<code>context.listener.classes</code>.</p>
</li>
<li>
<p>Declarative for all applications by adding a <code>META-INF/spring.factories</code> and packaging
a jar file that the applications all use as a library.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>SpringApplication</code> sends some special <code>ApplicationEvents</code> to the listeners (even
some before the context is created), and then registers the listeners for events published
by the <code>ApplicationContext</code> as well. See XXX for a complete list.</p>
</div>
</div>
<div class="sect3">
<h4 id="build-hierarchy">20.1.3. Build an ApplicationContext hierarchy (adding a parent or root context)</h4>

</div>
<div class="sect3">
<h4 id="_create_a_non_web_application">20.1.4. Create a non-web application</h4>
<div class="paragraph">
<p>Not all Spring applications have to be web applications (or web services). If you want to
execute some code in a <code>main</code> method, but also bootstrap a Spring application to set up
the infrastructure to use, then it&#8217;s easy with the <code>SpringApplication</code> features of Spring
Boot. A <code>SpringApplication</code> changes its <code>ApplicationContext</code> class depending on whether it
thinks it needs a web application or not. The first thing you can do to help it is to just
leave the servlet API dependencies off the classpath. If you can&#8217;t do that (e.g. you are
running 2 applications from the same code base) then you can explicitly call
<code>SpringApplication.setWebEnvironment(false)</code>, or set the <code>applicationContextClass</code>
property (through the Java API or with external properties).
Application code that you want to run as your business logic can be implemented as a
<code>CommandLineRunner</code> and dropped into the context as a <code>@Bean</code> definition.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_properties_configuration">20.2. Properties &amp; configuration</h3>
<div class="sect3">
<h4 id="_externalize_the_configuration_of_springapplication">20.2.1. Externalize the configuration of SpringApplication</h4>
<div class="paragraph">
<p>A <code>SpringApplication</code> has bean properties (mainly setters) so you can use its Java API as
you create the application to modify its behavior. Or you can externalize the
configuration using properties in <code>spring.main.*</code>. E.g. in <code>application.properties</code> you
might have.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>spring.main.web_environment: false
spring.main.show_banner: false</pre>
</div>
</div>
<div class="paragraph">
<p>and then the Spring Boot banner will not be printed on startup, and the application will
not be a web application.</p>
</div>
</div>
<div class="sect3">
<h4 id="_change_the_location_of_external_properties_of_an_application">20.2.2. Change the location of external properties of an application</h4>
<div class="paragraph">
<p>By default properties from different sources are added to the Spring <code>Environment</code> in a
defined order, and the precedence for resolution is:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>commandline</p>
</li>
<li>
<p>filesystem (current working directory) <code>application.properties</code></p>
</li>
<li>
<p>classpath <code>application.properties</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>A nice way to augment and modify this is to add <code>@PropertySource</code> annotations to your
application sources. Classes passed to the <code>SpringApplication</code> static convenience
methods, and those added using <code>setSources()</code> are inspected to see if they have
<code>@PropertySources</code> and if they do those properties are added to the <code>Environment</code> early
enough to be used in all phases of the <code>ApplicationContext</code> lifecycle. Properties added
in this way have precendence over any added using the default locations, but have lower
priority than system properties, environment variables or the command line.</p>
</div>
<div class="paragraph">
<p>You can also provide System properties (or environment variables) to change the behavior:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>spring.config.name</code> (<code>SPRING_CONFIG_NAME</code>), defaults to <code>application</code> as the root of
the file name.</p>
</li>
<li>
<p><code>spring.config.location</code> (<code>SPRING_CONFIG_LOCATION</code>) is file to load (e.g. a classpath
resource or a URL). A separate <code>Environment</code> property source is set up for this document
and it can be overridden by system properties, environment variables or the
command line.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>No matter what you set in the environment, Spring Boot will always load
<code>application.properties</code> as described above. If YAML is used then files with the &#8220;.yml&#8221;
extension are also added to the list by default.</p>
</div>
<div class="paragraph">
<p>See <code>ConfigFileApplicationListener</code> for more detail.</p>
</div>
</div>
<div class="sect3">
<h4 id="_use_short_command_line_arguments">20.2.3. Use &#8220;short&#8221; command line arguments</h4>
<div class="paragraph">
<p>Some people like to use (for example) <code>--port=9000</code> instead of <code>--server.port=9000</code> to
set configuration properties on the command line. You can easily enable this by using
placeholders in <code>application.properties</code>, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>server.port: ${port:8080}</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
In this specific case the port binding will work in a PaaS environment like Heroku
and Cloud Foundry, since in those two platforms the <code>PORT</code> environment variable is set
automatically and Spring can bind to capitalized synonyms for <code>Environment</code> properties.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_use_yaml_for_external_properties">20.2.4. Use YAML for external properties</h4>
<div class="paragraph">
<p>YAML is a superset of JSON and as such is a very convenient syntax for storing external
properties in a hierarchical format. E.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint yaml language-yaml"><code>spring:
    application:
        name: cruncher
    datasource:
        driverClassName: com.mysql.jdbc.Driver
        url: jdbc:mysql://localhost/test
server:
    port: 9000</code></pre>
</div>
</div>
<div class="paragraph">
<p>Create a file called <code>application.yml</code> and stick it in the root of your classpath, and
also add <code>snakeyaml</code> to your classpath (Maven co-ordinates <code>org.yaml:snakeyaml</code>, already
included if you use a Spring Boot Starter). A YAML file is parsed to a Java
<code>Map&lt;String,Object&gt;</code> (like a JSON object), and Spring Boot flattens the maps so that it
is 1-level deep and has period-separated keys, a lot like people are used to with
<code>Properties</code> files in Java.</p>
</div>
<div class="paragraph">
<p>The example YAML above corresponds to an <code>application.properties</code> file</p>
</div>
<div class="listingblock">
<div class="content">
<pre>spring.application.name: cruncher
spring.datasource.driverClassName: com.mysql.jdbc.Driver
spring.datasource.url: jdbc:mysql://localhost/test
server.port: 9000</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_set_the_active_spring_profiles">20.2.5. Set the active Spring profiles</h4>
<div class="paragraph">
<p>The Spring <code>Environment</code> has an API for this, but normally you would set a System profile
(<code>spring.profiles.active</code>) or an OS environment variable (<code>SPRING_PROFILES_ACTIVE</code>). E.g.
launch your application with a <code>-D...</code> argument (remember to put it before the main class
or jar archive):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ java -jar -Dspring.profiles.active=production demo-0.0.1-SNAPSHOT.jar</pre>
</div>
</div>
<div class="paragraph">
<p>In Spring Boot you can also set the active profile in <code>application.properties</code>, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>spring.profiles.active=production</pre>
</div>
</div>
<div class="paragraph">
<p>A value set this way is replaced by the System property or environment variable setting,
but not by the <code>SpringApplicationBuilder.profiles()</code> method. Thus the latter Java API can
be used to augment the profiles without changing the defaults.</p>
</div>
</div>
<div class="sect3">
<h4 id="_change_configuration_depending_on_the_environment">20.2.6. Change configuration depending on the environment</h4>
<div class="paragraph">
<p>A YAML file is actually a sequence of documents separated by <code>---</code> lines, and each
document is parsed separately to a flattened map.</p>
</div>
<div class="paragraph">
<p>If a YAML document contains a <code>spring.profiles</code> key, then the profiles value
(comma-separated list of profiles) is fed into the Spring
<code>Environment.acceptsProfiles()</code> and if any of those profiles is active that document is
included in the final merge (otherwise not).</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint yaml language-yaml"><code>server:
    port: 9000
---

spring:
    profiles: development
server:
    port: 9001

---

spring:
    profiles: production
server:
    port: 0</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example the default port is 9000, but if the Spring profile &#8220;development&#8221; is
active then the port is 9001, and if &#8220;production&#8221; is active then it is 0.</p>
</div>
<div class="paragraph">
<p>The YAML documents are merged in the order they are encountered (so later values override
earlier ones).</p>
</div>
<div class="paragraph">
<p>To do the same thing with properties files you can use <code>application-${profile}.properties</code>
to specify profile-specific values.</p>
</div>
</div>
<div class="sect3">
<h4 id="discover-options">20.2.7. Discover built-in options for external properties</h4>
<div class="paragraph">
<p>Spring Boot binds external properties from <code>application.properties</code> (or <code>.yml</code>) (and
other places) into an application at runtime.  There is not (and technically cannot be)
an exhaustive list of all supported properties in a single location because contributions
can come from additional JAR files on your classpath.</p>
</div>
<div class="paragraph">
<p>A running application with the Actuator features has a <code>/configprops</code> endpoint that shows
all the bound and bindable properties available through <code>@ConfigurationProperties</code> (also
exposed through JMX if you don&#8217;t have a web endpoint).</p>
</div>
<div class="paragraph">
<p>There is a sample
<a href="https://github.com/spring-projects/spring-boot/blob/master/docs/application.yml"><code>application.yml</code></a>
with a non-exhaustive and possibly inaccurate list of properties supported by Spring Boot
vanilla with autoconfiguration. The definitive list comes from searching the source code
for <code>@ConfigurationProperties</code> and <code>@Value</code> annotations, as well as the occasional use of
<code>RelaxedEnvironment</code> (c.f. <a href="https://github.com/spring-projects/spring-boot/blob/master/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/orm/jpa/HibernateJpaAutoConfiguration.java?source=c#L65">here</a>).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_embedded_servlet_containers">20.3. Embedded servlet containers</h3>
<div class="sect3">
<h4 id="_add_a_servlet_filter_or_servletcontextlistener_to_an_application">20.3.1. Add a Servlet, Filter or ServletContextListener to an application</h4>
<div class="paragraph">
<p><code>Servlet</code>, <code>Filter</code>, <code>ServletContextListener</code> and the other listeners supported by the
Servlet spec can be added to your application as <code>@Bean</code> definitions. Be very careful that
they don&#8217;t cause eager initialization of too many other beans because they have to be
installed in th container very early in the application lifecycle (e.g. it&#8217;s not a good
idea to have them depend on your <code>DataSource</code> or JPA configuration). You can work around
restrictions like that by initializing them lazily when first used instead of on
initialization.</p>
</div>
<div class="paragraph">
<p>In the case of <code>Filters</code> and <code>Servlets</code> you can also add mappings and init parameters by
adding a <code>FilterRegistrationBean</code> or <code>ServletRegistrationBean</code> instead of or as well as
the underlying component.</p>
</div>
</div>
<div class="sect3">
<h4 id="_change_the_http_port">20.3.2. Change the HTTP port</h4>
<div class="paragraph">
<p>In a standalone application the main HTTP port defaults to 8080, but can be set with
<code>server.port</code> (e.g. in <code>application.properties</code> or as a System property). Thanks to
relaxed binding of <code>Environment</code> values you can also use <code>SERVER_PORT</code> (e.g. as an OS
environment variable).</p>
</div>
<div class="paragraph">
<p>To switch off the HTTP endpoints completely, but still create a <code>WebApplicationContext</code>,
use <code>server.port=-1</code> (this is sometimes useful for testing).</p>
</div>
<div class="paragraph">
<p>For more detail look at the <a href="https://github.com/spring-projects/spring-boot/blob/master/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/web/ServerProperties.java?source=c"><code>ServerProperties</code></a>
source code.</p>
</div>
</div>
<div class="sect3">
<h4 id="_use_a_random_unassigned_http_port">20.3.3. Use a random unassigned HTTP port</h4>
<div class="paragraph">
<p>To scan for a free port (using OS natives to prevent clashes) use <code>server.port=0</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_discover_the_http_port_at_runtime">20.3.4. Discover the HTTP port at runtime</h4>
<div class="paragraph">
<p>You can access the port the server is running on from log output or from the
<code>EmbeddedWebApplicationContext</code> via its <code>EmbeddedServletContainer</code>. The best way to get
that and be sure that it has initialized is to add a <code>@Bean</code> of type
<code>ApplicationListener&lt;EmbeddedServletContainerInitializedEvent&gt;</code> and pull the container
out of the event wehen it is published.</p>
</div>
</div>
<div class="sect3">
<h4 id="_configure_tomcat">20.3.5. Configure Tomcat</h4>
<div class="paragraph">
<p>Generally you can follow the advice from <a href="#discover-options">Discover built-in options for external properties</a> about
<code>@ConfigurationProperties</code> (<code>ServerProperties</code> is the main one here), but also look at
<code>EmbeddedServletContainerCustomizer</code> and various Tomcat specific <code>*Customizers</code> that you
can add in one of those. The Tomcat APIs are quite rich so once you have access to the
<code>TomcatEmbeddedServletContainerFactory</code> you can modify it in a number of ways. Or the
nuclear option is to add your own <code>TomcatEmbeddedServletContainerFactory</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_terminate_ssl_in_tomcat">20.3.6. Terminate SSL in Tomcat</h4>
<div class="paragraph">
<p>Add a <code>EmbeddedServletContainerCustomizer</code> and in that add a <code>TomcatConnectorCustomizer</code>
that sets up the connector to be secure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>@Bean
public EmbeddedServletContainerCustomizer containerCustomizer(){
    return new MyCustomizer();
}

// ...

private static class MyCustomizer implements EmbeddedServletContainerCustomizer {

    @Override
    public void customize(ConfigurableEmbeddedServletContainerFactory factory) {
        if(factory instanceof TomcatEmbeddedServletContainerFactory) {
            customizeTomcat((TomcatEmbeddedServletContainerFactory) factory));
        }
    }

    public void customizeTomcat(TomcatEmbeddedServletContainerFactory factory) {
        factory.addConnectorCustomizers(new TomcatConnectorCustomizer() {
            @Override
            public void customize(Connector connector) {
                connector.setPort(serverPort);
                connector.setSecure(true);
                connector.setScheme("https");
                connector.setAttribute("keyAlias", "tomcat");
                connector.setAttribute("keystorePass", "password");
                try {
                    connector.setAttribute("keystoreFile",
                        ResourceUtils.getFile("src/ssl/tomcat.keystore").getAbsolutePath());
                } catch (FileNotFoundException e) {
                    throw new IllegalStateException("Cannot load keystore", e);
                }
                connector.setAttribute("clientAuth", "false");
                connector.setAttribute("sslProtocol", "TLS");
                connector.setAttribute("SSLEnabled", true);
            }
        });
    }

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_use_jetty_instead_of_tomcat">20.3.7. Use Jetty instead of Tomcat</h4>
<div class="paragraph">
<p>The Spring Boot starters (<code>spring-boot-starter-web</code> in particular) use Tomcat as an
embedded container by default. You need to exclude those dependencies and include the
Jetty ones to use that container. Spring Boot provides Tomcat and Jetty dependencies
bundled together as separate startes to help make this process as easy as possible.</p>
</div>
<div class="paragraph">
<p>Example in Maven:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint xml language-xml"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
    &lt;exclusions&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;
        &lt;/exclusion&gt;
    &lt;/exclusions&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-jetty&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example in Gradle:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint groovy language-groovy"><code>configurations {
    compile.exclude module: <em>spring-boot-starter-tomcat</em>
}

dependencies {
    compile("org.springframework.boot:spring-boot-starter-web:1.0.0.RC3")
    compile("org.springframework.boot:spring-boot-starter-jetty:1.0.0.RC3")
    // ...
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_configure_jetty">20.3.8. Configure Jetty</h4>
<div class="paragraph">
<p>Generally you can follow the advice [here](#discover.options) about
<code>@ConfigurationProperties</code> (<code>ServerProperties</code> is the main one here), but also look at
<code>EmbeddedServletContainerCustomizer</code>. The Jetty APIs are quite rich so once you have
access to the <code>JettyEmbeddedServletContainerFactory</code> you can modify it in a number
of ways. Or the nuclear option is to add your own <code>JettyEmbeddedServletContainerFactory</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_use_tomcat_8">20.3.9. Use Tomcat 8</h4>
<div class="paragraph">
<p>Tomcat 8 works with Spring Boot, but the default is to use Tomcat 7 (so we can support
Java 1.6 out of the box). You should only need to change the classpath to use Tomcat 8
for it to work. The <a href="https://github.com/spring-projects/spring-boot/blob/master/spring-boot-samples/spring-boot-sample-websocket/pom.xml">websocket sample</a>
shows you how to do that in Maven.</p>
</div>
</div>
<div class="sect3">
<h4 id="_use_jetty_9">20.3.10. Use Jetty 9</h4>
<div class="paragraph">
<p>Jetty 9 works with Spring Boot, but the default is to use Jetty 8 (so we can support
Java 1.6 out of the box). You should only need to change the classpath to use Jetty 9
for it to work.</p>
</div>
<div class="paragraph">
<p>If you are using the starter poms and parent you can just add the Jetty starter and
change the version properties, e.g. for a simple webapp or service:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint xml language-xml"><code>&lt;properties&gt;
    &lt;java.version&gt;1.7&lt;/java.version&gt;
    &lt;jetty.version&gt;9.1.0.v20131115&lt;/jetty.version&gt;
    &lt;servlet-api.version&gt;3.1.0&lt;/servlet-api.version&gt;
&lt;/properties&gt;
&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;exclusions&gt;
            &lt;exclusion&gt;
                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;
            &lt;/exclusion&gt;
        &lt;/exclusions&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-jetty&lt;/artifactId&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_spring_mvc">20.4. Spring MVC</h3>
<div class="sect3">
<h4 id="_write_a_json_rest_service">20.4.1. Write a JSON REST service</h4>
<div class="paragraph">
<p>Any Spring <code>@RestController</code> in a Spring Boot application should render JSON response by
default as long as Jackson2 is on the classpath. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>@RestController
public class MyController {

    @RequestMapping("/thing")
    public MyThing thing() {
            return new MyThing();
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As long as <code>MyThing</code> can be serialized by Jackson2 (e.g. a normal POJO or Groovy object)
then <code>http://localhost:8080/thing</code> will serve a JSON representation of it by default.
Sometimes in a browser you might see XML responses (but by default only if <code>MyThing</code> was
a JAXB object) because browsers tend to send accept headers that prefer XML.</p>
</div>
</div>
<div class="sect3">
<h4 id="_customize_the_jackson_objectmapper">20.4.2. Customize the Jackson ObjectMapper</h4>
<div class="paragraph">
<p>Spring MVC (client and server side) uses <code>HttpMessageConverters</code> to negotiate content
conversion in an HTTP exchange. If Jackson is on the classpath you already get a default
converter with a vanilla <code>ObjectMapper</code>. Spring Boot has some features to make it easier
to customize this behavior.</p>
</div>
<div class="paragraph">
<p>The smallest change that might work is to just add beans of type <code>Module</code> to your context.
They will be registered with the default <code>ObjectMapper</code> and then injected into the default
message converter. To replace the default <code>ObjectMapper</code> completely, define a <code>@Bean</code> of
that type and mark it as <code>@Primary</code>.</p>
</div>
<div class="paragraph">
<p>In addition, if your context contains any beans of type <code>ObjectMapper</code> then all of the
<code>Module</code> beans will be registered with all of the mappers. So there is a global mechanism
for contributing custom modules when you add new features to your application.</p>
</div>
<div class="paragraph">
<p>Finally, if you provide any <code>@Beans</code> of type <code>MappingJackson2HttpMessageConverter</code> then
they will replace the default value in the MVC configuration. Also, a convenience bean is
provided of type <code>HttpMessageConverters</code> (always available if you use the default MVC
configuration) which has some useful methods to access the default and user-enhanced
message converters.</p>
</div>
<div class="paragraph">
<p>See also the <a href="#message-converters">section on <code>HttpMessageConverters</code></a> and the
<code>WebMvcAutoConfiguration</code> source code for more details.</p>
</div>
</div>
<div class="sect3">
<h4 id="message-converters">20.4.3. Customize the @ResponseBody rendering</h4>
<div class="paragraph">
<p>Spring uses <code>HttpMessageConverters</code> to render <code>@ResponseBody</code> (or responses from
<code>@RestControllers</code>). You can contribute additional converters by simply adding beans of
that type in a Spring Boot context. If a bean you add is of a type that would have been
included by default anyway (like <code>MappingJackson2HttpMessageConverter</code> for JSON
conversions) then it will replace the default value. A convenience bean is provided of
type <code>HttpMessageConverters</code> (always available if you use the default MVC configuration)
which has some useful methods to access the default and user-enhanced message converters
(useful, for example if you want to manually inject them into a custom <code>RestTemplate</code>).</p>
</div>
<div class="paragraph">
<p>As in normal MVC usage, any <code>WebMvcConfigurerAdapter</code> beans that you provide can also
contribute converters by overriding the <code>configureMessageConverters</code> method, but unlike
with normal MVC, you can supply only additional converters that you need (because Spring
Boot uses the same mechanism to contribute its defaults). Finally, if you opt out of the
Spring Boot default MVC configuration by providing your own <code>@EnableWebMvc</code> configuration,
then you can take control completely and do everything manually using
<code>getMessageConverters</code> from <code>WebMvcConfigurationSupport</code>.</p>
</div>
<div class="paragraph">
<p>See the <code>WebMvcAutoConfiguration</code> source code for more details.</p>
</div>
</div>
<div class="sect3">
<h4 id="_switch_off_the_spring_mvc_dispatcherservlet">20.4.4. Switch off the Spring MVC DispatcherServlet</h4>
<div class="paragraph">
<p>Spring Boot wants to serve all content from the root of your application <code>/</code> down. If you
would rather map your own servlet to that URL you can do it, but of course you may lose
some of the other Boot MVC features. To add your own servlet and map it to the root
resource just declare a <code>@Bean</code> of type <code>Servlet</code> and give it the special bean name
<code>dispatcherServlet</code>. (You can also create a bean of a different type with that name if
you want to switch it off and not replace it.)</p>
</div>
</div>
<div class="sect3">
<h4 id="_switch_off_the_default_mvc_configuration">20.4.5. Switch off the Default MVC configuration</h4>
<div class="paragraph">
<p>The easiest way to take complete control over MVC configuration is to provide your own
<code>@Configuration</code> with the <code>@EnableWebMvc</code> annotation. This will leave all MVC
configuration in your hands.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_logging_2">20.5. Logging</h3>
<div class="sect3">
<h4 id="_configure_logback_for_logging">20.5.1. Configure Logback for logging</h4>
<div class="paragraph">
<p>Spring Boot has no mandatory logging dependence, except for the <code>commons-logging</code> API, of
which there are many implementations to choose from. To use <a href="http://logback.qos.ch">Logback</a>
you need to include it, and some bindings for <code>commons-logging</code> on the classpath. The
simplest way to do that is through the starter poms which all depend on
<code>spring-boot-start-logging</code>.  For a web application you only need the web starter since it
depends transitively on the logging starter. E.g. in Maven:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint xml language-xml"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Spring Boot has a <code>LoggingSystem</code> abstraction that attempts to select a system depending
on the contents of the classpath. If Logback is available it is the first choice. So if
you put a <code>logback.xml</code> in the root of your classpath it will be picked up from there.
Spring Boot provides a default base configuration that you can include if you just want
to set levels, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint xml language-xml"><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;configuration&gt;
    &lt;include resource="org/springframework/boot/logging/logback/base.xml"/&gt;
    &lt;logger name="org.springframework.web" level="DEBUG"/&gt;
&lt;/configuration&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you look at the default <code>logback.xml</code> in the spring-boot JAR you will see that it uses
some useful System properties which the <code>LoggingSystem</code> takes care of creating for you.
These are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>${PID}</code> the current process ID.</p>
</li>
<li>
<p><code>${LOG_FILE}</code> if <code>logging.file</code> was set in Boot&#8217;s external configuration.</p>
</li>
<li>
<p><code>${LOG_PATH</code> if <code>logging.path</code> was set (representing a directory for
log files to live in).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Spring Boot also provides some nice ANSI colour terminal output on a console (but not in
a log file) using a custom Logback converter. See the default <code>base.xml</code> configuration
for details.</p>
</div>
<div class="paragraph">
<p>If Groovy is on the classpath you should be able to configure Logback with
<code>logback.groovy</code> as well (it will be given preference if present).</p>
</div>
</div>
<div class="sect3">
<h4 id="_configure_log4j_for_logging">20.5.2. Configure Log4j for logging</h4>
<div class="paragraph">
<p>Spring Boot supports <a href="http://logging.apache.org/log4j/1.x/">Log4j</a> for logging
configuration, but it has to be on the classpath. If you are using the starter poms for
assembling dependencies that means you have to exclude logback and then include log4j
back. If you aren&#8217;t using the starter poms then you need to provide <code>commons-logging</code>
(at least) in addition to Log4j.</p>
</div>
<div class="paragraph">
<p>The simplest path to using Log4j is probably through the starter poms, even though it
requires some jiggling with excludes, e.g. in Maven:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint xml language-xml"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
    &lt;exclusions&gt;
            &lt;exclusion&gt;
                    &lt;groupId&gt;${project.groupId}&lt;/groupId&gt;
                    &lt;artifactId&gt;spring-boot-starter-logging&lt;/artifactId&gt;
            &lt;/exclusion&gt;
    &lt;/exclusions&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-log4j&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
The use of the log4j starter to gather together the dependencies for common logging
requirements (e.g. including having Tomcat use <code>java.util.logging</code> but configure the
output using Log4j). See the Actuator Log4j Sample for more detail and to see it in
action.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_data_access">20.6. Data Access</h3>
<div class="sect3">
<h4 id="_configure_a_datasource_2">20.6.1. Configure a DataSource</h4>
<div class="paragraph">
<p>See XXX.</p>
</div>
<div class="paragraph">
<p>To override the default settings just define a <code>@Bean</code> of your own of type <code>DataSource</code>.
See <a href="https://github.com/spring-projects/spring-boot/blob/master/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/jdbc/DataSourceAutoConfiguration.java"><code>DataSourceAutoConfiguration</code></a>
for more details.</p>
</div>
</div>
<div class="sect3">
<h4 id="_use_spring_data_repositories">20.6.2. Use Spring Data repositories</h4>
<div class="paragraph">
<p>Spring Data can create implementations for you of <code>@Repository</code> interfaces of various
flavours. Spring Boot will handle all of that for you as long as those <code>@Repositories</code>
are included in the same package (or a sub-package) of your <code>@EnableAutoConfiguration</code>
class.</p>
</div>
<div class="paragraph">
<p>For many applications all you will need is to put the right Spring Data dependencies on
your classpath (there is a <code>spring-boot-starter-data-jpa</code> for JPA and for Mongodb you
only need to add <code>spring-datamongodb</code>), create some repository interfaces to handle your
<code>@Entity</code> objects. Examples are in the <a href="https://github.com/spring-projects/spring-boot/tree/master/spring-boot-samples/spring-boot-sample-data-jpa">JPA sample</a>
or the <a href="https://github.com/spring-projects/spring-boot/tree/master/spring-boot-samples/spring-boot-sample-data-mongodb">Mongodb sample</a>.</p>
</div>
<div class="paragraph">
<p>Spring Boot tries to guess the location of your <code>@Repository</code> definitions, based on the
<code>@EnableAutoConfiguration</code> it finds. To get more control, use the <code>@EnableJpaRepositories</code>
annotation (from Spring Data JPA).</p>
</div>
</div>
<div class="sect3">
<h4 id="_separate_entity_definitions_from_spring_configuration">20.6.3. Separate @Entity definitions from Spring configuration</h4>
<div class="paragraph">
<p>Spring Boot tries to guess the location of your <code>@Entity</code> definitions, based on the
<code>@EnableAutoConfiguration</code> it finds. To get more control, you can use the <code>@EntityScan</code>
annotation, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>@Configuration
@EnableAutoConfiguration
@EntityScan(basePackageClasses=City.class)
public class Application {

    //...

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_configure_jpa_properties">20.6.4. Configure JPA properties</h4>
<div class="paragraph">
<p>Spring JPA already provides some vendor-independent configuration options (e.g. for SQL
logging) and Spring Boot exposes those, and a few more for hibernate as external
configuration properties. The most common options to set are:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>spring.jpa.hibernate.ddl-auto: create-drop
spring.jpa.hibernate.naming_strategy: org.hibernate.cfg.ImprovedNamingStrategy
spring.jpa.database: H2
spring.jpa.show-sql: true</pre>
</div>
</div>
<div class="paragraph">
<p>(Because of relaxed data binding hyphens or underscores should work equally well as
property keys.)  The <code>ddl-auto</code> setting is a special case in that it has different
defaults depending on whether you are using an embedded database (<code>create-drop</code>) or not
(<code>none</code>). In addition all properties in <code>spring.jpa.properties.*</code> are passed through as
normal JPA properties (with the prefix stripped) when the local <code>EntityManagerFactory</code> is
created.</p>
</div>
<div class="paragraph">
<p>See <a href="https://github.com/spring-projects/spring-boot/blob/master/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/orm/jpa/HibernateJpaAutoConfiguration.java"><code>HibernateJpaAutoConfiguration</code></a>
and <a href="https://github.com/spring-projects/spring-boot/blob/master/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/orm/jpa/JpaBaseConfiguration.java"><code>JpaBaseConfiguration</code></a>
for more details.</p>
</div>
</div>
<div class="sect3">
<h4 id="_use_a_traditional_persistence_xml">20.6.5. Use a traditional persistence.xml</h4>
<div class="paragraph">
<p>Spring doesn&#8217;t require the use of XML to configure the JPA provider, and Spring Boot
assumes you want to take advantage of that feature. If you prefer to use <code>persistence.xml</code>
then you need to define your own <code>@Bean</code> of type <code>LocalEntityManagerFactoryBean</code>, and set
the persistence unit name there.</p>
</div>
<div class="paragraph">
<p>See
<a href="https://github.com/spring-projects/spring-boot/blob/master/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/orm/jpa/JpaBaseConfiguration.java"><code>JpaBaseConfiguration</code></a>
for the default settings.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_database_initialization">20.7. Database initialization</h3>
<div class="paragraph">
<p>An SQL database can be initialized in different ways depending on what your stack is. Or
of course you can do it manually as long as the database is in a server.</p>
</div>
<div class="sect3">
<h4 id="_initialize_a_database_using_jpa">20.7.1. Initialize a database using JPA</h4>
<div class="paragraph">
<p>JPA has features for DDL generation, and these can be set up to run on startup against the
database. This is controlled through two external properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>spring.jpa.generate-ddl</code> (boolean) switches the feature on and off and is vendor
independent.</p>
</li>
<li>
<p><code>spring.jpa.hibernate.ddl-auto</code> (enum) is a Hibernate feature that controls the
behavior in a more fine-grained way. See below for more detail.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_initialize_a_database_using_hibernate">20.7.2. Initialize a database using Hibernate</h4>
<div class="paragraph">
<p>You can set <code>spring.jpa.hibernate.ddl-auto</code> explicitly and the standard Hibernate property
values are <code>none</code>, <code>validate</code>, <code>update</code>, <code>create-drop</code>. Spring Boot chooses a default
value for you based on whether it thinks your database is embedded (default <code>create-drop</code>)
or not (default <code>none</code>). An embedded database is detected by looking at the <code>Connection</code>
type: <code>hsqldb</code>, <code>h2</code> and <code>derby</code> are embedded, the rest are not. Be careful when switching
from in-memory to a &#8220;real&#8221; database that you don&#8217;t make assumptions about the existence of
the tables and data in the new platform. You either have to set <code>ddl-auto</code> expicitly, or
use one of the other mechanisms to initialize the database.</p>
</div>
<div class="paragraph">
<p>In addition, a file named <code>import.sql</code> in the root of the classpath will be executed on
startup. This can be useful for demos and for testing if you are carefuil, but probably
not something you want to be on the classpath in production. It is a Hibernate feature
(nothing to do with Spring).</p>
</div>
</div>
<div class="sect3">
<h4 id="_initialize_a_database_using_spring_jdbc">20.7.3. Initialize a database using Spring JDBC</h4>
<div class="paragraph">
<p>Spring JDBC has a <code>DataSource</code> initializer feature. Spring Boot enables it by default and
loads SQL from the standard locations <code>schema.sql</code> and <code>data.sql</code> (in the root of the
classpath). In addition Spring Boot will load a file <code>schema-${platform}.sql</code> where
<code>platform</code> is the vendor name of the database (<code>hsqldb</code>, <code>h2</code>, <code>oracle</code>, <code>mysql</code>,
<code>postgresql</code> etc.). Spring Boot enables the failfast feature of the Spring JDBC
initializer by default, so if the scripts cause exceptions the application will fail.</p>
</div>
<div class="paragraph">
<p>To disable the failfast you can set <code>spring.datasource.continueOnError=true</code>. This can be
useful once an application has matured and been deployed a few times, since the scripts
can act as &#8220;poor man&#8217;s migrations&#8221; - inserts that fail mean that the data is already
there, so there would be no need to prevent the application from running, for instance.</p>
</div>
</div>
<div class="sect3">
<h4 id="_initialize_a_spring_batch_database">20.7.4. Initialize a Spring Batch database</h4>
<div class="paragraph">
<p>If you are using Spring Batch then it comes pre-packaged with SQL initialization scripts
for most popular database platforms. Spring Boot will detect your database type, and
execute those scripts by default, and in this case will switch the fail fast setting to
false (errors are logged but do not prevent the application from starting). This is
because the scripts are known to be reliable and generally do not contain bugs, so errors
are ignorable, and ignoring them makes the scripts idempotent. You can switch off the
initialization explicitly using <code>spring.batch.initializer.enabled=false</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_use_a_higher_level_datababse_migration_tool">20.7.5. Use a higher level datababse migration tool</h4>
<div class="paragraph">
<p>Spring Boot works fine with higher level migration tools <a href="http://flywaydb.org/">Flyway</a>
(SQL-based) and <a href="http://www.liquibase.org/">Liquibase</a> (XML). In general we prefer
Flyway because it is easier on the eyes, and it isn&#8217;t very common to need platform
independence: usually only one or at most couple of platforms is needed.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_batch_applications">20.8. Batch applications</h3>
<div class="sect3">
<h4 id="_execute_spring_batch_jobs_on_startup">20.8.1. Execute Spring Batch jobs on startup</h4>
<div class="paragraph">
<p>Spring Batch autoconfiguration is enabled by adding <code>@EnableBatchProcessing</code>
(from Spring Batch) somewhere in your context.</p>
</div>
<div class="paragraph">
<p>By default it executes <strong>all</strong> <code>Jobs</code> in the application context on startup (see
<a href="https://github.com/spring-projects/spring-boot/blob/master/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/batch/JobLauncherCommandLineRunner.java">JobLauncherCommandLineRunner</a>
for details). You can narrow down to a specific job or jobs by specifying
<code>spring.batch.job.names</code> (comma separated job name patterns).</p>
</div>
<div class="paragraph">
<p>If the application context includes a <code>JobRegistry</code> then the jobs in
<code>spring.batch.job.names</code> are looked up in the regsitry instead of bein autowired from the
context. This is a common pattern with more complex systems where multiple jobs are
defined in child contexts and registered centrally.</p>
</div>
<div class="paragraph">
<p>See
<a href="https://github.com/spring-projects/spring-boot/blob/master/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/batch/BatchAutoConfiguration.java">BatchAutoConfiguration</a>
and
<a href="https://github.com/spring-projects/spring-batch/blob/master/spring-batch-core/src/main/java/org/springframework/batch/core/configuration/annotation/EnableBatchProcessing.java">@EnableBatchProcessing</a>
for more details.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_actuator">20.9. Actuator</h3>
<div class="sect3">
<h4 id="_change_the_http_port_or_address_of_the_actuator_endpoints">20.9.1. Change the HTTP port or address of the actuator endpoints</h4>
<div class="paragraph">
<p>In a standalone application the Actuator HTTP port defaults to the same as the main HTTP
port. To make the application listen on a different port set the external property
<code>management.port</code>. To listen on a completely different network address (e.g. if you have
an internal network for management and an external one for user applications) you can
also set <code>management.address</code> to a valid IP address that the server is able to bind to.</p>
</div>
<div class="paragraph">
<p>For more detail look at the
<a href="https://github.com/spring-projects/spring-boot/blob/master/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/properties/ManagementServerProperties.java?source=c"><code>ManagementServerProperties</code></a>
source code.</p>
</div>
</div>
<div class="sect3">
<h4 id="_customize_the_whitelabel_error_page">20.9.2. Customize the &#8220;whitelabel&#8221; error page</h4>
<div class="paragraph">
<p>The Actuator installs a &#8220;whitelabel&#8221; error page that you will see in browser client if
you encounter a server error (machine clients consuming JSON and other media types should
see a sensible response with the right error code). To switch it off you can set
<code>error.whitelabel.enabled=false</code>, but normally in addition or alternatively to that you
will want to add your own error page replacing the whitelabel one. If you are using
Thymeleaf you can do this by adding an <code>error.html</code> template. In general what you need is
a <code>View</code> that resolves with a name of <code>error</code>, and/or a <code>@Controller</code> that handles the
<code>/error</code> path. Unless you replaced some of the default configuration you should find a
<code>BeanNameViewResolver</code> in your <code>ApplicationContext</code> so a <code>@Bean</code> with id <code>error</code> would be
a simple way of doing that.  Look at <code>ErrorMvcAutoConfiguration</code> for more options.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_security">20.10. Security</h3>
<div class="sect3">
<h4 id="_secure_an_application">20.10.1. Secure an application</h4>
<div class="paragraph">
<p>Web applications will be secure by default (with Basic authentication on all endpoints) if
Spring Security is on the classpath. To add method-level security to a web application you
can simply <code>@EnableGlobalMethodSecurity</code> with your desired settings.</p>
</div>
<div class="paragraph">
<p>The default <code>AuthenticationManager</code> has a single user (username &#8220;user&#8221; and password
random, printed at INFO when the application starts up). You can change the password by
providing a <code>security.user.password</code>. This and other useful properties are externalized
via <code>SecurityProperties</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_switch_off_the_spring_boot_security_configuration">20.10.2. Switch off the Spring Boot security configuration</h4>
<div class="paragraph">
<p>If you define a <code>@Configuration</code> with <code>@EnableWebSecurity</code> anywhere in your application
it will switch off the default webapp security settings in Spring Boot. To tweak the
defaults try setting properties in <code>security.*</code> (see
<a href="https://github.com/spring-projects/spring-boot/blob/master/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/security/SecurityProperties.java"><code>SecurityProperties</code></a>
for details of available settings).</p>
</div>
</div>
<div class="sect3">
<h4 id="_change_the_authenticationmanager_and_add_user_accounts">20.10.3. Change the AuthenticationManager and add user accounts</h4>
<div class="paragraph">
<p>If you provide a <code>@Bean</code> of type <code>AuthenticationManager</code> the default one will not be
created, so you have the full feature set of Spring Security available (e.g.
<a href="http://docs.spring.io/spring-security/site/docs/3.2.1.RELEASE/reference/htmlsingle/#jc-authentication">various authentication options</a>).</p>
</div>
<div class="paragraph">
<p>Spring Security also provides a convenient <code>AuthenticationManagerBuilder</code> which can be
used to build an <code>AuthenticationManager</code> with common options. The recommended way to
use this in a webapp is to inject it into a void method in a
<code>WebSecurityConfigurerAdapter</code>, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>@Configuration
@Order(0)
public class SecurityConfiguration extends WebSecurityConfigurerAdapter {

    @Autowired
    protected void init(AuthenticationManagerBuilder builder) {
            builder.inMemoryAuthentication().withUser("barry"); // ...  etc.
    }

    // ... other stuff for application security

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The configuration class that does this should declare an <code>@Order</code> so that it is used
before the default one in Spring Boot (which has very low precedence).</p>
</div>
</div>
<div class="sect3">
<h4 id="_enable_https">20.10.4. Enable HTTPS</h4>
<div class="paragraph">
<p>Ensuring that all your main endpoints are only available over HTTPS is an important
chore for any application.  If you are using Tomcat as a servlet container, then the
Spring Boot will add Tomcat&#8217;s own <code>RemoteIpValve</code> automatically if it detects some
environment settings, and you should be able to rely on the <code>HttpServletRequest</code> to
report whether or not it is secure (even downstream of the real SSL termination). The
standard behavior is determined by the presence or absence of certain request headers
(<code>x-forwarded-for</code> and <code>x-forwarded-proto</code>), whose names are conventional, so it should
work with most front end proxies.  You switch on the valve by adding some entries to
<code>application.properties</code>, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>server.tomcat.remote_ip_header: x-forwarded-for
server.tomcat.protocol_header: x-forwarded-proto</pre>
</div>
</div>
<div class="paragraph">
<p>(The presence of either of those properties will switch on the valve. Or you can add the
<code>RemoteIpValve</code> yourself by adding a <code>TomcatEmbeddedServletContainerFactory</code> bean.)</p>
</div>
<div class="paragraph">
<p>Spring Security can also be configured to require a secure channel for all (or some
requests). To switch that on in a Spring Boot application you just need to set
<code>security.require_https</code> to <code>true</code> in <code>application.properties</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_hot_swapping_2">20.11. Hot swapping</h3>
<div class="sect3">
<h4 id="_reload_static_content">20.11.1. Reload static content</h4>
<div class="paragraph">
<p>There are several options. Running in an IDE (especially with debugging on) is a good way
to do development (all modern IDEs allow reloading of static resources and usually also
hot-swapping of Java class changes). The Maven and Gradle tooling also support running
from the command line with reloading of static files. You can use that with an external
css/js compiler process if you are writing that code with higher level tools.</p>
</div>
</div>
<div class="sect3">
<h4 id="_reload_thymeleaf_templates_without_restarting_the_container">20.11.2. Reload Thymeleaf templates without restarting the container</h4>
<div class="paragraph">
<p>If you are using Thymeleaf, then set <code>spring.thymeleaf.cache=false</code>. See
<code>ThymeleafAutoConfiguration</code> for other template customization options.</p>
</div>
</div>
<div class="sect3">
<h4 id="_reload_java_classes_without_restarting_the_container">20.11.3. Reload Java classes without restarting the container</h4>
<div class="paragraph">
<p>Modern IDEs (Eclipse, IDEA etc.) all support hot swapping of bytecode, so if you make a
change that doesn&#8217;t affect class or method signatures it should reload cleanly with no
side effects.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/spring-projects/spring-loaded">Spring Loaded</a> goes a little further in
that it can reload class definitions with changes in the method signatures. With some
customization it can force an <code>ApplicationContext</code> to refresh itself (but there is no
general mechanism to ensure that would be safe for a running application anyway, so it
would only ever be a development time trick probably).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_build">20.12. Build</h3>
<div class="sect3">
<h4 id="_build_an_executable_archive_with_ant">20.12.1. Build an executable archive with Ant</h4>
<div class="paragraph">
<p>To build with Ant you need to grab dependencies and compile and then create a JAR or WAR
archive as normal.  To make it executable:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use the appropriate launcher as a <code>Main-Class</code>,
e.g. <code>org.springframework.boot.loader.JarLauncher</code> for a JAR file, and
specify the other stuff it needs as manifest entries, principally a
<code>Start-Class</code>.</p>
</li>
<li>
<p>Add the runtime dependencies in a nested "lib" directory (for a
JAR) and the "provided" (embedded container) dependencies in a nested
"lib-provided" directory. Remember <strong>not</strong> to compress the entries in
the archive.</p>
</li>
<li>
<p>Add the <code>spring-boot-loader</code> classes at the root of the archive (so
the <code>Main-Class</code> is available).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint xml language-xml"><code>&lt;target name="build" depends="compile"&gt;
    &lt;copy todir="target/classes/lib"&gt;
        &lt;fileset dir="lib/runtime" /&gt;
    &lt;/copy&gt;
    &lt;jar destfile="target/spring-boot-sample-actuator-${spring-boot.version}.jar" compress="false"&gt;
        &lt;fileset dir="target/classes" /&gt;
        &lt;fileset dir="src/main/resources" /&gt;
        &lt;zipfileset src="lib/loader/spring-boot-loader-jar-${spring-boot.version}.jar" /&gt;
        &lt;manifest&gt;
            &lt;attribute name="Main-Class" value="org.springframework.boot.loader.JarLauncher" /&gt;
            &lt;attribute name="Start-Class" value="${start-class}" /&gt;
        &lt;/manifest&gt;
    &lt;/jar&gt;
&lt;/target&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Actuator Sample has a <code>build.xml</code> that should work if you run it with</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ant -lib &lt;path_to&gt;/ivy-2.2.jar</pre>
</div>
</div>
<div class="paragraph">
<p>after which you can run the application with</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ java -jar target/*.jar</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_traditional_deployment">20.13. Traditional deployment</h3>
<div class="sect3">
<h4 id="_create_a_deployable_war_file">20.13.1. Create a deployable WAR file</h4>
<div class="paragraph">
<p>Use the <code>SpringBootServletInitializer</code> base class, which is picked up by Spring&#8217;s
Servlet 3.0 support on deployment. Add an extension of that to your project and build a
WAR file as normal. For more detail, see the
<a href="http://spring.io/guides/gs/convert-jar-to-war">&#8220;Converting a JAR Project to a WAR&#8221;</a> guide
on the spring.io website.</p>
</div>
<div class="paragraph">
<p>The WAR file can also be executable if you use the Spring Boot build tools. In that case
the embedded container classes (to launch Tomcat for instance) have to be added to the
WAR in a <code>lib-provided</code> directory. The tools will take care of that as long as the
dependencies are marked as "provided" in Maven or Gradle. Here&#8217;s a Maven example
<a href="https://github.com/spring-projects/spring-boot/blob/master/spring-boot-samples/spring-boot-sample-traditional/pom.xml">in the Boot Samples</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_create_a_deployable_war_file_for_older_servlet_containers">20.13.2. Create a deployable WAR file for older servlet containers</h4>
<div class="paragraph">
<p>Older Servlet containers don&#8217;t have support for the <code>ServletContextInitializer</code> bootstrap
process used in Servlet 3.0. You can still use Spring and Spring Boot in these containers
but you are going to need to add a <code>web.xml</code> to your application and configure it to load
an <code>ApplicationContext</code> via a <code>DispatcherServlet</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_convert_an_existing_application_to_spring_boot">20.13.3. Convert an existing application to Spring Boot</h4>
<div class="paragraph">
<p>For a non-web application it should be easy (throw away the code that creates your
<code>ApplicationContext</code> and replace it with calls to <code>SpringApplication</code> or
<code>SpringApplicationBuilder</code>). Spring MVC web applications are generally amenable to first
creating a deployable WAR application, and then migrating it later to an executable WAR
and/or JAR.  Useful reading is in the <a href="http://spring.io/guides/gs/convert-jar-to-war/">Getting
Started Guide on Converting a JAR to a WAR</a>.</p>
</div>
<div class="paragraph">
<p>Create a deployable WAR by extending <code>SpringBootServletInitializer</code> (e.g. in a class
called <code>Application</code>), and add the Spring Boot <code>@EnableAutoConfiguration</code> annotation.
Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>@Configuration
@EnableAutoConfiguration
@ComponentScan
public class Application extends SpringBootServletInitializer {

    @Override
    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {
        return application.sources(Application.class);
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Remember that whatever you put in the <code>sources</code> is just a Spring <code>ApplicationContext</code> and
normally anything that already works should work here. There might be some beans you can
remove later and let Spring Boot provide its own defaults for them, but it should be
possible to get something working first.</p>
</div>
<div class="paragraph">
<p>Static resources can be moved to <code>/public</code> (or <code>/static</code> or <code>/resources</code> or
<code>/META-INFO/resources</code>) in the classpath root. Same for <code>messages.properties</code> (Spring Boot
detects this automatically in the root of the classpath).</p>
</div>
<div class="paragraph">
<p>Vanilla usage of Spring <code>DispatcherServlet</code> and Spring Security should require no further
changes. If you have other features in your application, using other servlets or filters,
for instance then you may need to add some configuration to your <code>Application</code> context,
replacing those elements from the <code>web.xml</code> as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <code>@Bean</code> of type <code>Servlet</code> or <code>ServletRegistrationBean</code> installs that bean in the
container as if it was a <code>&lt;servlet/&gt;</code> and <code>&lt;servlet-mapping/&gt;</code> in <code>web.xml</code>.</p>
</li>
<li>
<p>A <code>@Bean</code> of type <code>Filter</code> or <code>FilterRegistrationBean</code> behaves similarly (like a
<code>&lt;filter/&gt;</code> and <code>&lt;filter-mapping/&gt;</code>.</p>
</li>
<li>
<p>An <code>ApplicationContext</code> in an XML file can be added to an <code>@Import</code> in your
<code>Application</code>. Or simple cases where annotation configuration is heavily used already
can be recreated in a few lines as <code>@Bean</code> definitions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Once the WAR is working we make it executable by adding a <code>main</code> method to our
<code>Application</code>, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint java language-java"><code>public static void main(String[] args) {
    SpringApplication.run(Application.class, args);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Applications can fall into more than one category:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Servlet 3.0 applications with no <code>web.xml</code>.</p>
</li>
<li>
<p>Applications with a <code>web.xml</code>.</p>
</li>
<li>
<p>Applications with a context hierarchy.</p>
</li>
<li>
<p>Applications without a context hierarchy.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All of these should be amenable to translation, but each might require slightly different
tricks.</p>
</div>
<div class="paragraph">
<p>Servlet 3.0 applications might translate pretty easily if they already use the Spring
Servlet 3.0 initializer support classes. Normally all the code from an existing
<code>WebApplicationInitializer</code> can be moved into a <code>SpringBootServletInitializer</code>. If your
existing application has more than one <code>ApplicationContext</code> (e.g. if it uses
<code>AbstractDispatcherServletInitializer</code>) then you might be able to squish all your context
sources into a single <code>SpringApplication</code>. The main complication you might encounter is if
that doesn&#8217;t work and you need to maintain the context hierarchy. See the
<a href="#build.hierarchy">entry on building a hierarchy</a> for examples. An existing parent
context that contains web-specific features will usually need to be broken up so that all
the <code>ServletContextAware</code> components are in the child context.</p>
</div>
<div class="paragraph">
<p>Applications that are not already Spring applications might be convertible to a Spring
Boot application, and the guidance above might help, but your mileage may vary.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2014-03-08 23:12:44 PST
</div>
</div>
</body>
</html>